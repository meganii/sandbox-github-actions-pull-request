;
(self.AMP=self.AMP||[]).push({m:0,v:"2301041800000",n:"amp-access-laterpay",ev:"0.2",l:!0,f:function(t,n){!function(){Array.isArray;var n=Object.prototype;function r(t){var n=Object.create(null);return t&&Object.assign(n,t),n}function e(t,n){t.insertBefore(n,t.firstChild)}n.hasOwnProperty,n.toString;var i=/(?:^[#?]?|&)([^=&]+)(?:=([^&]*))?/g;function a(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";try{return decodeURIComponent(t)}catch(t){return n}}function s(t){var n=(t||self).location;return function(t){var n,e=r();if(!t)return e;for(;n=i.exec(t);){var s=a(n[1],n[1]),u=n[2]?a(n[2].replace(/\+/g," "),n[2]):"";e[s]=u}return e}(n.originalHash||n.hash)}var u="";function o(t){var n;return u||(u=(null===(n=t.AMP_CONFIG)||void 0===n?void 0:n.v)||"01".concat("2301041800000")),u}function c(t,n){var r=n||s(t);return["1","actions","amp","amp4ads","amp4email"].includes(r.development)||!!t.AMP_DEV_MODE}function l(t,n,r){return n in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}self.__AMP_LOG=self.__AMP_LOG||{user:null,dev:null,userForEmbed:null};var h,f=self.__AMP_LOG;function p(t,n){throw new Error("failed to call initLogConstructor")}function d(t){return f.user||(f.user=v()),function(t,n){return n&&n.ownerDocument.defaultView!=t}(f.user.win,t)?f.userForEmbed||(f.userForEmbed=v()):f.user}function v(t){return p()}function m(){return f.dev||(f.dev=p())}function y(t,n,r,e,i,a,s,u,o,c,l){return t}function b(t,n,r,e,i,a,s,u,o,c,l){return d().assert(t,n,r,e,i,a,s,u,o,c,l)}function x(){return h||(h=Promise.resolve(void 0))}var g=function(){var t=this;this.promise=new Promise((function(n,r){t.resolve=n,t.reject=r}))};function w(t,n){return L(t=function(t){return t.__AMP_TOP||(t.__AMP_TOP=t)}(t),n)}function j(t,n){return N(R(t),n)}function O(t){return t.nodeType?(r=t,n=(r.ownerDocument||r).defaultView,w(n,"ampdoc")).getAmpDoc(t):t;var n,r}function R(t){var n=O(t);return n.isSingleDoc()?n.win:n}function L(t,n){y(function(t,n){var r=t.__AMP_SERVICES&&t.__AMP_SERVICES[n];return!(!r||!r.ctor)}(t,n));var r=_(t)[n];return r.obj||(y(r.ctor),y(r.context),r.obj=new r.ctor(r.context),y(r.obj),r.context=null,r.resolve&&r.resolve(r.obj)),r.obj}function N(t,n){var r=_(t)[n];return r?r.promise?r.promise:(L(t,n),r.promise=Promise.resolve(r.obj)):null}function _(t){var n=t.__AMP_SERVICES;return n||(n=t.__AMP_SERVICES={}),n}function U(t,n,r,e){return function(t,n,r,e){var i=j(t,n);if(i)return i;var a=O(t);return a.whenExtensionsKnown().then((function(){var t=a.getExtensionVersion(r);return t?w(a.win,"extensions").waitForExtension(r,t):null})).then((function(r){return r?e?j(t,n):function(t,n){return function(t,n){var r=N(t,n);if(r)return r;var e,i,a,s,u=_(t);return u[n]=(i=(e=new g).promise,a=e.reject,s=e.resolve,i.catch((function(){})),{obj:null,promise:i,resolve:s,reject:a,context:null,ctor:null}),u[n].promise}(R(t),n)}(t,n):null}))}(t,n,r,e).then((function(t){return function(t,n,r){return b(t,"Service %s was requested to be provided through %s, but %s is not loaded in the current page. To fix this problem load the JavaScript file for %s in this page.",n,r,r,r)}(t,n,r)}))}var k;function z(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(t);n&&(e=e.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),r.push.apply(r,e)}return r}function B(t){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?z(Object(r),!0).forEach((function(n){l(t,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):z(Object(r)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))}))}return t}function I(t,n,r,e){return function(t,n,r,e){var i=t,a=r,s=function(t){try{return a(t)}catch(t){var n,r;throw null===(n=(r=self).__AMP_REPORT_ERROR)||void 0===n||n.call(r,t),t}},u=function(){if(void 0!==k)return k;k=!1;try{var t={get capture(){return k=!0,!1}};self.addEventListener("test-options",null,t),self.removeEventListener("test-options",null,t)}catch(t){}return k}(),o=!(null==e||!e.capture);return i.addEventListener(n,s,u?e:o),function(){null==i||i.removeEventListener(n,s,u?e:o),a=null,i=null,s=null}}(t,n,r,e)}function P(t,n,r){if(n[r])return n[r];var e=t.querySelector("style[".concat(r,"], link[").concat(r,"]"));return e?(n[r]=e,e):null}function C(t,n){for(var r=t.styleSheets,e=0;e<r.length;e++)if(r[e].ownerNode==n)return!0;return!1}var A="amp-access-laterpay",E={live:{eu:"https://connector.laterpay.net",us:"https://connector.uselaterpay.com"},sandbox:{eu:"https://connector.sandbox.laterpaytest.net",us:"https://connector.sandbox.uselaterpaytest.com"}},S={payLaterButton:"Buy Now, Pay Later",payNowButton:"Buy Now",defaultButton:"Buy Now",alreadyPurchasedLink:"I already bought this",sandbox:"Site in test mode. No payment required.",laterpayBadgePrefix:"Powered by ",laterpayBadgeSuffix:""},D=function(){function t(t,n){this.ampdoc=t.ampdoc,this.DR=n,this.Pu=function(t,n){return L(R(O(t)),"viewport")}(this.ampdoc),this.pnt=this.DR.getAdapterConfig(),this.dnt=null,this.vnt=null,this.mnt=null,this.ynt=null,this.bnt=[],this.xnt=!0,this.gnt=null,this.wnt=null,this.jnt=null,this.Ont=this.pnt.locale||"en",this.Rnt=B(B({},S),this.pnt.localeMessages||{}),this.Lnt=this.Nnt()+"/api/v2/fetch/amp/?article_url=CANONICAL_URL&amp_reader_id=READER_ID&return_url=RETURN_URL";var i=this.pnt.articleId;i&&(this.Lnt+="&article_id="+encodeURIComponent(i));var a=this.pnt.jwt;a&&(this.Lnt+="&jwt="+encodeURIComponent(a)),this.Ds=L(this.ampdoc.win,"timer"),this.Tu=w(this.ampdoc.win,"vsync"),this.ri=function(t){return w(t,"xhr")}(this.ampdoc.win),function(t,n,i,a,s){var u=t.getHeadNode(),o=function(t,n,i,a){var s=t.__AMP_CSS_SM;s||(s=t.__AMP_CSS_SM=r());var u="amp-extension=".concat(a);if(u){var o=P(t,s,u);if(o)return"STYLE"==o.tagName&&o.textContent!==n&&(o.textContent=n),o}var c=(t.ownerDocument||t).createElement("style");c.textContent=n;return c.setAttribute("amp-extension",a),function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(r){var i=r.nextSibling;t.insertBefore(n,i)}else e(t,n)}(t,c,P(t,s,"amp-runtime")),u&&(s[u]=c),c}(u,function(t,n){var r=t.__AMP_CSS_TR;return r?r(n):n}(u,".amp-access-laterpay{position:relative}@media (min-width:420px){.amp-access-laterpay{width:420px}}.amp-access-laterpay ul{width:100%;padding:0;margin:0 0 40px}.amp-access-laterpay li{list-style:none;display:-ms-flexbox;display:flex;margin-bottom:20px}.amp-access-laterpay label{display:-ms-flexbox;display:flex;padding-right:10px}.amp-access-laterpay input{width:20px}.amp-access-laterpay-container{padding:16px 24px 16px 16px;display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;-ms-flex-align:center;align-items:center;border-radius:12px;box-shadow:0 0 10px -1px rgba(0,0,0,.25)}.amp-access-laterpay-sandbox{width:112%;padding:15px 10px;background-color:#f2902a;color:#fff;font-weight:700;text-align:center}.amp-access-laterpay-badge{text-align:center;color:#999}.amp-access-laterpay-badge a{color:#8db444}.amp-access-laterpay-header{font-size:1.2em;margin-bottom:40px}.amp-access-laterpay-metadata{width:92%}.amp-access-laterpay-title{font-size:1.1em;margin:0;padding:0}.amp-access-laterpay-description{font-size:0.9em;margin:0;padding:0}.amp-access-laterpay-price-container{margin-top:0;margin-left:auto}.amp-access-laterpay-price{font-size:1.5em}.amp-access-laterpay-currency{font-size:0.7em}.amp-access-laterpay-purchase-button{font-size:1.1em;padding:0.5em 0.8em;background-color:#8db444;border-radius:4px;border:0;color:#fff;width:70%}.amp-access-laterpay-already-purchased-link-container{font-size:0.9em}\n/*# sourceURL=/extensions/amp-access-laterpay/0.2/amp-access-laterpay.css*/"),0,"amp-access-laterpay");if(i){var c=t.getRootNode();if(C(c,o))return o;var l=setInterval((function(){C(c,o)&&clearInterval(l)}),4)}}(this.ampdoc,0,(function(){}))}var n=t.prototype;return n.Nnt=function(){var t,n=this.pnt.region||"eu";return(t=self,t.__AMP_MODE?t.__AMP_MODE:t.__AMP_MODE=function(t){return{localDev:!1,development:c(t,s(t)),esm:!1,test:!1,rtvVersion:o(t),ssrReady:!1}}(t)).development&&this.pnt.configUrl?this.pnt.configUrl:this.pnt.sandbox?E.sandbox[n]:E.live[n]},n.authorize=function(){var t=this;return this._nt().then((function(n){if(204===n.status)throw d().createError("No merchant domains have been matched for this article, or no paid content configurations are setup.");return t.pnt.scrollToTopAfterAuth&&t.Tu.mutate((function(){return t.Pu.setScrollTop(0)})),t.Unt(),{access:n.access}}),(function(n){if(!n||!n.response)throw n;var r=n.response;if(402!==r.status)throw n;return r.json().catch((function(){})).then((function(n){return t.dnt=n,t.vnt=t.knt(n.purchase_options),t.Unt().then(t.znt.bind(t)),{access:!1}}))}))},n._nt=function(){var t=this,n=this.Lnt+"&article_title="+encodeURIComponent(this.Bnt());return this.DR.buildUrl(n,!1).then((function(n){return t.DR.getLoginUrl(n)})).then((function(n){return m().info(A,"Authorization URL: ",n),t.Ds.timeoutPromise(3e3,t.ri.fetchJson(n,{credentials:"include"})).then((function(t){return t.json()}))}))},n.knt=function(t){var n=this.Bnt(),r={};return r.singlePurchases=t.filter((function(t){return"single_purchase"===t.sales_model})),r.singlePurchases.forEach((function(t){return t.description=n})),r.timepasses=t.filter((function(t){return"timepass"===t.sales_model})),r.subscriptions=t.filter((function(t){return"subscription"===t.sales_model})),r},n.Int=function(t){return this.ampdoc.win.document.createElement(t)},n.Bnt=function(){var t=this.ampdoc.getRootNode().querySelector(this.pnt.articleTitleSelector);return b(t,"No article title element found with selector %s",this.pnt.articleTitleSelector),t.textContent.trim()},n.WR=function(){var t=A+"-dialog",n=this.ampdoc.getElementById(t);return d().assertElement(n,"No element found with id "+t)},n.Unt=function(){var t,n=this;if(this.xnt)return x();for(;t=this.bnt.shift();)t();return this.mnt&&(this.mnt(),this.mnt=null),this.ynt&&(this.ynt(),this.ynt=null),this.Tu.mutatePromise((function(){n.xnt=!0,n.gnt=null,function(t){for(;t.firstChild;)t.removeChild(t.firstChild)}(n.WR())}))},n.znt=function(){var t=this,n=this.WR();this.gnt=this.Int("div"),this.gnt.className=A+"-container",this.pnt.sandbox&&this.Pnt("sandbox"),this.Pnt("header");var r=this.Int("ul");this.vnt.singlePurchases.forEach((function(n){r.appendChild(t.Cnt(n))})),this.vnt.timepasses.forEach((function(n){r.appendChild(t.Cnt(n))})),this.vnt.subscriptions.forEach((function(n){r.appendChild(t.Cnt(n))}));var e=this.Int("button");e.className=A+"-purchase-button",e.textContent=this.Rnt.defaultButton,this.jnt=e,this.mnt=I(e,"click",(function(n){var r=t.wnt.value,e=t.wnt.dataset.purchaseType;t.Ant(n,r,e)})),this.gnt.appendChild(r),this.gnt.appendChild(e),this.gnt.appendChild(this.Ent(this.dnt.identify_url)),this.Pnt("footer"),n.appendChild(this.gnt),n.appendChild(this.Snt()),this.xnt=!1,this.Dnt(r.firstElementChild)},n.Dnt=function(t){var n=t.querySelector('input[type="radio"]');n.checked=!0,this.Tnt(n)},n.Pnt=function(t){if(this.Rnt[t]){var n=this.Int("p");n.className=A+"-"+t,n.textContent=this.Rnt[t],this.gnt.appendChild(n)}},n.Snt=function(){var t=this.Int("a");t.href="https://blog.laterpay.net/laterpay-academy/what-is-laterpay",t.target="_blank",t.textContent="LaterPay";var n=this.Int("p"),r=this.Int("span");r.textContent=this.Rnt.laterpayBadgePrefix;var e=this.Int("span");return e.textContent=this.Rnt.laterpayBadgeSuffix,n.className=A+"-badge",n.appendChild(r),n.appendChild(t),n.appendChild(e),n},n.Cnt=function(t){var n=this.Int("li"),r=this.Int("label");r.for=t.title,r.appendChild(this.qnt(t));var e=this.Int("div");e.className=A+"-metadata";var i=this.Int("span");i.className=A+"-title",i.textContent=t.title,e.appendChild(i);var a=this.Int("p");return a.className=A+"-description",a.textContent=t.description,e.appendChild(a),r.appendChild(e),n.appendChild(r),n.appendChild(this.Fnt(t.price)),n},n.qnt=function(t){var n=this.Int("input");n.name="purchaseOption",n.type="radio",n.id=t.title,n.value=t.purchase_url;var r="pay_later"===t.price.payment_model?"payLater":"payNow",e=this.Rnt[r+"Button"];return n.setAttribute("data-purchase-action-label",e),n.setAttribute("data-purchase-type",r),this.bnt.push(I(n,"change",this.Jnt.bind(this))),n},n.Fnt=function(t){var n=this.Vnt(t.amount),r=this.Int("span");r.className=A+"-price",r.textContent=n;var e=this.Int("sup");e.className=A+"-currency",e.textContent=t.currency;var i=this.Int("p");return i.className=A+"-price-container",i.appendChild(r),i.appendChild(e),i},n.Vnt=function(t){return(t/100).toLocaleString(this.Ont,{style:"decimal",minimumFractionDigits:0})},n.Ent=function(t){var n=this,r=this.Int("p");r.className=A+"-already-purchased-link-container";var e=this.Int("a");return e.href=t,e.textContent=this.Rnt.alreadyPurchasedLink,this.ynt=I(e,"click",(function(r){n.Ant(r,t,"alreadyPurchased")})),r.appendChild(e),r},n.Jnt=function(t){t.preventDefault(),this.Tnt(t.target)},n.Tnt=function(t){var n=A+"-selected",r=this.wnt,e=t.dataset.purchaseActionLabel;r&&r.classList.contains(n)&&r.classList.remove(n),this.wnt=t,this.wnt.classList.add(n),this.jnt.textContent=e},n.Ant=function(t,n,r){var e=this;return t.preventDefault(),this.DR.buildUrl(n,!1).then((function(t){m().fine(A,"Authorization URL: ",t),e.DR.loginWithUrl(t,r)}))},n.pingback=function(){return x()},t}();t.registerServiceForDoc("laterpay",(function(t){return(n=t.getHeadNode(),U(n,"access","amp-access")).then((function(t){var n=t.getVendorSource("laterpay"),r=new D(t,n);return n.getAdapter().registerVendor(r),r}));var n}))}();
/*! https://mths.be/cssescape v1.5.1 by @mathias | MIT license */}});
//# sourceMappingURL=amp-access-laterpay-0.2.js.map