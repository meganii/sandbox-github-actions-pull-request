;
(self.AMP=self.AMP||[]).push({m:1,v:"2301041800000",n:"amp-mega-menu",ev:"0.1",l:!0,f:function(t,e){(()=>{var e,n="amp:dom-update",i="ArrowLeft";function a(t){return t?Array.prototype.slice.call(t):[]}var{hasOwnProperty:r,toString:o}=Object.prototype;function s(t){return 1==(null==t?void 0:t.nodeType)}function m(t,e,n,i,a,r,o,s,m,u,l){return t}function u(t,e){return t.replace(/^|,/g,`$&${e} `)}function l(t,e){return t.querySelector(u(e,":scope"))}function h(t){const e=t.isConnected;if(void 0!==e)return e;let n=t;for(;n=d(n),n.host;)n=n.host;return n.nodeType===Node.DOCUMENT_NODE}function d(t){if(Node.prototype.getRootNode)return t.getRootNode();let e;for(e=t;e.parentNode&&(!(n=e)||"I-AMPHTML-SHADOW-ROOT"!=n.tagName&&(11!=n.nodeType||"[object ShadowRoot]"!==Object.prototype.toString.call(n)));e=e.parentNode);var n;return e}function c(t){try{t.focus()}catch(t){}}var p=[],f="__AMP_MODAL_SAVED_TAB_INDEX";function g(t){const e=[];for(let n=t;n;n=n.parentNode||n.host)e.push(n);return e}function _(t,e,n){null===n||null==n?t.removeAttribute(e):t.setAttribute(e,n)}self.__AMP_LOG=self.__AMP_LOG||{user:null,dev:null,userForEmbed:null};var b=self.__AMP_LOG;function v(t){return function(t,e){throw new Error("failed to call initLogConstructor")}()}function A(t,e,n,i,a,r,o,s,m,u,l){return t}function P(t){return t.nodeType?(n=t,e=(n.ownerDocument||n).defaultView,function(t,e){return y(t=function(t){return t.__AMP_TOP||(t.__AMP_TOP=t)}(t),"ampdoc")}(e)).getAmpDoc(t):t;var e,n}function y(t,e){A(E(t,e));const n=function(t){let e=t.__AMP_SERVICES;return e||(e=t.__AMP_SERVICES={}),e}(t)[e];return n.obj||(A(n.ctor),A(n.context),n.obj=new n.ctor(n.context),A(n.obj),n.context=null,n.resolve&&n.resolve(n.obj)),n.obj}function E(t,e){const n=t.__AMP_SERVICES&&t.__AMP_SERVICES[e];return!(!n||!n.ctor)}var k="amp-mega-menu",I=class extends t.BaseElement{static prerenderAllowed(){return!0}constructor(t){super(t),this.yD=[],this.xD=0,this.VD=null,this.CD=null,this.Uu=this.win.document,this.DD=this.Uu.documentElement,this.Da=null,this.OD=t.id||Math.floor(100*Math.random()),this.HD=this.LD.bind(this),this.SD=this.zD.bind(this),this.ND=this.jD.bind(this)}isLayoutSupported(t){return"fixed-height"===t}buildCallback(){this.Da=function(t,e){const n=function(t){const e=P(t);return e.isSingleDoc()?e.win:e}(P(t));return E(n,e)?y(n,e):null}(this.element,"action")}layoutCallback(){return this.LD(),this.element.addEventListener(n,this.HD),this.CD||(this.CD=this.KD()),e||(e=Promise.resolve(void 0))}unlayoutCallback(){return this.element.removeEventListener(n,this.HD),this.$D(),!0}KD(){const t=this.Uu.createElement("div");t.classList.add("i-amphtml-mega-menu-mask"),t.setAttribute("aria-hidden","true");const e=this.element.closest("header")||this.element;return e.classList.add("i-amphtml-mega-menu-mask-parent"),e.appendChild(t),t}LD(){this.yD=a(this.element.querySelectorAll(u("nav > * > li",":scope"))),this.yD.filter((t=>!t.classList.contains("i-amphtml-mega-menu-item"))).forEach((t=>{if(1==t.childElementCount){const e=t.firstElementChild;return void this.BD(t,e,null)}const e=l(t,"> button")||l(t,"> [role=button]"),n=l(t,"> [role=dialog]");var i,a;i=e,a=`${k} requires each expandable item to include a button that toggles it.`,(b.user||(b.user=v()),void b.user.win?b.userForEmbed||(b.userForEmbed=v()):b.user).assert(i,a,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined),this.BD(t,e,n)}))}BD(t,e,n){if(t.classList.add("i-amphtml-mega-menu-item"),this.xD++,e.classList.add("i-amphtml-mega-menu-heading"),e.hasAttribute("tabindex")||e.setAttribute("tabindex",0),e.addEventListener("click",(t=>this.qD(t))),e.addEventListener("keydown",(t=>this.FD(t))),!n||this.Da.hasAction(e,"tap",t))return;n.classList.add("i-amphtml-mega-menu-content"),n.setAttribute("aria-modal","false");let i=n.getAttribute("id");i||(i=this.OD+"_AMP_content_"+this.xD,n.setAttribute("id",i)),n.insertBefore(this.UD(),n.firstChild),n.appendChild(this.UD()),e.setAttribute("aria-haspopup","dialog"),e.setAttribute("aria-controls",i),e.setAttribute("aria-expanded","false")}zD(t){const e=t.target;this.VD&&!this.VD.contains(e)&&h(e)&&this.$D()}jD(t){"Escape"===t.key&&this.$D()&&t.preventDefault()}qD(t){if(!this.WD(t))return;t.preventDefault(),t.stopPropagation();const e=t.currentTarget.parentElement;e!=this.$D()&&this.XD(e)}WD(t){const e=t.target,n=t.currentTarget;return!function(t,e,n){let i;for(i=t;i&&i!==n;i=i.parentElement)if("A"==i.tagName)return i;return null}(e,0,n)&&!this.Da.hasAction(e,"tap",n)&&n.hasAttribute("aria-haspopup")}FD(t){if(t.defaultPrevented)return;const{key:e}=t;switch(e){case i:case"ArrowRight":return void this.GD(t);case"Enter":case" ":return void(t.target==t.currentTarget&&this.qD(t))}}GD(t){const e=t.currentTarget.parentElement,n=this.yD.indexOf(e);if(-1!==n){t.preventDefault();let e=t.key==i?-1:1;"rtl"==((o=this.Uu).body.getAttribute("dir")||o.documentElement.getAttribute("dir")||"ltr")&&(e=-e);const s=(a=n+e,r=this.yD.length,a>0&&r>0?a%r:(a%r+r)%r);c(this.JD(this.yD[s]))}var a,r,o}XD(t){this.mutateElement((()=>{const e=this.QD(t);(function(t){m(p.every((e=>e.element!==t))),m(h(t));const e=function(t){const e=[],n=g(t);for(let t=0;t<n.length;t++){const i=n[t];i.parentNode&&a(i.parentNode.children).filter((t=>t!=i)).forEach((t=>e.push(t)))}return e}(t),n=g(t).filter(s),i=function(t){const e=[];let n=t;for(;n;){const t=d(n),i=t.querySelectorAll(["a[href]","area[href]","button","details summary","iframe","input","select","textarea","[contenteditable]","[draggable]","[tabindex]"].join(","));Array.prototype.push.apply(e,i),n=t.host}return e}(t),r=i.filter((e=>t.contains(e)&&void 0!==e[f])),o=i.filter((e=>!t.contains(e)&&void 0===e[f])),u=e.concat(n).map((t=>({element:t,prevValue:t.getAttribute("aria-hidden")})));n.forEach((t=>t.removeAttribute("aria-hidden"))),e.forEach((t=>t.setAttribute("aria-hidden","true"))),o.forEach((t=>{t[f]=t.getAttribute("tabindex"),t.setAttribute("tabindex","-1")})),r.forEach((t=>{m(void 0!==t[f]),_(t,"tabindex",t[f])})),p.push({element:t,hiddenElementInfos:u,focusableExternalElements:o,focusableInternalElements:r})})(e),e.setAttribute("aria-modal","true")})),t.setAttribute("open",""),this.element.setAttribute("open",""),this.CD.setAttribute("open",""),this.JD(t).setAttribute("aria-expanded","true"),c(t.querySelector(".i-amphtml-screen-reader")),this.DD.addEventListener("click",this.SD),this.DD.addEventListener("keydown",this.ND),this.VD=t}$D(){if(!this.VD)return null;const t=this.VD;this.mutateElement((()=>{const e=this.QD(t);!function(t){const e=p.pop();m(e);const{element:n,focusableExternalElements:i,focusableInternalElements:a,hiddenElementInfos:r}=e;m(h(t)),m(n===t),r.forEach((({element:t,prevValue:e})=>_(t,"aria-hidden",e))),a.forEach((t=>t.setAttribute("tabindex","-1"))),i.forEach((t=>{m(void 0!==t[f]),_(t,"tabindex",t[f]),t[f]=void 0}))}(e),e.setAttribute("aria-modal","false")})),t.removeAttribute("open"),this.element.removeAttribute("open"),this.CD.removeAttribute("open");const e=this.JD(t);return e.setAttribute("aria-expanded","false"),t.contains(this.Uu.activeElement)&&c(e),this.DD.removeEventListener("click",this.SD),this.DD.removeEventListener("keydown",this.ND),this.VD=null,t}JD(t){return l(t,"> .i-amphtml-mega-menu-heading")}QD(t){return l(t,"> .i-amphtml-mega-menu-content")}UD(){const t=this.element.getAttribute("data-close-button-aria-label")||"Close the menu",e=this.Uu.createElement("button");return e.textContent=t,e.classList.add("i-amphtml-screen-reader"),e.addEventListener("click",(()=>this.$D())),e}};t.registerElement(k,I,"amp-mega-menu{z-index:1000!important;white-space:nowrap!important}amp-mega-menu.i-amphtml-layout-size-defined[open]{overflow:visible!important}amp-mega-menu nav{background:#fff}amp-mega-menu nav>*{margin:0}amp-mega-menu .i-amphtml-mega-menu-item{display:inline-block!important}amp-mega-menu .i-amphtml-mega-menu-heading{cursor:pointer!important}amp-mega-menu .i-amphtml-mega-menu-content{position:absolute!important;left:0;width:100vw;opacity:0!important;visibility:hidden!important;background:#fff}amp-mega-menu .i-amphtml-mega-menu-item[open]>.i-amphtml-mega-menu-content{visibility:visible!important;opacity:1!important}amp-mega-menu .i-amphtml-mega-menu-item:not([open]) .i-amphtml-screen-reader{display:none!important}.i-amphtml-mega-menu-mask-parent{z-index:1000!important;position:relative}.i-amphtml-mega-menu-mask{position:fixed!important;z-index:-1!important;visibility:hidden!important;opacity:0!important;top:0!important;bottom:0!important;left:0!important;right:0!important;background:rgba(0,0,0,0.5);transition:opacity 200ms,visibility 0s 200ms}.i-amphtml-mega-menu-mask[open]{opacity:1!important;visibility:visible!important;transition:opacity 200ms}\n/*# sourceURL=/extensions/amp-mega-menu/0.1/amp-mega-menu.css*/")})();
/*! https://mths.be/cssescape v1.5.1 by @mathias | MIT license */}});
//# sourceMappingURL=amp-mega-menu-0.1.mjs.map