;
(self.AMP=self.AMP||[]).push({m:1,v:"2301041800000",n:"amp-story-captions",ev:"0.1",l:!0,f:function(t,n){(()=>{function n(t,n,o){return n in t?Object.defineProperty(t,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[n]=o,t}function o(t,n){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),o.push.apply(o,i)}return o}function i(t){for(var i=1;i<arguments.length;i++){var r=null!=arguments[i]?arguments[i]:{};i%2?o(Object(r),!0).forEach((function(o){n(t,o,r[o])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))}))}return t}function r(t){return t?Array.prototype.slice.call(t):[]}var e,{isArray:s}=Array,{hasOwnProperty:a,toString:c}=Object.prototype;function p(t,n){if(!!n===n||null==n)return;if(Array.isArray(n))return void n.forEach((n=>{p(t,n)}));const o=n;t.appendChild(o.nodeType?o:self.document.createTextNode(String(n)))}function l(t,n,...o){if("string"!=typeof t)return t(i(i({},n),{},{children:o}));const r=null==n?void 0:n.xmlns;r&&delete n.xmlns;const e=r?self.document.createElementNS(r,t):self.document.createElement(t);return p(e,o),n&&Object.keys(n).forEach((t=>{!function(t,n,o){if(!1!==o&&null!=o)if("function"!=typeof o||"o"!==n[0]||"n"!==n[1])t.setAttribute(n,!0===o?"":String(o));else{const i=n.toLowerCase().substring(2);t.addEventListener(i,o)}}(e,t,n[t])})),e}function u(t,n,o,i){return function(t,n,o,i){let r=t,s=o,a=t=>{try{return s(t)}catch(t){var n,o;throw null===(n=(o=self).__AMP_REPORT_ERROR)||void 0===n||n.call(o,t),t}};const c=function(){if(void 0!==e)return e;e=!1;try{const t={get capture(){return e=!0,!1}};self.addEventListener("test-options",null,t),self.removeEventListener("test-options",null,t)}catch(t){}return e}(),p=!(null==i||!i.capture);return r.addEventListener(n,a,c?i:p),()=>{null==r||r.removeEventListener(n,a,c?i:p),s=null,r=null,a=null}}(t,n,o,i)}self.__AMP_LOG=self.__AMP_LOG||{user:null,dev:null,userForEmbed:null},self.__AMP_LOG;var m,f,h="none";function y(t){return!!t&&-1!=t.toString().indexOf("[native code]")}function d(t){return void 0===m&&(n=t||Element,m=n.prototype.attachShadow?"v1":n.prototype.createShadowRoot?"v0":h),m;var n}function v(t,n,o){var i="";return t&&Array.prototype.forEach.call(t,(function(t){if(t.selectorText&&t.style&&void 0!==t.style.cssText)i+=function(t,n,o){var i=[];return t.split(",").forEach((function(t){t=t.trim(),o&&(t=o(t)),function(t,n){var o=function(t){return t=t.replace(/\[/g,"\\[").replace(/\]/g,"\\]"),new RegExp("^("+t+")"+w,"m")}(n);return!t.match(o)}(t,n)&&(t=function(t,n){return function(t,n){return t.match(j)?(t=t.replace(x,n)).replace(j,n+" "):n+" "+t}(t,n)}(t,n)),i.push(t)})),i.join(", ")}(t.selectorText,n,o)+" {\n\t",i+=function(t){var n=t.style.cssText;t.style.content&&!t.style.content.match(/['"]+|attr/)&&(n=n.replace(/content:[^;]*;/g,"content: '"+t.style.content+"';"));var o=t.style;for(var i in o)"initial"===o[i]&&(n+=i+": initial; ");return n}(t)+"\n}\n\n";else if(t.type===CSSRule.MEDIA_RULE)i+="@media "+t.media.mediaText+" {\n",i+=v(t.cssRules,n),i+="\n}\n\n";else try{t.cssText&&(i+=t.cssText+"\n\n")}catch(t){}})),i}var g="-shadowcsshost",b=")(?:\\(((?:\\([^)(]*\\)|[^)(]*)+?)\\))?([^,{]*)",w=(new RegExp("("+g+b,"gim"),new RegExp("(-shadowcsscontext"+b,"gim"),"([>\\s~+[.,{:][\\s\\S]*)?$"),x=g+"-no-combinator",j=new RegExp(g,"gim");new RegExp("-shadowcsscontext","gim");var O=/[^\.\-\_0-9a-zA-Z]/,R=/[^\-\_0-9a-zA-Z]/;function E(t){const n=((o=t).ownerDocument||o).defaultView;var o;const i=t.shadowRoot||t.__AMP_SHADOW_ROOT;if(i)return i.innerHTML="",i;let e;const s=d();if("v1"==s?(e=t.attachShadow({mode:"open"}),e.styleSheets||Object.defineProperty(e,"styleSheets",{get:function(){const t=[];return e.childNodes.forEach((n=>{"STYLE"===n.tagName&&t.push(n.sheet)})),t}})):e="v0"==s?t.createShadowRoot():function(t){const n=t.ownerDocument;t.classList.add("i-amphtml-shadow-host-polyfill");const o=n.createElement("style");o.textContent=".i-amphtml-shadow-host-polyfill>:not(i-amphtml-shadow-root){display:none!important}",t.appendChild(o);const i=n.createElement("i-amphtml-shadow-root");return t.appendChild(i),t.__AMP_SHADOW_ROOT=i,Object.defineProperty(t,"shadowRoot",{enumerable:!0,configurable:!0,value:i}),i.host=t,i.getElementById=function(t){const n=(o=t,CSS.escape(o));var o;return i.querySelector(`#${n}`)},Object.defineProperty(i,"styleSheets",{get:()=>n.styleSheets?r(n.styleSheets).filter((t=>i.contains(t.ownerNode))):[]}),i}(t),void 0===f&&(f=d()!=h&&(y(Element.prototype.attachShadow)||y(Element.prototype.createShadowRoot))),!f){const t=`i-amphtml-sd-${n.Math.floor(1e4*n.Math.random())}`;e.id=t,e.host.classList.add(t),a=t=>function(t,n){return function(t,n){const o=t.id,i=t.ownerDocument;let r=null;try{r=_(i.implementation.createHTMLDocument(""),n)}catch(t){}if(!r)try{r=_(i,n)}catch(t){}return r?v(r,`.${o}`,A):n}(t,n)}(e,t),e.__AMP_CSS_TR=a}var a;return e}function A(t){return t.replace(/(html|body)/g,S)}function S(t,n,o,i){const r=i.charAt(o-1),e=i.charAt(o+t.length);return r&&!O.test(r)||e&&!R.test(e)?t:"amp-"+t}function _(t,n){const o=t.createElement("style");o.textContent=n;try{return(t.head||t.documentElement).appendChild(o),o.sheet?o.sheet.cssRules:null}finally{o.parentNode&&o.parentNode.removeChild(o)}}var z=["default","appear"],I=class extends t.BaseElement{constructor(t){super(t),this.fn=null,this.UE=null,this.tot=null,this.not=[]}buildCallback(){this.fn=l("div",null);const t=this.element.getAttribute("style-preset");z.includes(t)?(this.fn.classList.add(`amp-story-captions-${t}`),function(t,n,o){const i=self.document.createElement("style");i.textContent=':host{all:initial!important;color:initial!important}.i-amphtml-amp-story-captions-auto-append{position:absolute!important;z-index:1!important;bottom:5em!important;left:0!important;right:0!important;margin:0 3em!important}.amp-story-captions-default .amp-story-captions-cue-wrapper{font-size:calc(var(--story-page-vh, 8px)*2.5)!important;font-family:Roboto,sans-serif!important;margin:1em 0!important;display:-ms-flexbox!important;display:flex!important;-ms-flex-pack:center!important;justify-content:center!important;-ms-flex-direction:column!important;flex-direction:column!important;-ms-flex-align:center!important;align-items:center!important;width:100%!important}.amp-story-captions-default .amp-story-captions-cue{text-align:center!important;color:#fff!important;border-radius:.94em!important;padding:0.35em 0.94em!important;background-color:hsla(0,0%,10%,0.6)!important;max-width:calc(var(--story-page-vw)*92)!important}.amp-story-captions-default .amp-story-captions-future{color:#fff!important}.amp-story-captions-appear .amp-story-captions-cue-wrapper{font-size:var(--story-captions-font-size,calc(var(--story-page-vh, 8px)*2.5))!important;font-family:var(--story-captions-font-family,"Roboto"),"Roboto",sans-serif!important}.amp-story-captions-appear .amp-story-captions-cue{color:#fff!important;text-shadow:.06em .06em #000!important}.amp-story-captions-appear .amp-story-captions-cue span{transition:opacity .3s cubic-bezier(0.3,0,0,1)!important;opacity:1!important}.amp-story-captions-appear .amp-story-captions-cue span.amp-story-captions-future{opacity:.1!important}\n/*# sourceURL=/extensions/amp-story-captions/0.1/amp-story-captions-presets.css*/';const r=E(t);r.appendChild(i),r.appendChild(n)}(this.element,this.fn)):this.element.appendChild(this.fn),this.element.hasAttribute("auto-append")&&this.fn.classList.add("i-amphtml-amp-story-captions-auto-append")}isLayoutSupported(t){return function(t){return"fixed"==t||"fixed-height"==t||"responsive"==t||"fill"==t||"flex-item"==t||"fluid"==t||"intrinsic"==t}(t)||"container"===t}setVideoElement(t){this.tot&&this.tot(),this.UE=t,this.oot(),this.tot=u(t.textTracks,"change",(()=>{this.oot()}))}oot(){for(;this.not.length;)this.not.pop().dispose();r(this.UE.textTracks).forEach((t=>{"showing"!==t.mode&&"hidden"!==t.mode||(t.mode="hidden",this.not.push(new class{constructor(t,n,o){this.UE=t,this.iot=n,this._n=o.ownerDocument.createElement("div"),o.appendChild(this._n),this._n.classList.add("amp-story-captions-cue-wrapper"),this.rot=[],this.Zu(),this.eot=u(n,"cuechange",(()=>{this.Zu()})),this.sot=u(t,"timeupdate",(()=>{this.aot()}))}dispose(){var t,n;this.eot(),this.sot(),null===(n=(t=this._n).parentElement)||void 0===n||n.removeChild(t),this.UE=null,this.iot=null}Zu(){!function(t){for(;t.firstChild;)t.removeChild(t.firstChild)}(this._n),this.rot.length=0,r(this.iot.activeCues).forEach((t=>{const n=this._n.ownerDocument.createElement("div");n.classList.add("amp-story-captions-cue");const o=t.getCueAsHTML();let i=this._n.ownerDocument.createElement("span");n.appendChild(i);const e=[];r(o.childNodes).forEach((t=>{if("timestamp"===t.target){const o=function(t){const n=/^(?:(\d{2,}):)?(\d{2}):(\d{2})\.(\d{3})$/.exec(t);return n?3600*(n[1]?parseInt(n[1],10):0)+60*parseInt(n[2],10)+parseInt(n[3],10)+parseInt(n[4],10)/1e3:null}(t.data);null!==o&&(e.push(o),i=this._n.ownerDocument.createElement("span"),n.appendChild(i))}else i.appendChild(t)})),this.rot.push(e),this._n.appendChild(n)})),this.aot()}aot(){const t=this.UE.currentTime;r(this._n.childNodes).forEach(((n,o)=>{r(n.childNodes).forEach(((n,i)=>{i>0&&n.classList.toggle("amp-story-captions-future",this.rot[o][i-1]>t)}))}))}}(this.UE,t,this.fn)))}))}};t.registerElement("amp-story-captions",I,"amp-story-captions{white-space:pre-wrap}.amp-story-captions-future{color:gray}\n/*# sourceURL=/extensions/amp-story-captions/0.1/amp-story-captions.css*/")})();
/*! https://mths.be/cssescape v1.5.1 by @mathias | MIT license */
/**
* @license
* Copyright (c) 2014 The Polymer Project Authors. All rights reserved.
* Use of this source code is governed by a BSD-style
* license that can be found in the LICENSE file or at
* https://developers.google.com/open-source/licenses/bsd
*/}});
//# sourceMappingURL=amp-story-captions-0.1.mjs.map