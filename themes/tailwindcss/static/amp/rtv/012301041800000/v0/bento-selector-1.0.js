;
!function(n){var e=self.BENTO=self.BENTO||{};(e.bento=e.bento||[]).push((function(n){"use strict";function e(n,e){if(null==n)return{};var t,r,o={},i=Object.keys(n);for(r=0;r<i.length;r++)t=i[r],e.indexOf(t)>=0||(o[t]=n[t]);return o}function t(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function r(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),t.push.apply(t,r)}return t}function o(n){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?r(Object(o),!0).forEach((function(e){t(n,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(o)):r(Object(o)).forEach((function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(o,e))}))}return n}function i(n,e){return(i=Object.setPrototypeOf||function(n,e){return n.__proto__=e,n})(n,e)}function u(n){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)})(n)}function l(n){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n})(n)}function c(n,e){if(e&&("object"===l(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(n){if(void 0===n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}(n)}function a(n,e){(null==e||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}Array.isArray;var f=Object.prototype;function d(n,e,t,r,o,i,u,l,c,a,f){return n}function s(n){try{n.focus()}catch(n){}}function v(n,e,t){var r=n.hasAttribute(e),o=void 0!==t?t:!r;return o!==r&&(o?n.setAttribute(e,""):n.removeAttribute(e)),o}function b(n){var e,t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return null!==(e=null!==(t=n.tabindex)&&void 0!==t?t:n.tabIndex)&&void 0!==e?e:r}function m(n){var e=function(n,e){if("object"!==l(n)||null===n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var r=t.call(n,e);if("object"!==l(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)}(n,"string");return"symbol"===l(e)?e:String(e)}f.hasOwnProperty,f.toString;var p=["as","disabled","defaultValue","form","keyboardSelectMode","value","multiple","name","onChange","role","children"],y=(0,n.createContext)({selected:[]}),h="select",w=(0,n.forwardRef)((function(t,r){var i,u,l=t.as,c=void 0===l?"div":l,f=t.disabled,d=t.defaultValue,s=void 0===d?[]:d,v=t.form,m=t.keyboardSelectMode,w=void 0===m?"none":m,j=t.value,O=t.multiple,S=t.name,g=t.onChange,x=t.role,k=void 0===x?"listbox":x,A=t.children,D=e(t,p),E=b(D,w===h?0:-1),R=(i=(0,n.useState)(null!=j?j:s),u=2,function(n){if(Array.isArray(n))return n}(i)||function(n,e){var t=null==n?null:"undefined"!=typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(null!=t){var r,o,i=[],u=!0,l=!1;try{for(t=t.call(n);!(u=(r=t.next()).done)&&(i.push(r.value),!e||i.length!==e);u=!0);}catch(n){l=!0,o=n}finally{try{u||null==t.return||t.return()}finally{if(l)throw o}}return i}}(i,u)||function(n,e){if(n){if("string"==typeof n)return a(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);return"Object"===t&&n.constructor&&(t=n.constructor.name),"Map"===t||"Set"===t?Array.from(n):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?a(n,e):void 0}}(i,u)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),M=R[0],C=R[1],B=(0,n.useRef)([]),K=(0,n.useRef)({active:null,focusMap:{}}),T=null!=j?j:M,F=(0,n.useCallback)((function(n){if(n){var e;(e=O?T.includes(n)?T.filter((function(e){return e!=n})):T.concat(n):[n])&&(C(e),g&&g({value:e,option:n}))}}),[O,g,T]),I=(0,n.useMemo)((function(){return{disabled:f,focusRef:K,keyboardSelectMode:w,multiple:O,optionsRef:B,selected:T,selectOption:F}}),[f,K,w,O,T,F]);(0,n.useEffect)((function(){if(!O&&T.length>1){var n=T.pop();C([n]),g&&g({value:[n],option:n})}}),[g,O,T]);var L=(0,n.useCallback)((function(n,e){var t=T.includes(n);e&&t||((null!=e?e:!t)?F(n):C((function(e){var t=e.filter((function(e){return e!=n}));return g&&g({value:t,option:n}),t})))}),[g,C,F,T]),P=(0,n.useCallback)((function(){C([]),g&&g({value:[],option:j})}),[C,g,j]),U=(0,n.useCallback)((function(n,e,t){if(B.current.length){var r=B.current.filter((function(n){return null!=n}));if(r.length){var o,i,u=r.indexOf(e);t(r[(o=-1===u&&n<0?n:u+n,i=r.length,o>0&&i>0?o%i:(o%i+i)%i)])}}}),[]),V=(0,n.useCallback)((function(n){return U(n,T.shift(),F)}),[U,T,F]),$=(0,n.useCallback)((function(n){return U(n,K.current.active,(function(n){var e=K.current.focusMap[n];e&&e()}))}),[U]);(0,n.useImperativeHandle)(r,(function(){return{clear:P,selectBy:V,toggle:L}}),[P,V,L]);var q=(0,n.useCallback)((function(n){var e;switch(n.key){case"ArrowLeft":case"ArrowUp":e=-1;break;case"ArrowRight":case"ArrowDown":e=1}e&&(w===h?V(e):"focus"===w&&$(e))}),[w,$,V]);return(0,n.createElement)(c,o(o({},D),{},{role:k,"aria-disabled":f,"aria-multiselectable":O,disabled:f,form:v,multiple:O,name:S,onKeyDown:q,tabindex:E,value:T}),(0,n.createElement)("input",{hidden:!0,defaultValue:T,name:S,form:v}),(0,n.createElement)(y.Provider,{value:I},A))}));function j(t){var r="class",i=t.as,u=void 0===i?"div":i,l=t.disabled,c=void 0!==l&&l,a=t.focus,f=t.index,d=t.option,v=t.role,p=void 0===v?"option":v,w=t[r],j=void 0===w?"":w,O=e(t,["as","disabled","focus","index","option","role",r].map(m)),S=(0,n.useRef)(null),g=(0,n.useContext)(y),x=g.disabled,k=g.focusRef,A=g.keyboardSelectMode,D=g.multiple,E=g.optionsRef,R=g.selectOption,M=g.selected,C=b(O,A===h?-1:0),B=(0,n.useCallback)((function(){null==a||a(),S.current&&s(S.current)}),[a]);(0,n.useLayoutEffect)((function(){var n=E;if(n&&n.current)return null==f||c||(n.current[f]=d),function(){return delete n.current[f]}}),[c,f,d,E]),(0,n.useLayoutEffect)((function(){if(k){var n=k.current;if(n&&n.focusMap)return n.focusMap[d]=B,function(){return delete n.focusMap[d]}}}),[B,k,d]);var K=(0,n.useCallback)((function(){x||c||R(d)}),[c,d,R,x]),T=(0,n.useCallback)((function(){K()}),[K]),F=(0,n.useCallback)((function(n){"Enter"!==n.key&&" "!==n.key||K()}),[K]),I=M.includes(d);return(0,n.createElement)(u,o(o({},O),{},{"aria-disabled":String(c),"aria-selected":String(I),class:(j||"")+" option-9237376"+(I&&!D?" selected-9237376":"")+(I&&D?" multiselected-9237376":"")+(c||x?" disabled-9237376":""),disabled:c,onClick:T,onFocus:function(){return k.current.active=d},onKeyDown:F,ref:S,role:p,selected:I,tabindex:C,value:d}))}w.displayName="BentoSelector";var O=["disabled","onClick","onFocus","onKeyDown","role","selected","shimDomElement"],S=["children","disabled","form","multiple","name","onKeyDown","role","shimDomElement","value"],g=function(n){!function(n,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),e&&i(n,e)}(o,n);var e,t,r=(e=o,t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(n){return!1}}(),function(){var n,r=u(e);if(t){var o=u(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return c(this,n)});function o(){return r.apply(this,arguments)}return o.prototype.init=function(){var n=this,e=this.element;this.optionState=[];var t=new MutationObserver((function(){if(n.isExpectedMutation)n.isExpectedMutation=!1;else{var r=x(e,t),o=r.children,i=r.options;n.optionState=i,n.mutateProps({children:o,options:i})}}));t.observe(e,{attributeFilter:["option","selected","disabled"],childList:!0,subtree:!0});var r=x(e,t),o=r.children,i=r.options,u=r.value;return this.optionState=i,{"as":A,"shimDomElement":e,"children":o,"value":u,"options":i,"onChange":function(e){var t=e.option,r=e.value;n.triggerEvent(n.element,"select",{"targetOption":t,"selectedOptions":r}),n.isExpectedMutation=!0,n.mutateProps({"value":r})}}},o}(n.PreactBaseElement);function x(e,t){var r,i=[],u=[],l=[];return((r=e.querySelectorAll("[option]"))?Array.prototype.slice.call(r):[]).filter((function(n){var e;return!function(n,e){return n.closest?n.closest(e):function(n,e,t){var r;for(r=n;r&&undefined!==r;r=r.parentElement)if(e(r))return r;return null}(n,(function(n){return function(n,e){var t=n.matches||n.webkitMatchesSelector||n.mozMatchesSelector||n.msMatchesSelector||n.oMatchesSelector;return!!t&&t.call(n,"[option]")}(n)}))}(d(1==(null===(e=n.parentElement)||void 0===e?void 0:e.nodeType)),"[option]")})).forEach((function(e,r){var c=e.getAttribute("option")||r.toString(),a=e.hasAttribute("selected"),f={as:k,option:c,disabled:e.hasAttribute("disabled"),index:r,focus:function(){return s(e)},role:e.getAttribute("role")||"option",shimDomElement:e,postRender:function(){t.takeRecords()},selected:a};a&&l.push(c);var d=(0,n.createElement)(j,o(o({},f),{},{tabindex:e.getAttribute("tabindex")}));u.push(c),i.push(d)})),{value:l,children:i,options:u}}function k(t){var r=t.disabled,o=t.onClick,i=t.onFocus,u=t.onKeyDown,l=t.role,c=void 0===l?"option":l,a=t.selected,f=t.shimDomElement,s=b(e(t,O)),m=(0,n.useCallback)((function(n,e){if(e)return f.addEventListener(n,e),function(){return f.removeEventListener(n,d(e))}}),[f]);return(0,n.useLayoutEffect)((function(){return m("click",o)}),[o,m]),(0,n.useLayoutEffect)((function(){return m("focus",i)}),[i,m]),(0,n.useLayoutEffect)((function(){return m("keydown",u)}),[u,m]),(0,n.useLayoutEffect)((function(){v(f,"selected",!!a)}),[f,a]),(0,n.useLayoutEffect)((function(){v(f,"disabled",!!r),f.setAttribute("aria-disabled",!!r)}),[f,r]),(0,n.useLayoutEffect)((function(){f.setAttribute("role",c)}),[f,c]),(0,n.useLayoutEffect)((function(){null!=s&&f.setAttribute("tabindex",s)}),[f,s]),(0,n.createElement)("div",null)}function A(t){var r,o=t.children,i=t.disabled,u=t.form,l=t.multiple,c=t.name,a=t.onKeyDown,f=t.role,s=void 0===f?"listbox":f,m=t.shimDomElement,p=t.value,y=b(e(t,S)),h=(0,n.useRef)(null);h.current||(h.current=("input",r={"hidden":""},function(n,e){for(var t in e)n.setAttribute(t,e[t]);return n}(m.ownerDocument.createElement("input"),r))),(0,n.useLayoutEffect)((function(){var n=h.current;return m.insertBefore(n,m.firstChild),function(){return m.removeChild(n)}}),[m]);var w=(0,n.useCallback)((function(n,e){e?h.current.setAttribute(n,e):h.current.removeAttribute(n)}),[]);return(0,n.useLayoutEffect)((function(){return w("form",u)}),[u,w]),(0,n.useLayoutEffect)((function(){return w("name",c)}),[c,w]),(0,n.useLayoutEffect)((function(){return w("value",p)}),[p,w]),(0,n.useLayoutEffect)((function(){if(a)return m.addEventListener("keydown",a),function(){return m.removeEventListener("keydown",d(a))}}),[m,a]),(0,n.useLayoutEffect)((function(){v(m,"multiple",!!l),m.setAttribute("aria-multiselectable",!!l)}),[m,l]),(0,n.useLayoutEffect)((function(){v(m,"disabled",!!i),m.setAttribute("aria-disabled",!!i)}),[m,i]),(0,n.useLayoutEffect)((function(){m.setAttribute("role",s)}),[m,s]),(0,n.useLayoutEffect)((function(){null!=y&&m.setAttribute("tabindex",y)}),[m,y]),(0,n.createElement)("div",{children:o})}g.Component=w,g.detached=!0,g.props={"disabled":{attr:"disabled",type:"boolean"},"form":{attr:"form"},"multiple":{attr:"multiple",type:"boolean"},"name":{attr:"name"},"role":{attr:"role"},"tabindex":{attr:"tabindex"},"keyboardSelectMode":{attr:"keyboard-select-mode",media:!0}},(0,n.defineBentoElement)("bento-selector",g,undefined)}))}();
//# sourceMappingURL=bento-selector-1.0.js.map