;
(self.AMP=self.AMP||[]).push({m:1,v:"2301041800000",n:"amp-nested-menu",ev:"0.1",l:!0,f:function(e,n){(()=>{var n,t="ArrowLeft",s="ArrowUp",i="ArrowDown",u="Home";function r(e){return e?Array.prototype.slice.call(e):[]}var{hasOwnProperty:o,toString:a}=Object.prototype;function m(e,n){return e.querySelector(function(e,n){return e.replace(/^|,/g,"$&:scope ")}(n))}function p(e,n,t){let s;for(s=e;s&&s!==t;s=s.parentElement)if(n(s))return s;return null}function d(e,n){return e.closest(n)}function l(e){try{e.focus()}catch(e){}}self.__AMP_LOG=self.__AMP_LOG||{user:null,dev:null,userForEmbed:null};var c=self.__AMP_LOG;function h(e){return function(e,n){throw new Error("failed to call initLogConstructor")}()}function b(e,n,t,s,i,u,r,o,a,m,p){return e}function f(e,n,t,s,i,u,r,o,a,m,p){return(c.user||(c.user=h()),void c.user.win?c.userForEmbed||(c.userForEmbed=h()):c.user).assert(e,n,t,s,i,u,r,o,a,m,p)}function _(e){return e.nodeType?(t=e,n=(t.ownerDocument||t).defaultView,function(e,n){return A(e=function(e){return e.__AMP_TOP||(e.__AMP_TOP=e)}(e),"ampdoc")}(n)).getAmpDoc(e):e;var n,t}function A(e,n){b(P(e,n));const t=function(e){let n=e.__AMP_SERVICES;return n||(n=e.__AMP_SERVICES={}),n}(e)[n];return t.obj||(b(t.ctor),b(t.context),t.obj=new t.ctor(t.context),b(t.obj),t.context=null,t.resolve&&t.resolve(t.obj)),t.obj}function P(e,n){const t=e.__AMP_SERVICES&&e.__AMP_SERVICES[n];return!(!t||!t.ctor)}var v=e=>A(e,"timer"),g="amp-nested-menu",y="left",E="right",w=class extends e.BaseElement{static prerenderAllowed(){return!0}constructor(e){super(e),this.Uu=this.win.document,this.Da=null,this.bL=null,this.AL=e,this._D=this.Td.bind(this),this.PL=this.yL.bind(this)}buildCallback(){const{element:e}=this;var n;this.Da=(e=>function(e,n){const t=function(e){const n=_(e);return n.isSingleDoc()?n.win:n}(_(e));return P(t,n)?A(t,n):null}(this.element,"action"))(),this.bL=e.getAttribute("side"),this.bL!=y&&this.bL!=E&&(this.bL="rtl"==((n=this.Uu).body.getAttribute("dir")||n.documentElement.getAttribute("dir")||"ltr")?y:E,e.setAttribute("side",this.bL)),this.registerAction("reset",this.reset.bind(this)),e.addEventListener("click",this._D),e.addEventListener("keydown",this.PL)}layoutCallback(){return this.EL(),n||(n=Promise.resolve(void 0))}EL(){r(this.element.querySelectorAll("[amp-nested-submenu-open],[amp-nested-submenu-close]")).forEach((e=>{e.hasAttribute("tabindex")||e.setAttribute("tabindex",0),e.setAttribute("role","button"),e.hasAttribute("amp-nested-submenu-open")&&e.setAttribute("aria-expanded","false"),f(0==this.Da.hasAction(e,"tap"),"submenu open/close buttons should not have tap actions registered.")}))}isLayoutSupported(e){return"fill"==e}Td(e){const n=e.target,t=d(e.target,"[amp-nested-submenu-open],[amp-nested-submenu-close]");t&&this.WD(n,t)&&(t.hasAttribute("amp-nested-submenu-open")?this.ML(t):this.IL(t))}WD(e,n){const t=!!p(e,(e=>"A"==e.tagName),n),s=this.Da.hasAction(e,"tap",n);return!t&&!s}ML(e){const n=m(e.parentElement,">[amp-nested-submenu]");f(n,`${g} requires each submenu open button to have a submenu as its sibling`),this.RL(n)}RL(e){if(e.hasAttribute("open"))return;const n=this.TL(e);n&&(n.setAttribute("child-open",""),e.setAttribute("open",""),this.AL=e,v(this.win).delay((()=>{m(e.parentElement,">[amp-nested-submenu-open]").setAttribute("aria-expanded","true");const n=r(e.querySelectorAll("[amp-nested-submenu-close]")).filter((n=>this.TL(n)==e))[0];f(n,`${g} requires each submenu to contain at least one submenu close button`),l(n)}),350))}IL(e){const n=d(e,"[amp-nested-submenu]");f(n,`${g}: submenu close buttons are only allowed inside submenus`),this.gR(n)}gR(e){if(!e.hasAttribute("open"))return;const n=this.TL(e);n&&(n.removeAttribute("child-open"),e.removeAttribute("open"),this.AL=n,v(this.win).delay((()=>{const n=m(e.parentElement,">[amp-nested-submenu-open]");n.setAttribute("aria-expanded","false"),l(n)}),350))}reset(){for(;this.element.hasAttribute("child-open");)this.gR(this.AL)}yL(e){if(!e.defaultPrevented)switch(e.key){case"Enter":case" ":return void this.Td(e);case t:case"ArrowRight":this.VL(e);break;case s:case i:case u:case"End":this.kL(e)}}VL(e){let n=e.key==t;if(this.bL==y&&(n=!n),n)this.gR(this.AL);else{const n=e.target;n.hasAttribute("amp-nested-submenu-open")&&this.ML(n)}}kL(e){const n=e.target,t=p(n,(e=>"LI"==e.tagName),this.TL(n));if(!t)return;let r;if(e.key===s)r=t.previousElementSibling;else if(e.key===i)r=t.nextElementSibling;else if(e.key===u)r=t.parentElement.firstElementChild;else{if("End"!==e.key)return;r=t.parentElement.lastElementChild}if(!r)return;const o=r.querySelector("button,a[href],[tabindex]");o&&(e.preventDefault(),l(o))}TL(e){return d(e.parentElement,"amp-nested-menu,[amp-nested-submenu]")}};e.registerElement(g,w,"amp-nested-menu,amp-nested-menu [amp-nested-submenu]{position:absolute!important;top:0!important;width:100%!important;height:100%!important;margin:0!important;padding:0!important;transform:translateX(0)!important}amp-nested-menu.i-amphtml-layout-size-defined{overflow:visible!important}amp-nested-menu ol,amp-nested-menu ul{list-style-type:none;padding:0}amp-nested-menu [amp-nested-submenu-close],amp-nested-menu [amp-nested-submenu-open]{cursor:pointer}amp-nested-menu [amp-nested-submenu]{opacity:0!important;visibility:hidden!important;transition:transform 233ms,opacity 233ms,visibility 0s 233ms}amp-nested-menu,amp-nested-menu [amp-nested-submenu][open]{opacity:1!important;visibility:visible!important;transition:transform 233ms}amp-nested-menu [amp-nested-submenu][child-open],amp-nested-menu[child-open]{visibility:hidden!important;transition:transform 233ms,visibility 0s 233ms}amp-nested-menu[side=left] [amp-nested-submenu]{right:100%!important}amp-nested-menu[side=right] [amp-nested-submenu]{left:100%!important}amp-nested-menu[side=left] [amp-nested-submenu][child-open],amp-nested-menu[side=left][child-open]{transform:translateX(100%)!important}amp-nested-menu[side=right] [amp-nested-submenu][child-open],amp-nested-menu[side=right][child-open]{transform:translateX(-100%)!important}\n/*# sourceURL=/extensions/amp-nested-menu/0.1/amp-nested-menu.css*/")})();
/*! https://mths.be/cssescape v1.5.1 by @mathias | MIT license */}});
//# sourceMappingURL=amp-nested-menu-0.1.mjs.map