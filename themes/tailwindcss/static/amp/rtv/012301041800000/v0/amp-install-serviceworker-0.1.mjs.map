{"version":3,"file":"amp-install-serviceworker-0.1.mjs","mappings":"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","names":["hasOwnProperty","hasOwn_","toString","toString_","Object","prototype","element","opt_display","undefined","hasAttribute","removeAttribute","setAttribute","self","__AMP_LOG","user","dev","userForEmbed","logs","opt_element","getUserLogger","win","ownerDocument","defaultView","isFromEmbed","suffix","levelFunc","opt_suffix","Error","callLogConstructor","shouldBeTrueish","opt_message","opt_1","opt_2","opt_3","opt_4","opt_5","opt_6","opt_7","opt_8","opt_9","assert","id","getServiceInternal","__AMP_TOP","getTopWindow","nodeOrDoc","nodeType","node","getService","getAmpDoc","ampdoc","getAmpdoc","isSingleDoc","holder","devAssert","isServiceRegistered","s","services","__AMP_SERVICES","getServices","obj","ctor","context","resolve","service","optsSupported","Services","elementOrAmpDoc","getAmpdocServiceHolder","getServiceForDocOrNull","url","index","indexOf","substring","Set","TAG","AmpInstallServiceWorker","AMP","BaseElement","constructor","window","super","this","iframeSrc_","urlRewriter_","isSafari_","isSafari","buildCallback","navigator","maybeInstallUrlRewrite_","urlService","getUrlService_","src","getAttribute","assertHttpsUrl","isProxyOrigin","location","href","parse","origin","whenLoadedAndVisiblePromise_","then","options","scope","serviceWorker","register","registration","installingSw","installing","addEventListener","evt","target","state","performServiceWorkerOptimizations","active","e","error","install","iframeSrc","docInfo","getServiceForDoc","get","sourceUrl","canonicalUrl","userAssert","insertIframe_","Promise","all","loadPromise","whenFirstVisible","mutateElement","toggle","iframe","document","createElement","appendChild","winUrl","urlMatch","urlMatchExpr","shellUrl","removeFragment","RegExp","createError","getSourceOrigin","UrlRewriter_","isSecure","waitToPreloadShell_","preloadShell_","_element$parentElemen","parentElement","removeChild","urlMatchExpr_","shellUrl_","urlService_","shellLoc_","eventType","listener","opt_evtListenerOpts","localElement","localListener","capture","removeEventListener","err","detectEvtListenerOptsSupport","event","__AMP_REPORT_ERROR","internalListenImplementation","listen","getRootNode","handle_","bind","defaultPrevented","closest","tgtLoc","pathname","test","encodeURIComponent","search","hash","ampScriptsUsed","performance","getEntriesByType","filter","item","initiatorType","name","startsWith","urls","cdn","map","script","activeSW","postMessage","JSON","stringify","type","payload","sendAmpScriptToSwOnFirstVisit","links","call","querySelectorAll","link","doc","fakeLink","relList","supports","supportsPrefetch","forEach","linkTag","head","prefetchOutgoingLinks","registerElement"],"sourceRoot":"https://raw.githubusercontent.com/ampproject/amphtml/2301041800000/","sources":["src/core/types/object/index.js","src/core/dom/style.js","src/utils/log.js","src/service-helpers.js","src/core/window/index.js","src/service/index.js","src/core/dom/event-helper-listen.js","src/url.js","extensions/amp-install-serviceworker/0.1/amp-install-serviceworker.js","src/core/dom/index.js","src/utils/event-helper.js","src/core/dom/query.js"]}
