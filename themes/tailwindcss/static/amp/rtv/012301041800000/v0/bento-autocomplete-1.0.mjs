;
var t,e,r=Object.create,n=Object.defineProperty,o=Object.getOwnPropertyDescriptor,i=Object.getOwnPropertyNames,a=Object.getPrototypeOf,u=Object.prototype.hasOwnProperty,s=(t={"third_party/fuzzysearch/index.js"(t,e){e.exports=function(t,e){var r=e.length,n=t.length;if(n>r)return!1;if(n===r&&t===e)return!0;t:for(var o=0,i=0;o<n;o++){for(var a=t.charCodeAt(o);i<r;)if(e.charCodeAt(i++)===a)continue t;return!1}return!0}}},function(){return e||(0,t[Object.keys(t)[0]])((e={exports:{}}).exports,e),e.exports});function l(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function c(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function d(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?c(Object(r),!0).forEach((function(e){l(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}import f from"./bento-mustache-1.0.mjs";var{isArray:p}=Array;function m(t,e,r){return"number"!=typeof r&&(r=0),!(r+e.length>t.length)&&-1!==t.indexOf(e,r)}var{hasOwnProperty:b,toString:h}=Object.prototype;function v(t,e){return b.call(t,e)}function g(t,e){return v(t,e)?t[e]:void 0}function y(t,e){if("."==e)return t;const r=e.split(".");let n=t;for(const t of r){if(!(t&&n&&void 0!==n[t]&&"object"==typeof n&&v(n,t))){n=void 0;break}n=n[t]}return n}function x(t,e){try{return function(t){return JSON.parse(t)}(t)}catch(t){return null==e||e(t),null}}import{createElement as j}from"../bento.mjs";import{PreactBaseElement as w}from"../bento.mjs";function O(t,e){return t.querySelectorAll(function(t,e){return t.replace(/^|,/g,"$&:scope ")}(e))}function E(t,e){return t.matches(e)}import{createElement as $}from"../bento.mjs";import{useCallback as k,useEffect as S,useMemo as P,useRef as _,useState as z}from"../bento.mjs";import{ContainWrapper as U,useValueRef as A}from"../bento.mjs";import{useCallback as I,useEffect as M}from"../bento.mjs";import{useValueRef as D}from"../bento.mjs";import{useCallback as F,useEffect as R,useRef as T,useState as C}from"../bento.mjs";var q,V,J=()=>{},N={loading:!1,error:null},L={fetchJson(t,e){return this.fetch(t,e).then((t=>t.json()))},fetch(t,e){return r=this,n=function*(){const r=yield self.fetch(t,e);if(!r.ok)throw new Error(r.statusText);return r},new Promise(((t,e)=>{var o=t=>{try{a(n.next(t))}catch(t){e(t)}},i=t=>{try{a(n.throw(t))}catch(t){e(t)}},a=e=>e.done?t(e.value):Promise.resolve(e.value).then(o,i);a((n=n.apply(r,null)).next())}));var r,n}},B=(q=s(),((t,e,r)=>{if(e&&"object"==typeof e||"function"==typeof e)for(let a of i(e))u.call(t,a)||"default"===a||n(t,a,{get:()=>e[a],enumerable:!(r=o(e,a))||r.enumerable});return t})((V=n(null!=q?r(a(q)):{},"default",q&&q.__esModule&&"default"in q?{get:()=>q.default,enumerable:!0}:{value:q,enumerable:!0}),n(V,"__esModule",{value:!0})),q));import{cloneElement as H,isValidElement as G}from"../bento.mjs";function K({id:t,item:e,itemTemplate:r,onError:n=(()=>{}),selected:o=!1,onMouseDown:i=(()=>{})}){const a=r(e);if(!G(a))return a;const u=a.props["data-disabled"];return a.props["data-value"]||u||n('expected a "data-value" or "data-disabled" attribute on the rendered template item.'),H(a,d({"aria-disabled":u,"aria-selected":o,class:"autocomplete-item autocomplete-item-5d2ea1e"+(o?" autocomplete-item-active-5d2ea1e":""),dir:"auto",id:t,key:t,onMouseDown:i,part:"option",role:"option"},a.props))}function Q(t){return t?"option"===t.getAttribute("role")?t:Q(t.parentElement):null}function W(t){var e,r;return(null==t?void 0:t.getAttribute("data-value"))||(null==t||null===(e=t.firstElementChild)||void 0===e?void 0:e.getAttribute("data-value"))||(null==t||null===(r=t.textContent)||void 0===r?void 0:r.trim())||""}function X(t){return null==t?void 0:t.querySelectorAll('[role="option"]:not([data-disabled=true])')}import{Fragment as Y,createElement as Z}from"../bento.mjs";function tt({fuzzy:t,substring:e,text:r}){const n=e.toLocaleLowerCase(),o=r.toLocaleLowerCase();if(t)return Z(Y,null,r.split("").map((t=>n.includes(t.toLocaleLowerCase())?Z("span",{class:"autocomplete-partial"},t):t)));const i=o.indexOf(n),a=i+e.length;return Z(Y,null,r.slice(0,i),Z("span",{class:"autocomplete-partial"},r.slice(i,a)),r.slice(a,r.length))}function et(t){return(t=t.replace(/[\.]+/g,"")).split(/[`~(){}_|+\-;:\'",\[\]\\\/ ]+/g)}var rt=t=>t?new class{constructor(t){this.Ye="",this.m5=new RegExp(""),this.d5=null,this.Ye=t;const e=this.Ye.replace(/([()[{*+.$^\\|?])/g,"\\$1"),r=`((${e}|^${e})(\\w+)?)`;this.m5=new RegExp(r,"gm")}get shouldShowOnFocus(){return!1}b5(t){const e=this.m5,{selectionStart:r,value:n}=t;let o,i;for(;null!==(o=e.exec(n))&&!(o[0].length+g(o,"index")>r);)i=o;return!i||i[0].length+g(i,"index")<r?null:i}shouldAutocomplete(t){const e=this.b5(t);return this.d5=e,!!e}getUserInputForUpdate(){return this.d5&&this.d5[0]?this.d5[0].slice(this.Ye.length):""}shouldPreventDefaultOnEnter(t){return t}}(t):new class{get shouldShowOnFocus(){return!0}shouldAutocomplete(){return!0}getUserInputForUpdate(t){return t.value||""}shouldPreventDefaultOnEnter(t,e){return!e}};self.__AMP_LOG=self.__AMP_LOG||{user:null,dev:null,userForEmbed:null},self.__AMP_LOG,new Set(["c","v","a","ad"]);var nt=["substring","prefix","token-prefix","fuzzy","custom","none"],ot=t=>y(t,"items"),it=class extends w{K4(t){const e=x(t.textContent,(t=>{throw t})),r=this.element.getAttribute("items")||"items",n=y(e,r);if(!n)return this.win.console.warn(`Expected key "${r}" in data but found nothing. Rendering empty results.`),[];if(!p(n))throw new Error("Items must be array type");return n}getDefaultProps(){const t=super.getDefaultProps(),e=this.element.querySelector('script[type="application/json"]');if(e){const r=this.K4(e);return d(d({},t),{},{items:r})}return this.element.hasAttribute("src")||this.win.console.warn('Expected a <script type="application/json"> child or a URL specified in "src"'),t}checkPropsPostMutations(){const t=function(t,e="template"){if(t.hasAttribute(e)){const n=t.getAttribute(e);return Boolean(n)?t.ownerDocument.querySelector(`template#${r=n,CSS.escape(r)}`):null}var r;return t.querySelector("template")}(this.element);t&&this.mutateProps({"itemTemplate":e=>{const r=f.render(t.innerHTML,e);return j("div",{dangerouslySetInnerHTML:{__html:r}})}})}};it.Component=function({children:t,filter:e="none",filterValue:r="value",highlightUserEntry:n=!1,id:o,inline:i,items:a=[],itemTemplate:u,maxItems:s,minChars:l=1,onError:c=(()=>{}),onSelect:f=(()=>{}),parseJson:p=ot,prefetch:b=!1,src:h,submitOnEnter:j=!1,suggestFirst:w=!1,query:q}){const V=_(null),H=A(o||`${Math.floor(100*Math.random())}_AMP_content_`),G=_(null),Y=_(null),[Z,it]=z(""),[at,ut]=z(-1),[st,lt]=z(!1),[ct,dt]=z(w),[ft,pt]=z(!1),[mt,bt]=z(!1),ht=rt(i),vt=P((()=>h&&q?Z?function(t,e,r,n){return function(t,e,r){if(!e)return t;const n=t.split("#",2),o=n[0].split("?",2);let i=o[0]+(o[1]?`?${o[1]}&${e}`:`?${e}`);return i+=n[1]?`#${n[1]}`:"",i}(t,function(t,e){return`${encodeURIComponent(t)}=${encodeURIComponent(e)}`}(e,r))}(h,q,Z):null:h),[h,Z,q]),gt=P((()=>{if(vt){if(q)return!mt;if(!ft)return b||st}return!1}),[vt,ft,mt,q,b,st]),yt=P((()=>!!q),[q]),{data:xt}=function(t,{enabled:e,initialData:r,onSettled:n=J,onSuccess:o=J,onError:i=J}){const[a,u]=function(t){const e=T(!1);R((()=>(e.current=!0,()=>{e.current=!1})),[]);const[r,n]=C(t);return[r,F((t=>{e.current&&n(t)}),[n])]}(d(d({},N),{},{data:r})),s=D({initialData:r,onSettled:n,onError:i,onSuccess:o,state:a,queryFn:t}),l=I((()=>{const{onError:t,onSettled:e,onSuccess:r,queryFn:n,state:o}=s.current;u((t=>d(d({},t),{},{error:null,loading:!0}))),n().then((t=>{u((e=>d(d({},e),{},{error:null,loading:!1,data:t}))),r(t),e(o.data,o.error)}),(r=>{u((t=>d(d({},t),{},{data:null,loading:!1,error:r}))),t(r),e(o.data,o.error)}))}),[s,u]);return M((()=>{e&&l()}),[e,l]),d(d({},a),{},{refetch:l})}((()=>L.fetchJson(vt).then((t=>p(t)))),{enabled:gt,initialData:a,onSettled:()=>{pt(!0),bt(!0)},onError:t=>{c(t.message)}}),jt=k((t=>{G.current.value=t}),[G]),wt=k((t=>{var e;null===(e=G.current)||void 0===e||e.setAttribute("aria-expanded",t.toString()),lt(t)}),[]),Ot=k((()=>{var t;ut(-1),null===(t=G.current)||void 0===t||t.removeAttribute("aria-activedescendant")}),[G]),Et=k((()=>{wt(!0)}),[wt]),$t=k((()=>{Ot(),wt(!1)}),[wt,Ot]),kt=k((()=>{jt(Z)}),[Z,jt]),St=k(((t,e)=>{jt(t),it(t);const r=d({value:t},e?{valueAsObject:e}:{});f(r),$t()}),[f,jt,$t]),Pt=k((t=>`${H.current}-${t}`),[H]),_t=k((t=>{const e="input,textarea";let r=O(t,e);if(0===r.length){const n=t.querySelector("slot");n&&(r=function(t,e){const r=t.assignedElements(),n=[];for(let t=0;t<r.length;t++){const o=r[t];E(o,e)&&n.push(o),O(o,e).forEach((t=>n.push(t)))}return n}(n,e))}if(1===r.length)return r[0];c("should contain exactly one <input> or <textarea> descendant.")}),[c]),zt=k((t=>{const e=_t(t);if(e){if(e.hasAttribute("type")){const t=e.getAttribute("type");"text"!==t&&"search"!==t&&c('requires the "type" attribute to be "text" or "search" if present on <input>.')}e.classList.add("input-5d2ea1e"),e.setAttribute("dir","auto"),e.setAttribute("aria-autocomplete","both"),e.setAttribute("aria-controls",H.current),e.setAttribute("aria-expanded","false"),"INPUT"===e.tagName?e.setAttribute("role","combobox"):e.setAttribute("role","textbox"),G.current=e}}),[_t,c,"input-5d2ea1e",H]),Ut=k((()=>{var t;t=e,nt.includes(t)||c(`Unexpected filter: ${e}.`),!i&&w&&"prefix"!==e&&(c('"suggest-first" expected "filter" type "prefix".'),dt(!1))}),[e,c,i,w]),At=P((()=>!(!st||0===(null==xt?void 0:xt.length))&&Z.length>=l),[xt,Z,l,st]),It=k(((t=[])=>s&&s<t.length?t.slice(0,s):t),[s]),Mt=P((()=>{const t=Z.toLocaleLowerCase(),n=null==xt?void 0:xt.filter((n=>{if("object"==typeof n&&(n=y(n,r)),"string"==typeof n)switch(n=n.toLocaleLowerCase(),e){case"none":return!0;case"substring":return m(n,t);case"prefix":return n.startsWith(t);case"token-prefix":return function(t,e){if(""===e)return!0;const r=et(t),n=et(e),o=function(t){const e=Object.create(null);return t.forEach((t=>{const r=v(e,t)?g(e,t)+1:1;e[t]=r})),e}(r),i=n[n.length-1];n.splice(n.length-1,1);let a=!0;for(let t=0;t<n.length;t++){const e=n[t];if(""===e)continue;if(!v(o,e)){a=!1;break}const r=Number(g(o,e));r>1?o[e]=r-1:delete o[e]}const u=Object.keys(o);return a&&(""===i||u.some((t=>t.startsWith(i))))}(n,t);case"fuzzy":return(0,B.default)(t,n);case"custom":throw new Error(`Filter not yet supported: ${e}`);default:throw new Error(`Unexpected filter: ${e}`)}else c(`data property "${r}" must map to string type.`)}));return It(n)}),[xt,e,Z,r,c,It]),Dt=k((t=>{var e;const r=-1===at&&t<0?t:at+t,n=X(V.current);if(0===t||!At)return;const o=(i=r,a=(null==n?void 0:n.length)||0,i>0&&a>0?i%a:(i%a+a)%a);var i,a;const u=null==n?void 0:n.item(o);ut(o),null===(e=G.current)||void 0===e||e.setAttribute("aria-activedescendant",Pt(r)),jt(W(u))}),[at,Pt,At,jt]),Ft=k((t=>{yt&&bt(!1),it(ht.getUserInputForUpdate(t)),Et()}),[yt,Et,ht]),Rt=k((t=>{const e=t.target;ht.shouldAutocomplete(e)&&Ft(e)}),[ht,Ft]),Tt=k((()=>{ht.shouldShowOnFocus&&Et()}),[Et,ht]),Ct=k((t=>{const e=at>-1;switch(t.key){case"ArrowDown":{t.preventDefault();const e=X(V.current)||[];if(at===e.length-1)return kt(),void Ot();Dt(1);break}case"ArrowUp":if(t.preventDefault(),0===at)return kt(),void Ot();Dt(-1);break;case"Enter":{const e=at>-1;ht.shouldPreventDefaultOnEnter(e,j)&&t.preventDefault(),St(G.current.value);break}case"Escape":kt(),$t();break;case"Tab":st&&e&&(t.preventDefault(),St(G.current.value))}}),[at,Dt,kt,$t,Ot,St,ht,j,st]),qt=k((t=>{const e=Q(t.target);if(null==e||!e.hasAttribute("data-disabled")){const t=W(e),r=function(t){return null!=t&&t.hasAttribute("data-json")?x(t.getAttribute("data-json"),(t=>{throw t})):null}(e);St(t,r)}}),[St]),Vt=k((t=>{if(n&&Z.length>0){if(m(t.toLocaleLowerCase(),Z.toLocaleLowerCase()))return $(tt,{text:t,substring:Z});if("fuzzy"===e)return $(tt,{text:t,substring:Z,fuzzy:!0})}return t}),[n,Z,e]),Jt=k((t=>"object"==typeof t?u||(c("data must provide template for non-string items."),()=>null):t=>$("div",{"data-value":t},Vt(t))),[u,Vt,c]);return S((()=>{ct&&-1===at&&Dt(1)}),[at,Dt,ct]),S((()=>{var t,e,r,n;return zt(V.current),Ut(),null===(t=G.current)||void 0===t||t.addEventListener("input",Rt),null===(e=G.current)||void 0===e||e.addEventListener("keydown",Ct),null===(r=G.current)||void 0===r||r.addEventListener("focus",Tt),null===(n=G.current)||void 0===n||n.addEventListener("blur",$t),()=>{var t,e,r,n;null===(t=G.current)||void 0===t||t.removeEventListener("input",Rt),null===(e=G.current)||void 0===e||e.removeEventListener("keydown",Ct),null===(r=G.current)||void 0===r||r.removeEventListener("focus",Tt),null===(n=G.current)||void 0===n||n.removeEventListener("blur",$t)}}),[zt,Ut,Rt,Ct,Tt,$t,G]),$(U,{ref:V,class:"autocomplete-5d2ea1e",part:"autocomplete"},t,$("div",{ref:Y,id:H.current,class:"autocomplete-results-5d2ea1e",role:"listbox",hidden:!At,part:"results"},Mt.map(((t,e)=>{const r=Pt(e);return $(K,{key:r,item:t,itemTemplate:Jt(t),id:r,selected:at===e,onError:c,onMouseDown:qt})}))))},it.props={"children":{passthrough:!0},"filter":{attr:"filter"},"filterValue":{attr:"filter-value"},"highlightUserEntry":{attr:"highlight-user-entry",type:"boolean"},"id":{attr:"id"},"inline":{attr:"inline"},"maxItems":{attr:"max-items",type:"number"},"minChars":{attr:"min-chars",type:"number"},"prefetch":{attr:"prefetch",type:"boolean"},"src":{attr:"src"},"submitOnEnter":{attr:"submit-on-enter",type:"boolean"},"suggestFirst":{attr:"suggest-first",type:"boolean"},"query":{attr:"query",type:"string"}},it.layoutSizeDefined=!0,it.usesShadowDom=!0,it.shadowCss=".autocomplete-5d2ea1e{font-family:sans-serif}.input-5d2ea1e{box-sizing:border-box;border-radius:4px}.autocomplete-results-5d2ea1e{width:calc(100% - 1rem);z-index:10;position:absolute;min-width:calc(2em + 2rem);box-shadow:0px 2px 4px 0px rgba(0,0,0,0.5);margin-top:.5rem;max-height:40vh;overflow-x:hidden;overflow-y:auto;margin-left:-.5rem;border-radius:4px;background-color:#fff}.autocomplete-item-5d2ea1e{cursor:pointer;padding:.5rem 1rem;position:relative}.autocomplete-item-5d2ea1e:first-child{border-radius:4px 4px 0 0}.autocomplete-item-5d2ea1e:nth-last-child(2){border-radius:0 0 4px 4px}.autocomplete-item-5d2ea1e:hover:not([data-disabled]){background-color:rgba(0,0,0,0.15)}.autocomplete-item-5d2ea1e[data-disabled]{color:rgba(0,0,0,0.33)}.autocomplete-item-5d2ea1e>.autocomplete-partial{font-weight:700}.autocomplete-item-active-5d2ea1e:not([data-disabled]){background-color:rgba(0,0,0,0.15)}";import{defineBentoElement as at}from"../bento.mjs";at("bento-autocomplete",it,void 0);
/*! https://mths.be/cssescape v1.5.1 by @mathias | MIT license */
//# sourceMappingURL=bento-autocomplete-1.0.mjs.map