;
(self.AMP=self.AMP||[]).push({m:1,v:"2301041800000",n:"amp-next-page",ev:"1.0",l:!0,f:function(t,i){(()=>{function i(t){return t?Array.prototype.slice.call(t):[]}var{isArray:e}=Array,{hasOwnProperty:s,toString:n}=Object.prototype;function r(t){const i=Object.create(null);return t&&Object.assign(i,t),i}function o(t,i){return s.call(t,i)}function h(t,i,e,s,n,r,o,h,u,a,c){return t}function u(t,i){try{return function(t){return JSON.parse(t)}(t)}catch(t){return null==i||i(t),null}}function a(t){return(t.ownerDocument||t).defaultView}function c(t,i){return t.replace(/^|,/g,`$&${i} `)}function l(t){return CSS.escape(t)}function p(t){h(/^[\w-]+$/.test(t))}function f(t,i){return t.querySelector(c(i,":scope"))}function m(t,i){return p(i),f(t,`> [${i}]`)}function d(t,i){return p(i),e=`> ${i}`,t.querySelectorAll(c(e,":scope"));var e}function g(t){var i;null===(i=t.parentElement)||void 0===i||i.removeChild(t)}function v(t){for(;t.firstChild;)t.removeChild(t.firstChild)}function P(t,i){t.insertBefore(i,t.firstChild)}function _(t){if(Node.prototype.getRootNode)return t.getRootNode();let i;for(i=t;i.parentNode&&(!(e=i)||"I-AMPHTML-SHADOW-ROOT"!=e.tagName&&(11!=e.nodeType||"[object ShadowRoot]"!==Object.prototype.toString.call(e)));i=i.parentNode);var e;return i}function b(t){if(!t)return null;const i=t.match(/^(.*)\/(.*)-([0-9.]+|latest)(\.max)?\.(?:js|mjs)(?:\?ssr-css=[0|1])?$/i),e=i?i[2]:void 0,s=i?i[3]:void 0;return e&&s?{extensionId:e,extensionVersion:s}:null}self.__AMP_LOG=self.__AMP_LOG||{user:null,dev:null,userForEmbed:null};var x,w=self.__AMP_LOG;function A(t,i){throw new Error("failed to call initLogConstructor")}function R(t){return w.user||(w.user=y()),function(t,i){return i&&i.ownerDocument.defaultView!=t}(w.user.win,t)?w.userForEmbed||(w.userForEmbed=y()):w.user}function y(t){return A()}function E(){return w.dev||(w.dev=A())}function I(t,i,e,s,n,r,o,h,u,a,c){return t}function T(t,i,e,s,n,r,o,h,u,a,c){return R().assert(t,i,e,s,n,r,o,h,u,a,c)}function M(){return x||(x=Promise.resolve(void 0))}function S(t,i){return $(t=function(t){return t.__AMP_TOP||(t.__AMP_TOP=t)}(t),i)}function V(t,i){return $(j(N(t)),i)}function k(t,i){const e=j(N(t));return B(e,i)?$(e,i):null}function O(t,i){return C(j(t),i)}function N(t){return t.nodeType?(i=a(t),S(i,"ampdoc")).getAmpDoc(t):t;var i}function j(t){const i=N(t);return i.isSingleDoc()?i.win:i}function $(t,i){I(B(t,i));const e=L(t)[i];return e.obj||(I(e.ctor),I(e.context),e.obj=new e.ctor(e.context),I(e.obj),e.context=null,e.resolve&&e.resolve(e.obj)),e.obj}function C(t,i){const e=L(t)[i];return e?e.promise?e.promise:($(t,i),e.promise=Promise.resolve(e.obj)):null}function L(t){let i=t.__AMP_SERVICES;return i||(i=t.__AMP_SERVICES={}),i}function D(t){return"function"==typeof t.dispose}function U(t,i){if(D(i))try{(function(t){return I(D(t)),t})(i).dispose()}catch(i){E().error("SERVICE","failed to dispose service",t,i)}}function B(t,i){const e=t.__AMP_SERVICES&&t.__AMP_SERVICES[i];return!(!e||!e.ctor)}function H(t,i,e,s){const n=O(t,i);if(n)return n;const r=N(t);return r.whenExtensionsKnown().then((()=>{const t=r.getExtensionVersion(e);return t?S(r.win,"extensions").waitForExtension(e,t):null})).then((e=>e?s?O(t,i):function(t,i){return function(t,i){const e=C(t,i);if(e)return e;const s=L(t);return s[i]=function(){const t=new class{constructor(){this.promise=new Promise(((t,i)=>{this.resolve=t,this.reject=i}))}},{promise:i,reject:e,resolve:s}=t;return i.catch((()=>{})),{obj:null,promise:i,resolve:s,reject:e,context:null,ctor:null}}(),s[i].promise}(j(t),i)}(t,i):null))}var z,F,q=t=>function(t,i,e){const s=k(t,i);return s?Promise.resolve(s):H(t,i,"amp-bind")}(t,"bind"),W=t=>V(t,"mutator"),J=t=>V(t,"viewer"),Y=t=>S(t,"vsync"),Z=t=>V(t,"viewport"),K=t=>S(t,"xhr"),Q="prerender",G="visible",X="hidden";function tt(t){const i=t.ownerDocument||t;return z&&z.ownerDocument===i||(z=i.createElement("div")),it}function it(t){return function(t,i){if(h(1===i.length),h(Array.isArray(i)||o(i,"raw")),self.trustedTypes&&self.trustedTypes.createPolicy){const e=self.trustedTypes.createPolicy("static-template#createNode",{createHTML:function(t){return i[0]}});t.innerHTML=e.createHTML("ignored")}else t.innerHTML=i[0];const e=t.firstElementChild;return h(e),h(!e.nextElementSibling),t.removeChild(e),e}(z,t)}var et=["Webkit","webkit","Moz","moz","ms","O","o"];function st(t,i,e,s,n){const o=function(t,i,e){if(i.startsWith("--"))return i;F||(F=r());let s=F[i];if(!s||e){if(s=i,void 0===t[i]){const e=function(t){return t.charAt(0).toUpperCase()+t.slice(1)}(i),n=function(t,i){for(let e=0;e<et.length;e++){const s=et[e]+i;if(void 0!==t[s])return s}return""}(t,e);void 0!==t[n]&&(s=n)}e||(F[i]=s)}return s}(t.style,i,n);if(!o)return;const h=s?e+s:e;t.style.setProperty(function(t){const i=t.replace(/[A-Z]/g,(t=>"-"+t.toLowerCase()));return et.some((t=>i.startsWith(t+"-")))?`-${i}`:i}(o),h)}function nt(t,i){void 0===i&&(i=t.hasAttribute("hidden")),i?t.removeAttribute("hidden"):t.setAttribute("hidden","")}function rt(t,i,e={},s=!0){var n;(n=t,H(n,"amp-analytics-instrumentation","amp-analytics")).then((n=>{n&&n.triggerEventForTarget(t,i,e,s)}))}var ot={INSIDE:"inside",TOP:"top",BOTTOM:"bottom"};function ht(t,i){return!(!t||!i)&&t.left==i.left&&t.top==i.top&&t.width==i.width&&t.height==i.height}function ut(t){!function(t,i,e,s){const n=N(t),r=j(n);!function(t,i,e,s,n,r){const o=L(t);let h=o[e];h||(h=o[e]={obj:null,promise:null,resolve:null,reject:null,context:null,ctor:null,sharedInstance:!1}),h.ctor||(h.ctor=s,h.context=i,h.sharedInstance=!1,h.resolve&&$(t,e))}(r,n,i,class{constructor(t){this.ji=t,this.i=t.win,this.tO=[],this.Xh=Y(this.i),this.Tc=Z(t),this.O_=[],this.iO=!1,this.sO=!1,this.nO=!1,this.hO=function(t,i,e){let s=0,n=0,r=null;function o(){s=0;const h=e-(t.Date.now()-n);var u;h>0?s=t.setTimeout(o,h):(u=r,r=null,i.apply(null,u))}return function(...i){n=t.Date.now(),r=i,s||(s=t.setTimeout(o,e))}}(this.i,(()=>{this.iO=!1}),500)}observe(t,i,e){const s=new class{constructor(t,i,e,s){this.element=i,this.Xe=s,this.fidelity=e,this.turn=0==e?Math.floor(4*Math.random()):0,this.eO=null,this.Tc=Z(t)}Ye(t){const i=this.eO;if(i&&ht(i.positionRect,t.positionRect)&&ht(i.viewportRect,t.viewportRect))return;I(t.positionRect);const e=t.positionRect;var s,n;t.relativePos=(s=e,n=t.viewportRect,s.top<n.top?ot.TOP:s.bottom>n.bottom?ot.BOTTOM:ot.INSIDE),function(t,i){return t.top<=i.bottom&&i.top<=t.bottom&&t.left<=i.right&&i.left<=t.right}(e,t.viewportRect)?(this.eO=t,this.Xe(t)):this.eO&&(this.eO=null,t.positionRect=null,this.Xe(t))}update(t){if(!t){if(0!=this.turn)return void this.turn--;0==this.fidelity&&(this.turn=4)}const i=this.Tc.getSize(),e={left:0,top:0,width:s=i.width,height:n=i.height,bottom:0+n,right:0+s,x:0,y:0};var s,n;this.Tc.getClientRectAsync(this.element).then((t=>{this.Ye({positionRect:t,viewportRect:e,relativePos:null})}))}}(this.ji,t,i,e);return this.tO.push(s),this.nO||this.rO(),s.update(),()=>{for(let t=0;t<this.tO.length;t++)if(this.tO[t]==s)return void this.oO(t)}}unobserve(t){for(let i=0;i<this.tO.length;i++)if(this.tO[i].element==t)return void this.oO(i);E().error("POSITION_OBSERVER","cannot unobserve unobserved element")}oO(t){this.tO.splice(t,1),0==this.tO.length&&this.lO()}rO(){this.nO=!0,this.O_.push(this.Tc.onScroll((()=>{this.uO()}))),this.O_.push(this.Tc.onResize((()=>{this.cO()})))}lO(){for(this.nO=!1;this.O_.length;)this.O_.pop()()}updateAllEntries(t){for(let i=0;i<this.tO.length;i++)this.tO[i].update(t)}uO(){this.hO(),this.iO=!0,this.sO||this.aO()}cO(){this.updateAllEntries(!0)}aO(){this.updateAllEntries(),this.sO=!0,this.iO?this.Xh.measure((()=>{this.aO()})):this.sO=!1}})}(t,"position-observer")}var at,ct=class{constructor(t,i){this.zi=t,this.tit=null,this.iit=null,this.callback=i}get top(){return this.tit}get bottom(){return this.iit}observe(t,i){const e=t.ownerDocument.createElement("div");e.classList.add("i-amphtml-next-page-document-top-sentinel");const s=t.ownerDocument.createElement("div");s.classList.add("i-amphtml-next-page-document-bottom-sentinel"),i.insertBefore(e,t),i.insertBefore(s,t.nextSibling),this.zi.getPositionObserver().observe(e,0,(t=>this.eit(t))),this.zi.getPositionObserver().observe(s,0,(t=>this.sit(t)))}eit(t){this.tit=t.relativePos,this.zi.updateRelativePos(this)}sit(t){this.iit=t.relativePos,this.zi.updateRelativePos(this)}usesSentinel(){return!0}},lt=class extends ct{constructor(t,i,e){super(t,i),this.nit=e}usesSentinel(){return!1}get nextPageEl(){return this.nit}},pt="amp-next-page-hidden",ft=class{constructor(t,i){this.S_=t,this.zj=i.title,this.pi=i.url,this.rit=i.url,this.NY=i.image,this.oit=null,this.fn=null,this._N=null,this.Ri=1,this.D=Q,this.hit=2}get url(){return this.pi}set url(t){this.pi=t}get initialUrl(){return this.rit}get image(){return this.NY}get title(){return this.zj}get relativePos(){return this.hit}get document(){if(this.oit)return this.oit.ampdoc.getRootNode()}get container(){return this.fn}get shadowDoc(){return this.oit}set relativePos(t){this.hit=t}is(t){return this.Ri===t}isLoaded(){return 3===this.Ri||5===this.Ri||6===this.Ri}isVisible(){return this.isLoaded()&&this.D===G}setVisibility(t){this.isLoaded()&&t!=this.D&&(this.is(6)&&t===G&&this.resume(),this.D=t,this.oit&&(this.oit.setVisibilityState(t),this.oit.ampdoc.getBody().classList.toggle("amp-next-page-visible",this.isVisible()),this.oit.ampdoc.getBody().classList.toggle(pt,!this.isVisible())))}pause(){return this.oit?this.oit.close().then((()=>this.S_.closeDocument(this).then((()=>{this.oit=null,this.D=X,this.Ri=6})))):M()}resume(){return this.uit()}fetch(){return 5===this.Ri||2===this.Ri||3===this.Ri||4===this.Ri?M():(this.Ri=2,this.S_.fetchPageDocument(this).then((t=>(this.Ri=3,this._N=t,this.fn=this.S_.createDocumentContainerForPage(this),this.uit()))).catch((()=>{this.Ri=4})))}uit(){return this.S_.attachDocumentToPage(this,I(this._N),this.is(6)).then((t=>{t?(this.Ri=5,this.oit=t,this.is(6)||this.S_.setLastFetchedPage(this)):this.Ri=4}))}},mt=class extends ft{constructor(t,i,e,s,n){super(t,i),this.Ri=e,this.D=s,this.Uu=n}get document(){return this.Uu}},dt=(()=>self.AMP.config.urls)(),gt=new Set(["c","v","a","ad"]),vt=t=>"string"==typeof t?Pt(t):t;function Pt(t,i){return at||(at=self.document.createElement("a")),function(t,i,e){return t.href="",new URL(i,t.href)}(at,t)}function _t(t){if(!function(t){return dt.cdnProxyRegex.test(vt(t).origin)}(t=vt(t)))return t.href;const i=t.pathname.split("/"),e=i[1];T(gt.has(e),"Unknown path prefix in url %s",t.href);const s=i[2],n="s"==s?"https://"+decodeURIComponent(i[3]):"http://"+decodeURIComponent(s);return T(n.indexOf(".")>0,"Expected a . in origin %s",n),i.splice(1,"s"==s?3:2),n+i.join("/")+function(t,i){if(!t||"?"==t)return"";const e=new RegExp("[?&](amp_(js[^&=]*|gsa|r|kit)|usqp)\\b[^&]*","g"),s=t.replace(e,"").replace(/^[?&]/,"");return s?"?"+s:""}(t.search)+(t.hash||"")}function bt(t){return Pt(_t(t)).origin}function xt(t,i){const e=Pt(t),{origin:s}=Pt(i),n=bt(i);return T(e.origin===s||e.origin===n,"Invalid page URL supplied to amp-next-page, pages must be from the same origin as the current document"),e}var wt='.i-amphtml-next-page-document{overflow:hidden}.i-amphtml-next-page-document:not(.amp-next-page-visible) [i-amphtml-fixedid]{display:none}.i-amphtml-next-page-document.amp-next-page-visible{opacity:1;overflow:visible}.i-amphtml-next-page-document:after,.i-amphtml-next-page-document:before{content:" ";display:table}.i-amphtml-next-page-placeholder{background:#eee}.amp-next-page-separator{border-bottom:1px solid rgba(0,0,0,0.12)}.amp-next-page-links{border-top:1px solid rgba(0,0,0,0.1);margin-top:16px;display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column}.amp-next-page-link{border-bottom:1px solid rgba(0,0,0,0.1);display:block;overflow:auto;padding:10px 0;text-decoration:none}.amp-next-page-image{width:72px;height:72px;float:left;margin:0 10px;background-size:cover;background-position:50%}.amp-next-page-text{position:relative;margin:5px 30px 5px 0;color:#3c4043;font-size:17px}\n/*# sourceURL=/extensions/amp-next-page/1.0/amp-next-page.css*/',At={NONE:0,OPT_IN:1,ALL:2};var Rt,yt,Et="render-start",It="none";function Tt(){return void 0===yt&&(yt=St()!=It&&(Mt(Element.prototype.attachShadow)||Mt(Element.prototype.createShadowRoot))),yt}function Mt(t){return!!t&&-1!=t.toString().indexOf("[native code]")}function St(t){return void 0===Rt&&(i=t||Element,Rt=i.prototype.attachShadow?"v1":i.prototype.createShadowRoot?"v0":It),Rt;var i}function Vt(t,i,e){var s="";return t&&Array.prototype.forEach.call(t,(function(t){if(t.selectorText&&t.style&&void 0!==t.style.cssText)s+=function(t,i,e){var s=[];return t.split(",").forEach((function(t){t=t.trim(),e&&(t=e(t)),function(t,i){var e=function(t){return t=t.replace(/\[/g,"\\[").replace(/\]/g,"\\]"),new RegExp("^("+t+")"+Nt,"m")}(i);return!t.match(e)}(t,i)&&(t=function(t,i){return function(t,i){return t.match($t)?(t=t.replace(jt,i)).replace($t,i+" "):i+" "+t}(t,i)}(t,i)),s.push(t)})),s.join(", ")}(t.selectorText,i,e)+" {\n\t",s+=function(t){var i=t.style.cssText;t.style.content&&!t.style.content.match(/['"]+|attr/)&&(i=i.replace(/content:[^;]*;/g,"content: '"+t.style.content+"';"));var e=t.style;for(var s in e)"initial"===e[s]&&(i+=s+": initial; ");return i}(t)+"\n}\n\n";else if(t.type===CSSRule.MEDIA_RULE)s+="@media "+t.media.mediaText+" {\n",s+=Vt(t.cssRules,i),s+="\n}\n\n";else try{t.cssText&&(s+=t.cssText+"\n\n")}catch(t){}})),s}var kt="-shadowcsshost",Ot=")(?:\\(((?:\\([^)(]*\\)|[^)(]*)+?)\\))?([^,{]*)",Nt=(new RegExp("("+kt+Ot,"gim"),new RegExp("(-shadowcsscontext"+Ot,"gim"),"([>\\s~+[.,{:][\\s\\S]*)?$"),jt=kt+"-no-combinator",$t=new RegExp(kt,"gim");function Ct(t,i,e,s,n){const o=t.getHeadNode(),h=function(t,i,e,s){let n=t.__AMP_CSS_SM;n||(n=t.__AMP_CSS_SM=r());const o=!e&&s&&"amp-custom"!=s&&"amp-keyframes"!=s,h=e?"amp-runtime":o?`amp-extension=${s}`:null;if(h){const e=Lt(t,n,h);if(e)return"STYLE"==e.tagName&&e.textContent!==i&&(e.textContent=i),e}const u=(t.ownerDocument||t).createElement("style");u.textContent=i;let a=null;return e?u.setAttribute("amp-runtime",""):o?(u.setAttribute("amp-extension",s||""),a=Lt(t,n,"amp-runtime")):(s&&u.setAttribute(s,""),a=t.lastChild),function(t,i,e=null){if(!e)return void P(t,i);const s=e.nextSibling;t.insertBefore(i,s)}(t,u,a),h&&(n[h]=u),u}(o,function(t,i){const e=t.__AMP_CSS_TR;return e?e(i):i}(o,i),s||!1,n||null);if(e){const i=t.getRootNode();if(Dt(i,h))return e(h),h;const s=setInterval((()=>{Dt(i,h)&&(clearInterval(s),e(h))}),4)}return h}function Lt(t,i,e){if(i[e])return i[e];const s=t.querySelector(`style[${e}], link[${e}]`);return s?(i[e]=s,s):null}function Dt(t,i){const e=t.styleSheets;for(let t=0;t<e.length;t++)if(e[t].ownerNode==i)return!0;return!1}function Ut(t){d(t,"noscript").forEach(g)}new RegExp("-shadowcsscontext","gim");var Bt,Ht=/[^\.\-\_0-9a-zA-Z]/,zt=/[^\-\_0-9a-zA-Z]/;function Ft(t,i,e){const s=t.ownerDocument;let n;if(Tt())n=s.importNode(i,e);else{n=s.createElement("amp-body"),function(t,i){const{style:e}=t;h(!0),h(!e.display),e.display="block"}(n);for(let t=0;t<i.attributes.length;t++)n.setAttribute(i.attributes[0].name,i.attributes[0].value);if(e)for(let t=i.firstChild;t;t=t.nextSibling)n.appendChild(s.importNode(t,!0))}st(n,"position","relative");const r=t.body;return r&&t.removeChild(r),t.appendChild(n),Object.defineProperty(t,"body",{configurable:!0,value:n}),n}function qt(t){return t.replace(/(html|body)/g,Wt)}function Wt(t,i,e,s){const n=s.charAt(e-1),r=s.charAt(e+t.length);return n&&!Ht.test(n)||r&&!zt.test(r)?t:"amp-"+t}function Jt(t,i){const e=t.createElement("style");e.textContent=i;try{return(t.head||t.documentElement).appendChild(e),e.sheet?e.sheet.cssRules:null}finally{e.parentNode&&e.parentNode.removeChild(e)}}var Yt="multidoc-manager",Zt=['<div class=amp-next-page-separator aria-label="Next article separator" tabindex=0></div>'],Kt=['<div class=amp-next-page-links aria-label="Read more articles"></div>'],Qt=["<a class=amp-next-page-link><img ref=image class=amp-next-page-image> <span ref=title class=amp-next-page-text></span></a>"],Gt="amp-next-page",Xt="i-amphtml-next-page-shadow-root",ti="i-amphtml-next-page-placeholder",ii=()=>M(),ei=class extends t.BaseElement{constructor(t){super(t),this.ait=null}isLayoutSupported(t){return"container"===t}buildCallback(){return this.ait=V(this.element,"next-page"),this.ait.build(this.element)}};t.registerServiceForDoc("next-page",class{constructor(t){this.ji=t,this.i=t.win,this.yf=this.i.document,this.Tc=Z(t),this.br=J(t),this.ja=W(t),this.tM=V(t,"templates"),this.snt=null,this.cit=null,this.lit=ii,this.pit=!1,this.fit=null,this.mit=null,this.dit=null,this.ont=null,this.uh=null,this.h$=null,this.CR,this.git=null,this.vit=null,this.Pit=null,this._it={},this.bit=!1,this.xit=1/0,this.wit=null,this.Pi=null,this.fi=new Promise((t=>{this.Pi=t}))}isBuilt(){return!!this.CR}build(s){if(this.isBuilt())return M();this.ji.getBody().lastElementChild,this.mit=s,this.wit=this.Ait().getAttribute("src"),this.bit=this.Ait().hasAttribute("deep-parsing")?"false"!==this.Ait().getAttribute("deep-parsing"):!this.wit,this.xit=this.Ait().hasAttribute("max-pages")?parseInt(this.Ait().getAttribute("max-pages"),10):1/0,this.snt=this.Rit(s),this.cit=this.yit(s),this.vit=this.createHostPage(),this.Pit=this.vit,this.toggleHiddenAndReplaceableElements(this.yf),P(this.mit,this.cit),this.uh=V(this.ji,"history"),this.h$=(t=>V(this.ji,"navigation"))(),this.ont=new class{constructor(t,i,e,s){this.win=t,this.nu=i,this.$d=e,this.Qe=s,this.Qd=[]}Xd(s,r,o,h){o=o||Object.create(null),this.Zd(),st(s,"visibility","hidden");const u=function(t){const e=a(t),s=t.shadowRoot||t.__AMP_SHADOW_ROOT;if(s)return s.innerHTML="",s;let n;const r=St();if("v1"==r?(n=t.attachShadow({mode:"open"}),n.styleSheets||Object.defineProperty(n,"styleSheets",{get:function(){const t=[];return n.childNodes.forEach((i=>{"STYLE"===i.tagName&&t.push(i.sheet)})),t}})):n="v0"==r?t.createShadowRoot():function(t){const e=t.ownerDocument;t.classList.add("i-amphtml-shadow-host-polyfill");const s=e.createElement("style");s.textContent=".i-amphtml-shadow-host-polyfill>:not(i-amphtml-shadow-root){display:none!important}",t.appendChild(s);const n=e.createElement("i-amphtml-shadow-root");return t.appendChild(n),t.__AMP_SHADOW_ROOT=n,Object.defineProperty(t,"shadowRoot",{enumerable:!0,configurable:!0,value:n}),n.host=t,n.getElementById=function(t){const i=l(t);return n.querySelector(`#${i}`)},Object.defineProperty(n,"styleSheets",{get:()=>e.styleSheets?i(e.styleSheets).filter((t=>n.contains(t.ownerNode))):[]}),n}(t),!Tt()){const t=`i-amphtml-sd-${e.Math.floor(1e4*e.Math.random())}`;n.id=t,n.host.classList.add(t),o=t=>function(t,i){return function(t,i){const e=I(t.id),s=t.ownerDocument;let n=null;try{n=Jt(s.implementation.createHTMLDocument(""),i)}catch(t){}if(!n)try{n=Jt(s,i)}catch(t){}return n?Vt(n,`.${e}`,qt):i}(t,i)}(n,t),n.__AMP_CSS_TR=o}var o;return n}(s);u.AMP&&this.tf(u);const c={};u.AMP=c,c.url=r;const{origin:p}=Pt(r),f=this.nu.installShadowDoc(r,u,{params:o});c.ampdoc=f,Ct(f,t.combinedCss,null,!0),t.installAmpdocServices(f);const m=J(f);let d;return c.setVisibilityState=function(t){f.overrideVisibilityState(t)},c.postMessage=m.receiveMessage.bind(m),c.onMessage=function(t){d=t},m.setMessageDeliverer(((t,i,e)=>{var s;return"broadcast"==t?(this.if(i,u),e?M():void 0):null===(s=d)||void 0===s?void 0:s(t,i,e)}),p),c.close=()=>this.tf(u),c.getState=t=>q(u).then((i=>i?i.getState(t):Promise.reject("amp-bind is not available in this document"))),c.setState=t=>q(u).then((i=>{return i?"string"==typeof t?i.setStateWithExpression(t,{}):(s=t,"[object Object]"===n.call(s)||e(t)?i.setStateWithObject(t):Promise.reject("Invalid state")):Promise.reject("amp-bind is not available in this document");var s})),h(c,u,f).then((()=>{f.setReady(),f.signals().signal(Et),st(s,"visibility","visible")})),this.Qd.includes(u)||this.Qd.push(u),c}attachShadowDoc(t,i,e,s){return R().assertString(e),this.Xd(t,e,s,((e,s,n)=>{if(this.sf(n,s,i),i.body){const t=Ft(s,i.body,!0);t.classList.add("amp-shadow"),n.setBody(t)}return setTimeout((()=>{n.signals().signal(Et),st(t,"visibility","visible")}),50),M()}))}attachShadowDocAsStream(t,i,e){return R().assertString(i),this.Xd(t,i,e,((i,e,s)=>{let n=!1;const r=function(t){return void 0===Bt&&(Bt=function(t){return!(!t.document.implementation||"function"!=typeof t.document.implementation.createHTMLDocument||(i=t,S(i,"platform")).isFirefox());var i}(t)),Bt}(o=this.win)?new class{constructor(t){this.ef=t.document.implementation.createHTMLDocument(""),this.ef.open(),this.Xh=Y(t),this.nf=this.rf.bind(this),this.hf=null,this.uf=null,this.lf=null,this.cf=!1,this.af=M(),this.df=!1,this.ff=null}onBody(t){this.hf=t}onBodyChunk(t){this.uf=t}onEnd(t){this.lf=t}write(t){if(this.df)throw new Error("closed already");return t&&this.ef.write(t),this.Is(),this.af}close(){return this.ef.close(),this.df=!0,this.Is(),this.af}abort(t){throw new Error("Not implemented")}releaseLock(){throw new Error("Not implemented")}get closed(){throw new Error("Not implemented")}get desiredSize(){throw new Error("Not implemented")}get ready(){throw new Error("Not implemented")}Is(){h(this.hf&&this.uf&&this.lf),this.cf||(this.cf=!0,this.Xh.mutate(this.nf))}rf(){if(this.cf=!1,!this.ff&&this.ef.body&&(this.ff=this.hf(this.ef)),this.ff){const t=this.ef.body,i=h(this.ff);let e=0;for(Ut(t);t.firstChild;)e++,i.appendChild(t.firstChild);e>0&&this.uf()}this.df&&this.lf()}}(o):new class{constructor(t){this.pf=[],this.Xh=Y(t),this.hf=null,this.uf=null,this.lf=null,this.af=M(),this.df=!1}onBody(t){this.hf=t}onBodyChunk(t){this.uf=t}onEnd(t){this.lf=t}write(t){if(h(this.hf&&this.uf&&this.lf),this.df)throw new Error("closed already");return t&&this.pf.push(t),this.af}close(){return h(this.hf&&this.uf&&this.lf),this.df=!0,this.Xh.mutate((()=>this.oo())),this.af}abort(t){throw new Error("Not implemented")}releaseLock(){throw new Error("Not implemented")}get closed(){throw new Error("Not implemented")}get desiredSize(){throw new Error("Not implemented")}get ready(){throw new Error("Not implemented")}oo(){const t=this.pf.join(""),i=(new DOMParser).parseFromString(t,"text/html");if(i.body){const t=i.body,e=this.hf(i);let s=0;for(Ut(t);t.firstChild;)s++,e.appendChild(t.firstChild);s>0&&this.uf()}this.lf()}}(o);var o;return i.writer=r,r.onBody((t=>{this.sf(s,e,t);const i=Ft(e,t.body,!1);return i.classList.add("amp-shadow"),s.setBody(i),i})),r.onBodyChunk((()=>{n||(n=!0,setTimeout((()=>{s.signals().signal(Et),st(t,"visibility","visible")}),50))})),new Promise((t=>{r.onEnd((()=>{t(),i.writer=null}))}))}))}sf(t,i,e){if(e.head){i.AMP.head=e.head;const s={},n=d(this.win.document.head,"link");for(let t=0;t<n.length;t++){const i=n[t].getAttribute("href");i&&(s[i]=!0)}for(let n=e.head.firstElementChild;n;n=n.nextElementSibling){const{tagName:e}=n,r=n.getAttribute("name"),o=n.getAttribute("rel");switch(e){case"TITLE":i.AMP.title=n.textContent;break;case"META":n.hasAttribute("charset")||"viewport"==r||r&&t.setMetaByName(r,n.getAttribute("content")||"");break;case"LINK":const e=n.getAttribute("href");if("canonical"==o)i.AMP.canonicalUrl=e;else if("stylesheet"==o)if(s[e])Ct(t,`@import "${e}"`,null,!1);else{s[e]=!0;const t=this.win.document.createElement("link");t.setAttribute("rel","stylesheet"),t.setAttribute("type","text/css"),t.setAttribute("href",e),this.win.document.head.appendChild(t)}break;case"STYLE":n.hasAttribute("amp-boilerplate")||(n.hasAttribute("amp-custom")?Ct(t,n.textContent,null,!1,"amp-custom"):n.hasAttribute("amp-keyframes")&&Ct(t,n.textContent,null,!1,"amp-keyframes"));break;case"SCRIPT":if(n.hasAttribute("src")){const i=n.getAttribute("src"),e=b(i),s=n.getAttribute("custom-element"),r=n.getAttribute("custom-template"),o=s||r;e&&(o?this.$d.installExtensionForDoc(t,o,e.extensionVersion):n.hasAttribute("data-amp-report-test")||R().error(Yt,"- unknown script: ",n,i))}else-1==(n.getAttribute("type")||"application/javascript").indexOf("javascript")?i.appendChild(this.win.document.importNode(n,!0)):n.hasAttribute("amp-onerror")||R().error(Yt,"- unallowed inline javascript: ",n);break;case"NOSCRIPT":break;default:R().error(Yt,"- UNKNOWN head element:",n)}}}t.setExtensionsKnown()}if(t,i){this.Zd(),this.Qd.forEach((e=>{if(e==i)return;const s=J(e.AMP.ampdoc);this.Qe.delay((()=>{s.receiveMessage("broadcast",t,!1)}),0)}))}tf(t){this.mf(t);const i=t.AMP;delete t.AMP;const{ampdoc:e}=i;return e.overrideVisibilityState("inactive"),function(t){!function(t){const i=L(t);for(const t in i){if(!Object.prototype.hasOwnProperty.call(i,t))continue;const e=i[t];e.sharedInstance||(e.obj?U(t,e.obj):e.promise&&e.promise.then((i=>U(t,i))))}}(t)}(e),this.Qe.timeoutPromise(15,new this.win.Promise((t=>{O(e,"resources").then((i=>{i?i.onNextPass(t):t()}))})),"Timeout reached waiting for visibility state change callback").catch((t=>{}))}mf(t){const i=this.Qd.indexOf(t);-1!=i&&this.Qd.splice(i,1)}_f(t){this.Qe.delay((()=>{this.tf(t)}),0)}Zd(){this.Qd.forEach((t=>{t.host&&function(t){const i=t.isConnected;if(void 0!==i)return i;let e=t;for(;e=_(e),e.host;)e=e.host;return e.nodeType===Node.DOCUMENT_NODE}(t.host)||(this.mf(t),this._f(t))}))}}(this.i,S(this.i,"ampdoc"),(t=>S(t,"extensions"))(this.i),$(this.i,"timer")),this.dit=new class{constructor(t){this.ji=t,this.w_=[],this.F$=0,this.wz=-1,this.Eit=null,this.Tc=Z(t),this.Iit=0,this.Tit=!1,this.ja=W(t);const i=function(t,i,e){let s=0,n=null;function r(e){n=null,s=t.setTimeout(o,200),i.apply(null,e)}function o(){s=0,n&&r(n)}return function(...t){s?n=t:r(t)}}(t.win,this.Rz.bind(this));this.Tc.onScroll(i.bind(this)),this.Tc.onResize(i.bind(this)),this.Rz()}get mutator(){return this.ja}Rz(){this.Tit||(this.Tit=!0,this.ja.measureElement((()=>{this.Iit=this.Tc.getHeight();const t=this.Tc.getScrollTop(),i=t-this.F$;if(Math.abs(i)<20)return;const e=i>0?-1:1;this.w_.forEach((t=>{t.usesSentinel()&&this.Eit===e||this.updateRelativePos(t)})),this.F$=t,this.Eit=this.wz,this.wz=e})).then((()=>{this.Tit=!1})))}isScrollingUp(){return 1===this.wz}isScrollingDown(){return-1===this.wz}observe(t,i,e){const s=new ct(this,e);this.w_.push(s),s.observe(t,i)}observeHost(t,i){const e=new lt(this,i,t);this.w_.push(e)}getPositionObserver(){return ut(this.ji),(t=>V(this.ji.getHeadNode(),"position-observer"))()}updateRelativePos(t){const i=t.usesSentinel()?this.getRelativePosFromSentinel(t):this.getRelativePosFromScroll(t);i&&t.callback(I(i))}getRelativePosFromScroll(t){const{F$:i,Iit:e}=this,{top:s}=t.nextPageEl.getLayoutBox();return i<s-e?5:i<s&&s<=e&&i<=0?1:i<s?this.isScrollingDown()?3:4:2}getRelativePosFromSentinel(t){const{bottom:i,top:e}=t,{BOTTOM:s,INSIDE:n,TOP:r}=ot;return e||i?e===n&&i===n?1:e&&e!==r||i&&i!==s?(e&&e!==r||i!==r)&&(e!==s||i&&i!==s)?!(e!==r&&e!==n||i&&i!==s)==!!this.isScrollingUp()?3:4:2:5:null}}(this.ji),this.fi.then((()=>{this.dit.observeHost(this.Ait(),(t=>{this.vit.relativePos=t,this.updateVisibility()}))})),this.CR||(this.CR=[this.vit],this.setLastFetchedPage(this.vit));const r=()=>{this.lit(),this.Pi()};return this.Mit().then((()=>this.Sit())).then(r,r),this.Ait().classList.add("i-amphtml-next-page"),this.fi}Mit(){return new Promise((t=>{if(0!=this.Tc.getScrollTop())return t();const i=this.Tc.onScroll((()=>{t(),i()}))}))}Ait(){return this.mit}maybeFetchNext(t=!1){const i=this.CR.filter((t=>!t.is(1))).length>this.xit,e=this.CR.some((t=>t.is(2))),s=this.Vit()>3&&!t;if(this.pit||e||s||i)return M();const n=this.CR.length,r=this.CR[this.kit(this.git)+1];return r?r.fetch().then((()=>{r.is(4)&&this.setLastFetchedPage(r)})).then((()=>this.lit()),(t=>this.lit().then((()=>{throw t})))):this.Oit().then((t=>this.Nit(t))).then((()=>this.CR.length<=n?(this.pit=!0,this.lit()):this.maybeFetchNext(!0)))}updateVisibility(){this.CR.forEach(((t,i)=>{2===t.relativePos?t.isVisible()&&t.setVisibility(X):3!==t.relativePos&&(t.isVisible()||t.setVisibility(G),this.jit(i),this.$it(i))})),this.CR.some((t=>t.isVisible()))||this.vit.setVisibility(G),this.CR.filter((t=>t.isVisible())).forEach((t=>this.toggleHiddenAndReplaceableElements(I(t.document))));const t=function(t,i){for(let i=0;i<t.length;i++)if(t[i].isVisible())return i;return-1}(this.CR),i=this.CR[t]||null;i&&this.Pit!==i&&this.setTitlePage(i),this.maybeFetchNext()}jit(t,i){const e=void 0===i?5:i;this.dit.isScrollingDown()&&this.vit.isVisible()&&this.vit.setVisibility(X);const s=this.dit.isScrollingDown()?this.CR.slice(1,t).reverse():this.CR.slice(t+1);return Promise.all(s.filter((t=>2===t.relativePos)).map(((t,i)=>{if(t.isVisible()&&t.setVisibility(X),i>=e)return t.pause()})))}$it(t,i){const e=void 0===i?5:i,s=this.CR.slice(1).slice(Math.max(0,t-e-1),Math.min(this.CR.length,t+e+1)).filter((t=>t.is(6)));return Promise.all(s.map((t=>t.resume())))}setLastFetchedPage(t){this.git=t}setTitlePage(t=this.vit){if(!t)return;const{title:i,url:e}=t;this.yf.title=i,this.uh.replace({title:i,url:e}),this.Pit=t,rt(this.Ait(),"amp-next-page-scroll",{"title":i,"url":e},!1)}createHostPage(){const{location:t,title:i}=this.yf,{href:e}=t,s=function(t){const i=t.querySelector('script[type="application/ld+json"]');if(!i)return;const e=u(i.textContent);return e&&e.image?"string"==typeof e.image?e.image:e.image["@list"]&&"string"==typeof e.image["@list"][0]?e.image["@list"][0]:"string"==typeof e.image.url?e.image.url:"string"==typeof e.image[0]?e.image[0]:void 0:void 0}(this.yf)||function(t){const i=t.querySelector('meta[property="og:image"]');return i?i.getAttribute("content"):void 0}(this.yf)||function(t){const i=t.querySelector('link[rel="shortcut icon"]')||t.querySelector('link[rel="icon"]');return i?i.getAttribute("href"):void 0}(this.yf)||"";return new mt(this,{url:e,title:i||"",image:s},5,G,this.yf)}createDocumentContainerForPage(t){const i=this.yf.createElement("div");i.classList.add("i-amphtml-next-page-document-container"),this.mit.insertBefore(i,this.cit);const e=this.yf.createElement("div");return e.classList.add(Xt),i.appendChild(e),this.dit.observe(e,i,(i=>{t.relativePos=i,this.updateVisibility()})),i}Cit(){return this.br.hasCapability("cid")?"cid":null}attachDocumentToPage(t,i,e=!1){if(this.Vit()<1&&!e)return Promise.resolve(null);const s=t.container;let n=f(s,`> .${l(Xt)}`);if(!n){I(t.is(6));const i=f(s,`> .${l(ti)}`);n=this.yf.createElement("div"),n.classList.add(Xt),s.replaceChild(n,i)}this.sanitizeDoc(i);try{const e=this.ont.attachShadowDoc(n,i,t.url,{visibilityState:Q,cap:this.Cit()}),r=this.br.maybeGetMessageDeliverer();r&&e.onMessage(((t,i,e)=>{if("documentHeight"!==t&&"scroll"!==t&&"viewport"!==t)return r(t,i,e)}));const o=I(e.ampdoc);Ct(o,wt,null,!1,Gt),o.getBody().classList.add("i-amphtml-next-page-document");const h=this.snt.cloneNode(!0);return P(s,h),this.Lit(h,t).then((()=>e))}catch(t){return E().error(Gt,"failed to attach shadow document for page",t),Promise.resolve(null)}}closeDocument(t){if(t.is(6))return M();const i=t.container,e=f(i,`> .${l(Xt)}`),s=this.yf.createElement("div");s.classList.add(ti);let n=0,r=0;return this.ja.measureMutateElement(e,(()=>{n=e.offsetHeight,r=e.offsetWidth}),(()=>{!function(t,i){for(const e in i)st(t,e,i[e])}(s,{"height":`${n}px`,"width":`${r}px`}),i.replaceChild(s,e)}))}sanitizeDoc(t){i(t.querySelectorAll("amp-next-page")).forEach((t=>{if(this.bit){const i=this.Dit(t);this.Uit(i)}g(t)})),t.body.classList.add(pt),this.toggleHiddenAndReplaceableElements(t,!1)}toggleHiddenAndReplaceableElements(t,e=!0){t!==this.vit.document&&i(t.querySelectorAll("[next-page-hide]")).forEach((t=>nt(t,!1))),e&&i(t.querySelectorAll("*:not(amp-next-page) [next-page-replace]")).forEach((t=>{let i=t.getAttribute("next-page-replace");i||(i=String(Date.now()+Math.floor(100*Math.random())),t.setAttribute("next-page-replace",i)),this._it[i]&&this._it[i]!==t&&nt(this._it[i],!1),this._it[i]=t,nt(t,!0)}))}Vit(){return Math.round((this.Tc.getScrollHeight()-this.Tc.getScrollTop()-this.Tc.getHeight())/this.Tc.getHeight())}kit(t){return this.CR.indexOf(t)}fetchPageDocument(t){return K(this.i).fetch(t.url,{ampCors:!1}).then((i=>(xt(i.url,this.ji.getUrl()),t.url=i.url,i.text()))).then((t=>{const i=this.yf.implementation.createHTMLDocument("");return i.open(),i.write(t),i.close(),i})).catch((i=>{throw R().error(Gt,"failed to fetch %s",t.url,i),i}))}Sit(){const t=this.Dit(this.Ait());return t.length?this.Uit(t):(T(this.wit,"%s should contain a <script> child or a URL specified in [src]",Gt),this.Oit().then((t=>0===t.length?M():this.Uit(t))))}Nit(t){return!t.length||this.pit||t.forEach((t=>{try{if(function(t,i){R().assertString(t.url,"page url must be a string");const e=_t(i),{origin:s}=Pt(i);var n,r;t.url=(n=t.url,r=vt(r=e),new URL(n,r.href).toString());const o=xt(t.url,i);R().assertString(t.image,"page image must be a string"),R().assertString(t.title,"page title must be a string");const h=bt(i);h!==s&&o.origin===h&&(t.url=`${s}/c/`+("https:"===o.protocol?"s/":"")+encodeURIComponent(o.host)+o.pathname+(o.search||"")+(o.hash||""))}(t,this.ji.getUrl()),this.CR.some((i=>i.initialUrl==t.url)))return;this.CR.push(new ft(this,t))}catch(t){R().error(Gt,"Failed to queue page due to error:",t)}})),M()}Uit(t){return this.Nit(t).then((()=>this.maybeFetchNext()))}Dit(t){const i=d(t,"SCRIPT");if(!i.length)return[];T(1===i.length,`${Gt} should contain at most one <script> child`);const e=i[0];T(function(t){var i;return"SCRIPT"==t.tagName&&"APPLICATION/JSON"==(null===(i=t.getAttribute("type"))||void 0===i?void 0:i.toUpperCase())}(e),`${Gt} page list should be inside a <script> tag with type="application/json"`);const s=u(e.textContent,(t=>{R().error(Gt,"failed to parse inline page list",t)})),n=R().assertArray(s,`${Gt} Page list expected an array, found: ${typeof s}`);return g(e),n}Oit(){return this.wit?(this.fit||(this.fit=function(t,i,e={}){const{expr:s=".",urlReplacement:n=At.NONE,refresh:r=!1,xssiPrefix:h,url:u=i.getAttribute("src")}=e;!function(t,i,e="source"){var s;T(null!=t,"%s %s must be available",i,e),T("https:"==(s=vt(s=t)).protocol||"localhost"==s.hostname||"127.0.0.1"==s.hostname||function(t,i){const e=t.length-i.length;return e>=0&&t.indexOf(i,e)==e}(s.hostname,".localhost")||/^\/\//.test(t),'%s %s must start with "https://" or "//" or be relative and served from either https or from localhost. Invalid value: %s',i,e,t)}(u,i);const a=S(t.win,"batched-xhr");return function(t,i,e,s){const n=(t=>k(t,"url-replace"))(t);return(e>=At.OPT_IN?n.expandUrlAsync(i):Promise.resolve(i)).then((i=>{if(e===At.OPT_IN){const i=n.collectDisallowedVarsSync(t);if(i.length>0)throw R().createError(`URL variable substitutions in CORS fetches from dynamic URLs (e.g. via amp-bind) require opt-in. Please add data-amp-replace="${i.join(" ")}" to the <${t.tagName}> element. See https://bit.ly/amp-var-subs.`)}const r={};return t.hasAttribute("credentials")&&(r.credentials=t.getAttribute("credentials")),s&&(r.cache="reload"),{"xhrUrl":i,"fetchOpt":r}}))}(i,u,n,r).then((t=>a.fetchJson(t.xhrUrl,t.fetchOpt))).then((i=>K(t.win).xssiJson(i,h))).then((t=>{if(null==t)throw new Error("Response is undefined.");return function(t,i){if("."==i)return t;const e=i.split(".");let s=t;for(const t of e){if(!(t&&s&&void 0!==s[t]&&"object"==typeof s&&o(s,t))){s=void 0;break}s=s[t]}return s}(t,s||".")})).catch((t=>{throw R().createError("failed fetching JSON data",t)}))}(this.ji,this.Ait(),{urlReplacement:At.ALL,xssiPrefix:this.Ait().getAttribute("xssi-prefix")||void 0}).then((t=>(this.wit=t.next||null,this.wit&&this.Ait().setAttribute("src",this.wit),t.pages||[]))).catch((t=>(R().error(Gt,"error fetching page list from remote server",t),this.wit=null,[])))),this.fit):Promise.resolve([])}Rit(t){const i=m(t,"separator");return i?(g(i),i.hasAttribute("tabindex")||i.setAttribute("tabindex","0"),i):this.Bit()}Bit(){return tt(this.Ait())(Zt)}Lit(t,i){if(!this.tM.hasTemplate(t))return M();const e={title:i.title,url:i.url,image:i.image};return this.tM.findAndRenderTemplate(t,e).then((i=>this.ja.mutateElement(t,(()=>{v(t),t.appendChild(i)}))))}yit(t){const i=m(t,"recommendation-box");return i?(this.lit=this.tM.hasTemplate(i)?()=>this.Hit():ii,i):(this.lit=()=>this.zit(),this.Fit())}Fit(){return tt(this.Ait())(Kt)}Hit(){const t=this.cit;I(this.tM.hasTemplate(t));const i=this.tM.maybeFindTemplate(t),e={pages:(this.CR||[]).filter((t=>!t.isLoaded()&&!t.is(2))).map((t=>({title:t.title,url:t.url,image:t.image})))};return this.tM.findAndRenderTemplate(t,e).then((e=>this.ja.mutateElement(t,(()=>{v(t),t.appendChild(i),t.appendChild(e)}))))}zit(){const t=this.cit,i={pages:(this.CR||[]).filter((t=>!t.isLoaded()&&!t.is(2))).map((t=>({title:t.title,url:t.url,image:t.image})))},e=tt(this.Ait()),s=i.pages.map((t=>{const i=e(Qt),{image:s,title:n}=function(t){const i=t.querySelectorAll("[ref]"),e=r();for(let t=0;t<i.length;t++){const s=i[t],n=s.getAttribute("ref");h(n),s.removeAttribute("ref"),h(void 0===e[n]),e[n]=s}return e}(i);return s.src=t.image,n.textContent=t.title,i.href=t.url,i.addEventListener("click",(i=>{rt(this.Ait(),"amp-next-page-click",{"title":t.title,"url":t.url},!1),this.h$.navigateToAmpUrl(t.url,"content-discovery")&&i.preventDefault()})),i}));return this.ja.mutateElement(t,(()=>{v(t),s.forEach((i=>t.appendChild(i)))}))}}),t.registerElement("amp-next-page",ei,wt)})();
/*! https://mths.be/cssescape v1.5.1 by @mathias | MIT license */
/**
* @license
* Copyright (c) 2014 The Polymer Project Authors. All rights reserved.
* Use of this source code is governed by a BSD-style
* license that can be found in the LICENSE file or at
* https://developers.google.com/open-source/licenses/bsd
*/}});
//# sourceMappingURL=amp-next-page-1.0.mjs.map