;
(self.AMP=self.AMP||[]).push({m:1,v:"2301041800000",n:"amp-connatix-player",ev:"0.1",l:!0,f:function(t,n){(()=>{function n(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}function e(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),e.push.apply(e,i)}return e}var i={SUFFICIENT:1,INSUFFICIENT:2,UNKNOWN_NOT_REQUIRED:3,UNKNOWN:4},r={TCF_V1:1,TCF_V2:2,US_PRIVACY_STRING:3},o=class{constructor(){this.promise=new Promise(((t,n)=>{this.resolve=t,this.reject=n}))}},{isArray:s}=Array,{hasOwnProperty:c,toString:u}=Object.prototype;function l(t){return(t.ownerDocument||t).defaultView}function a(t){const n=Object.getOwnPropertyDescriptor(t,"message");if(null!=n&&n.writable)return t;const{message:e,stack:i}=t,r=new Error(e);for(const n in t)r[n]=t[n];return r.stack=i,r}function f(t){let n=null,e="";for(const t of arguments)t instanceof Error&&!n?n=a(t):(e&&(e+=" "),e+=t);return n?e&&(n.message=e+": "+n.message):n=new Error(e),n}function h(t){var n,e;null===(n=(e=self).__AMP_REPORT_ERROR)||void 0===n||n.call(e,t)}function d(t,...n){try{return t.apply(null,n)}catch(t){!function(t){const n=f.apply(null,arguments);setTimeout((()=>{throw h(n),n}))}(t)}}var m={"getPropertyPriority":()=>"","getPropertyValue":()=>""},p=/vertical/,v=new WeakMap,b=new WeakMap,y=new WeakMap;function P(t,n,e){const i=t.ownerDocument.defaultView;if(!i)return;let r=b.get(t);if(r||(r=[],b.set(t,r),_(i).observe(t)),!r.some((t=>t.callback===e&&t.type===n))){r.push({type:n,callback:e});const i=y.get(t);i&&setTimeout((()=>g(n,e,i)))}}function w(t,n,e){const i=b.get(t);if(i&&(function(t,i){const r=[];let o=0;for(let i=0;i<t.length;i++){const c=t[i];(s=c).callback===e&&s.type===n?r.push(c):(o<i&&(t[o]=c),o++)}var s;o<t.length&&(t.length=o)}(i),0==i.length)){b.delete(t),y.delete(t);const n=t.ownerDocument.defaultView;n&&_(n).unobserve(t)}}function _(t){let n=v.get(t);return n||(n=new t.ResizeObserver(S),v.set(t,n)),n}function S(t){const n=new Set;for(let e=t.length-1;e>=0;e--){const i=t[e],{target:r}=i;if(n.has(r))continue;n.add(r);const o=b.get(r);if(o){y.set(r,i);for(let t=0;t<o.length;t++){const{callback:n,type:e}=o[t];g(e,n,i)}}}}function g(t,n,e){if(0==t){const{contentRect:t}=e,{height:i,width:r}=t;d(n,{width:r,height:i})}else if(1==t){const{borderBoxSize:t}=e;let i;if(t)i=t.length>0?t[0]:{inlineSize:0,blockSize:0};else{const{target:t}=e,n=l(t),r=p.test(function(t,n){return t.getComputedStyle(n)||m}(n,t).writingMode),{offsetHeight:o,offsetWidth:s}=t;let c,u;r?(u=s,c=o):(c=s,u=o),i={inlineSize:c,blockSize:u}}d(n,i)}}self.__AMP_LOG=self.__AMP_LOG||{user:null,dev:null,userForEmbed:null};var I=self.__AMP_LOG;function O(t){return function(t,n){throw new Error("failed to call initLogConstructor")}()}function C(t,n,e,i,r,o,s,c,u,l,a){return t}function T(t,n){return R(t=function(t){return t.__AMP_TOP||(t.__AMP_TOP=t)}(t),n)}function j(t,n){return k(A(t),n)}function E(t){return t.nodeType?(n=l(t),T(n,"ampdoc")).getAmpDoc(t):t;var n}function A(t){const n=E(t);return n.isSingleDoc()?n.win:n}function R(t,n){C(function(t,n){const e=t.__AMP_SERVICES&&t.__AMP_SERVICES[n];return!(!e||!e.ctor)}(t,n));const e=x(t)[n];return e.obj||(C(e.ctor),C(e.context),e.obj=new e.ctor(e.context),C(e.obj),e.context=null,e.resolve&&e.resolve(e.obj)),e.obj}function k(t,n){const e=x(t)[n];return e?e.promise?e.promise:(R(t,n),e.promise=Promise.resolve(e.obj)):null}function x(t){let n=t.__AMP_SERVICES;return n||(n=t.__AMP_SERVICES={}),n}var N=t=>function(t,n,e,i){const r=j(t,n);if(r)return r;const s=E(t);return s.whenExtensionsKnown().then((()=>{const t=s.getExtensionVersion(e);return t?T(s.win,"extensions").waitForExtension(e,t):null})).then((e=>e?function(t,n){return function(t,n){const e=k(t,n);if(e)return e;const i=x(t);return i[n]=function(){const t=new o,{promise:n,reject:e,resolve:i}=t;return n.catch((()=>{})),{obj:null,promise:n,resolve:i,reject:e,context:null,ctor:null}}(),i[n].promise}(A(t),n)}(t,n):null))}(t,"consentPolicyManager","amp-consent");new Set(["c","v","a","ad"]);var M=class extends t.BaseElement{constructor(t){super(t),this.mb="",this.pb="",this.vb=null,this.Lv=null,this.bb=null,this.yb=null,this.Pb=this.Pb.bind(this),this.bn=new class{constructor(t){this._n=t,this.gn=!1,this.Pn=!1,this.An=this.An.bind(this)}updatePlaying(t){t!==this.gn&&(this.gn=t,t?(this.Pn=!1,P(this._n,1,this.An)):function(t,n){w(t,1,n)}(this._n,this.An))}An({blockSize:t,inlineSize:n}){const e=n>0&&t>0;if(e===this.Pn)return;this.Pn=e;const i=this._n;e||i.pause()}}(this.element)}wb(t,n){this.bb&&this.bb.then((e=>{e&&e.contentWindow&&e.contentWindow.postMessage(JSON.stringify({"event":"command","func":t,"args":n||""}),this.vb)}))}_b(){this.win.addEventListener("message",(t=>{if(!this.Lv||t.source!==this.Lv.contentWindow)return;const n=function(t,n){try{return function(t){return JSON.parse(t)}(t)}catch(t){return null}}(t.data);if(n&&"command"===n.event)switch(n.func){case"cnxClose":this.Sb(),this.attemptCollapse();break;case"cnxPlayerRendered":this.yb(this.Lv)}}))}gb(){const t=super.getConsentPolicy()||"default",n=function(t,n="default"){return N(t).then((t=>t?t.whenPolicyResolved(n):null))}(this.element,t),e=function(t,n="default"){return N(t).then((t=>t?t.getConsentStringInfo(n):null))}(this.element,t),o=(s=this.element,c=t,N(s).then((t=>t?t.getMergedSharedData(c):null)));var s,c;const u=function(t,n="default"){return N(t).then((t=>t?t.getConsentMetadataInfo(n):null))}(this.element,t);(function(t){function n(t){return{status:"fulfilled",value:t}}function e(t){return{status:"rejected",reason:t}}return Promise.all(t.map((t=>t.then(n,e))))})([n,e,o,u]).then((t=>{if(t&&4===t.length){const n=t[0],e=t[1],o=t[2],s=t[3],c={"consentPolicyStateEnum":i,"consentStringTypeEnum":r,"consentPolicyState":{"error":n.reason,"value":n.value},"rawConsentString":{"error":e.reason,"value":e.value},"consentSharedData":{"error":o.reason,"value":o.value},"consentMetadata":{"error":s.reason,"value":s.value}};this.wb("ampConsentInfo",c)}}))}Sb(){var t,n;this.Lv&&(null===(n=(t=this.Lv).parentElement)||void 0===n||n.removeChild(t),this.Lv=null)}buildCallback(){const{element:t}=this;var n,e;!function(t){t.classList.add("i-amphtml-media-component")}(t),this.mb=(n=t.getAttribute("data-player-id"),"The data-player-id attribute is required for <amp-connatix-player> %s",e=t,(I.user||(I.user=O()),void I.user.win?I.userForEmbed||(I.userForEmbed=O()):I.user).assert(n,"The data-player-id attribute is required for <amp-connatix-player> %s",e,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined)),this.pb=t.getAttribute("data-media-id")||"";const i=t.getAttribute("data-elements-player")||!1;this.vb=i?"https://cdm.elements.video":"https://amp.cntxcdm.com";const r=new o;this.bb=r.promise,this.yb=r.resolve}preconnectCallback(t){var n;(n=this.win,T(n,"preconnect")).url(this.getAmpDoc(),this.vb,t)}layoutCallback(){const{element:t}=this,i=function(t){for(var i=1;i<arguments.length;i++){var r=null!=arguments[i]?arguments[i]:{};i%2?e(Object(r),!0).forEach((function(e){n(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):e(Object(r)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))}))}return t}({"playerId":this.mb||void 0,"mediaId":this.pb||void 0,"url":(c=t,function(t,n){return R(A(E(t)),"documentInfo")}(c).get()).sourceUrl},function(t,n,e){const{dataset:i}=t,r={},o=/^param(.+)/;for(const t in i){const n=t.match(o);n&&(r[n[1][0].toLowerCase()+n[1].substr(1)]=i[t])}return r}(t)),r=function(t,n,e){if(!n)return t;const i=t.split("#",2),r=i[0].split("?",2);let o=r[0]+(r[1]?`?${r[1]}&${n}`:`?${n}`);return o+=i[1]?`#${i[1]}`:"",o}(this.vb+"/amp-embed/index.html",function(t){const n=[];for(const o in t){let c=t[o];if(null!=c){c=s(r=c)?r:[r];for(let t=0;t<c.length;t++)n.push((e=o,i=c[t],`${encodeURIComponent(e)}=${encodeURIComponent(i)}`))}}var e,i,r;return n.join("&")}(i)),o=t.ownerDocument.createElement("iframe");var c;return o.setAttribute("frameborder","0"),o.setAttribute("allowfullscreen","true"),o.src=r,function(t,n){t.classList.add("i-amphtml-fill-content"),t.classList.add("i-amphtml-replaced-content")}(o),t.appendChild(o),this.Lv=o,this._b(),this.gb(),function(t,n){P(t,0,n)}(this.element,this.Pb),this.bn.updatePlaying(!0),this.loadPromise(o).then((()=>this.bb))}isLayoutSupported(t){return function(t){return"fixed"==t||"fixed-height"==t||"responsive"==t||"fill"==t||"flex-item"==t||"fluid"==t||"intrinsic"==t}(t)}Pb({height:t,width:n}){this.Lv&&this.wb("ampResize",{"width":n,"height":t})}pauseCallback(){this.Lv&&(this.wb("ampPause"),this.Lv.src=this.Lv.src)}unlayoutCallback(){this.Sb();const t=new o;return this.bb=t.promise,this.yb=t.resolve,w(this.element,0,this.Pb),this.bn.updatePlaying(!1),!0}};t.registerElement("amp-connatix-player",M)})();
/*! https://mths.be/cssescape v1.5.1 by @mathias | MIT license */}});
//# sourceMappingURL=amp-connatix-player-0.1.mjs.map