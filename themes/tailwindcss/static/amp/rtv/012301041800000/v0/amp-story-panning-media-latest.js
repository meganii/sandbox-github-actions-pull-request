;
(self.AMP=self.AMP||[]).push({m:0,v:"2301041800000",n:"amp-story-panning-media",ev:"0.1",l:!0,f:function(t,n){!function(){function n(t,n,r){return n in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function r(t,n){return(r=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}function i(t){return(i=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,n){if(n&&("object"===e(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}var u=Array.isArray,a=Object.prototype;function f(t,n,r,i,e,o,u,a,f,s,c){return t}a.hasOwnProperty,a.toString;var s,c=function(){var t=this;this.promise=new Promise((function(n,r){t.resolve=n,t.reject=r}))},l=["Webkit","webkit","Moz","moz","ms","O","o"];function h(t){var n=t.replace(/[A-Z]/g,(function(t){return"-"+t.toLowerCase()}));return l.some((function(t){return n.startsWith(t+"-")}))?"-".concat(n):n}function m(t,n,r){if(n.startsWith("--"))return n;var i;s||(i=Object.create(null),s=i);var e=s[n];if(!e||r){if(e=n,void 0===t[n]){var o=function(t){return t.charAt(0).toUpperCase()+t.slice(1)}(n),u=function(t,n){for(var r=0;r<l.length;r++){var i=l[r]+n;if(void 0!==t[i])return i}return""}(t,o);void 0!==t[u]&&(e=u)}r||(s[n]=e)}return e}function v(t,n){var r=t.style;for(var i in n)r.setProperty(h(m(r,i)),String(n[i]),"important")}function p(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5;if(!isFinite(r)||r<0)throw new Error("Invalid depth: "+r);if(t===n)return!0;for(var i=[{a:t,b:n,depth:r}];i.length>0;){var o=i.shift(),a=o.a,f=o.b,s=o.depth;if(s>0){if(e(a)!==e(f))return!1;if(u(a)&&u(f)){if(a.length!==f.length)return!1;for(var c=0;c<a.length;c++)i.push({a:a[c],b:f[c],depth:s-1});continue}if(a&&f&&"object"===e(a)&&"object"===e(f)){var l=Object.keys(a),h=Object.keys(f);if(l.length!==h.length)return!1;for(var m=0,v=l;m<v.length;m++){var p=v[m];i.push({a:a[p],b:f[p],depth:s-1})}continue}}if(a!==f)return!1}return!0}function d(t){if(!t)return null;var n=t.match(/^(.*)\/(.*)-([0-9.]+|latest)(\.max)?\.(?:js|mjs)(?:\?ssr-css=[0|1])?$/i),r=n?n[2]:void 0,i=n?n[3]:void 0;return r&&i?{extensionId:r,extensionVersion:i}:null}self.__AMP_LOG=self.__AMP_LOG||{user:null,dev:null,userForEmbed:null};var b=self.__AMP_LOG;function y(t){return b.user||(b.user=g()),function(t,n){return n&&n.ownerDocument.defaultView!=t}(b.user.win,t)?b.userForEmbed||(b.userForEmbed=g()):b.user}function g(t){return function(t,n){throw new Error("failed to call initLogConstructor")}()}function w(t,n,r,i,e,o,u,a,f,s,c){return t}function x(t,n){return O(t,n)}function j(t,n){w(function(t,n){var r=t.__AMP_SERVICES&&t.__AMP_SERVICES[n];return!(!r||!r.ctor)}(t,n));var r=A(t)[n];return r.obj||(w(r.ctor),w(r.context),r.obj=new r.ctor(r.context),w(r.obj),r.context=null,r.resolve&&r.resolve(r.obj)),r.obj}function O(t,n){var r=A(t)[n];return r?r.promise?r.promise:(j(t,n),r.promise=Promise.resolve(r.obj)):null}function A(t){var n=t.__AMP_SERVICES;return n||(n=t.__AMP_SERVICES={}),n}var M,P=(n(M={},33,(function(t,n){return t.length!==n.length})),n(M,15,(function(t,n){return t.element!==n.element||t.state!==n.state})),n(M,38,(function(t,n){return t.length!==n.length})),n(M,40,(function(t,n){return t.length!==n.length})),n(M,41,(function(t,n){return null===t||null===n||t.width!==n.width||t.height!==n.height})),n(M,23,(function(t,n){return null===t||null===n||!p(t,n,2)})),n(M,28,(function(t,n){return null===t||null===n||!p(t,n,2)})),n(M,16,(function(t,n){return!p(t,n,3)})),"AMP_STORY_PANNING_MEDIA"),F=function(t){!function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&r(t,n)}(s,t);var e,u,a=(e=s,u=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=i(e);if(u){var r=i(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return o(this,t)});function s(t){var n;return(n=a.call(this,t)).fet=null,n.let={},n.het=null,n.met={},n.eA=null,n.d3=null,n.y3=!1,n.vet=null,n.pet=null,n}var l=s.prototype;return l.buildCallback=function(){var t,n=this;return(t=this.win,function(t,n,r,i,e){return x(t,n)||function(t,n,r,i,e){return(o=t.document,new Promise((function(t){return function(t,n){!function(t,n,r){if(n())r();else{var i=((u=t).ownerDocument||u).defaultView;if(i.MutationObserver){var e=new i.MutationObserver((function(){n()&&(e.disconnect(),r())}));e.observe(t,{childList:!0})}else var o=i.setInterval((function(){n()&&(i.clearInterval(o),r())}),5)}var u}(t.documentElement,(function(){return!!t.body}),n)}(o,t)}))).then((function(){var n=function(t,n){return j(t=function(t){return t.__AMP_TOP||(t.__AMP_TOP=t)}(t),"extensions")}(t);return function(t,n,r){return function(t){if(!t)return[];for(var n=t.querySelectorAll("script[custom-element],script[custom-template]"),r=[],i=0;i<n.length;i++){var e=n[i],o=e.getAttribute("custom-element")||e.getAttribute("custom-template"),u=d(e.src);o&&u&&r.push({script:e,extensionId:o,extensionVersion:u.extensionVersion})}return r}(t.document.head).some((function(t){var i=t.extensionId,e=t.extensionVersion;return n==i&&r==e}))}(n.win,r,i)?n.waitForExtension(r,i):null})).then((function(r){return r?e?x(t,n):function(t,n){return function(t,n){var r=O(t,n);if(r)return r;var i,e,o,u,a=A(t);return a[n]=(e=(i=new c).promise,o=i.reject,u=i.resolve,e.catch((function(){})),{obj:null,promise:e,resolve:u,reject:o,context:null,ctor:null}),a[n].promise}(t,n)}(t,n):null}));var o}(t,n,r,i,e)}(t,"story-store","amp-story","1.0")).then((function(t){return n.eA=t}))},l.layoutCallback=function(){var t=this;return this.fet=this.element.querySelector("amp-img"),this.pet=this.element.getAttribute("group-id")||this.fet.getAttribute("src"),this.uA(),function(t){if(f(function(t){var n=t.tagName;return n.startsWith("AMP-")&&!("AMP-STICKY-AD-TOP-PADDING"==n||"AMP-BODY"==n)}(t)),t.createdCallback)return Promise.resolve(t);if(!t.__AMP_UPG_PRM){var n=new c;t.__AMP_UPG_PRM=n.promise,t.__AMP_UPG_RES=n.resolve}var r=t.__AMP_UPG_PRM;return f(r),r}(this.fet).then((function(){return t.fet.signals().whenSignal("load-end")})).then((function(){t.element.querySelector("img").classList="",t.det()})).catch((function(){return y().error(P,"Failed to load the amp-img.")}))},l.uA=function(){var t=this;this.eA.subscribe(41,(function(){t.het={width:t.element.offsetWidth,height:t.element.offsetHeight},t.det(),t.bet(),t.V3()}),!0),this.eA.subscribe(35,(function(n){t.y3=n===t.q3(),t.V3()}),!0),this.eA.subscribe(23,(function(n){return t.yet(n)}),!0);var n=new MutationObserver((function(n){return t.vet=parseInt(n[0].target.getAttribute("distance"),10)}));this.F3()&&n.observe(this.F3(),{attributes:!0,attributeFilter:["distance"]})},l.bet=function(){var t=parseFloat(this.element.getAttribute("data-x")||0),n=parseFloat(this.element.getAttribute("data-y")||0),r=parseFloat(this.element.getAttribute("data-zoom")||1);if(this.element.hasAttribute("lock-bounds")){this.let.zoom=r<1?1:r;var i=this.wet(),e=i.horizontal,o=i.vertical;this.let.x=Math.max(-e,Math.min(t,e)),this.let.y=Math.max(-o,Math.min(n,o))}else this.let={x:t,y:n,zoom:r}},l.wet=function(){var t=this.het,n=t.height,r=t.width,i=this.fet.getAttribute("width"),e=this.fet.getAttribute("height");i&&e||y().error(P,'"lock-bounds" requires "width" and "height" to be set on the amp-img child.');var o=r/n<i/e?n/e:r/i,u=o*e;return{horizontal:50*(1-r/(o*i*this.let.zoom)),vertical:50*(1-n/(u*this.let.zoom))}},l.V3=function(){var t=this;if(this.y3){var r,i,e=this.eA.get(23)[this.pet];!e||null!==(r=this.win.matchMedia("(prefers-reduced-motion: reduce)"))&&void 0!==r&&r.matches?this.eA.dispatch(3,n({},this.pet,this.let)):requestAnimationFrame((function r(o){i||(i=o);var u,a=o-i;if(a<1e3){var f=t.let,s=f.x,c=f.y,l=f.zoom,h=(u=a/1e3)<.5?2*u*u:1-Math.pow(-2*u+2,2)/2;t.eA.dispatch(3,n({},t.pet,{x:e.x+(s-e.x)*h,y:e.y+(c-e.y)*h,zoom:e.zoom+(l-e.zoom)*h})),t.y3&&requestAnimationFrame(r)}else t.eA.dispatch(3,n({},t.pet,t.let))}))}},l.det=function(){var t=this,n=this.element.querySelector("img");if(n){var r=this.het,i=r.height,e=r.width/i,o=this.fet.getAttribute("width")/this.fet.getAttribute("height");this.mutateElement((function(){e<o?(v(t.fet,{left:"auto",right:"auto",top:"0",bottom:"0",width:"auto",height:"100%"}),v(n,{width:"auto",height:"100%"})):(v(t.fet,{left:"0",right:"0",top:"auto",bottom:"auto",width:"100%",height:"auto"}),v(n,{width:"100%",height:"auto"}))}))}},l.yet=function(t){this.vet<=1&&t[this.pet]&&!p(this.met,t[this.pet])&&(this.met=t[this.pet],this.xet())},l.xet=function(){var t=this,n=this.met,r=n.x,i=n.y,e=n.zoom;return this.mutateElement((function(){v(t.fet,{transform:"translate3d(".concat(r,"%, ").concat(i,"%, ").concat(t.jet(e),"px)")})}))},l.jet=function(t){var n=(t-1)/t;return isFinite(n)?n:-1e5},l.q3=function(){return null==this.d3&&(this.d3=this.F3().getAttribute("id")),this.d3},l.F3=function(){return function(t,n,r){var i;for(i=t;i&&void 0!==i;i=i.parentElement)if(n(i))return i;return null}(this.element,(function(t){return"amp-story-page"===t.tagName.toLowerCase()}))},l.isLayoutSupported=function(t){return"fill"==t},s}(t.BaseElement);t.registerElement("amp-story-panning-media",F,"amp-story-panning-media{display:-ms-flexbox!important;display:flex!important;-ms-flex-pack:center!important;justify-content:center!important;-ms-flex-align:center!important;align-items:center!important;perspective:1px!important}amp-story-panning-media amp-img{-webkit-backface-visibility:hidden!important;backface-visibility:hidden!important}amp-story-grid-layer[template=fill] amp-story-panning-media amp-img img{position:relative!important;display:inline-block!important}\n/*# sourceURL=/extensions/amp-story-panning-media/0.1/amp-story-panning-media.css*/")}();
/*! https://mths.be/cssescape v1.5.1 by @mathias | MIT license */}});
//# sourceMappingURL=amp-story-panning-media-0.1.js.map