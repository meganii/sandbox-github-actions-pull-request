;
import{PreactBaseElement as e}from"../bento.mjs";function t(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function o(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function n(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?o(Object(r),!0).forEach((function(o){t(e,o,r[o])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function r(e,t){if(null==e)return{};var o,n,r={},a=Object.keys(e);for(n=0;n<a.length;n++)o=a[n],t.indexOf(o)>=0||(r[o]=e[o]);return r}import{createElement as a}from"../bento.mjs";import{useCallback as l,useEffect as s,useRef as c}from"../bento.mjs";import{useValueRef as i}from"../bento.mjs";import{createElement as u}from"../bento.mjs";import{useCallback as d,useEffect as m,useImperativeHandle as f,useLayoutEffect as b,useRef as p}from"../bento.mjs";import{forwardRef as g}from"../bento.mjs";import{ContainWrapper as j,useValueRef as y}from"../bento.mjs";import{useAmpContext as v,useLoading as O}from"../bento.mjs";var h=["allow","allowFullScreen","iframeStyle","name","title","matchesMessagingOrigin","messageHandler","ready","loading","onReadyState","sandbox","src"],w=()=>!1,k=g((function(e,t){let{allow:o,allowFullScreen:a,iframeStyle:l,name:s,title:c,matchesMessagingOrigin:i=w,messageHandler:g,ready:k=!0,loading:S,onReadyState:I,sandbox:R,src:E}=e,x=r(e,h);const{playable:C}=v(),F=O(S),H="unload"!==F,L=p(!1),M=y(I),N=d((e=>{if(e!==L.current){L.current=e;const t=M.current;null==t||t(e?"complete":"loading")}}),[M]),T=p(null);return f(t,(()=>({get readyState(){return L.current?"complete":"loading"},get node(){return T.current}})),[]),b((()=>{H||N(!1)}),[H,N]),m((()=>{const e=T.current;if(!C&&e){const{src:t}=e;(e=>!(!e||"about:blank"==e||e.includes("#")))(t)?e.src=e.src:e.parentNode.insertBefore(e,e.nextSibling)}}),[C]),b((()=>{const e=T.current;if(!e||!H)return;const t=e=>{const t=T.current;t&&e.source==t.contentWindow&&i(e.origin)&&g(e)},{defaultView:o}=e.ownerDocument;return o.addEventListener("message",t),()=>o.removeEventListener("message",t)}),[i,g,H,k]),u(j,n(n({},x),{},{layout:!0,size:!0,paint:!0}),H&&k&&u("iframe",{allow:o,allowFullScreen:a,frameBorder:"0",loading:F,name:s,onLoad:()=>N(!0),part:"iframe",ref:T,sandbox:R,scrolling:"no",src:E,style:n(n({},l),{},{width:"100%",height:"100%",contentVisibility:"auto"}),title:c}))}));k.displayName="IframeEmbed";var{hasOwnProperty:S,toString:I}=Object.prototype;self.__AMP_LOG=self.__AMP_LOG||{user:null,dev:null,userForEmbed:null},self.__AMP_LOG;var R=["color","onLoad","playlistId","secretToken","trackId","visual"],E=e=>"https://w.soundcloud.com"===e,x=class extends e{static getPreconnects(){return["https://api.soundcloud.com/"]}};x.Component=function(e){let{color:t,onLoad:o,playlistId:u,secretToken:d,trackId:m,visual:f=!1}=e,b=r(e,R);const p=c(null),g=i(o);s((()=>()=>{var e,t;null===(e=p.current)||void 0===e||null===(t=e.contentWindow)||void 0===t||t.postMessage(JSON.stringify({"method":"pause"}),"https://w.soundcloud.com"),p.current=null}),[]);const j=l((e=>{const t=(o=function(e){return e.data}(e),JSON.parse(o));var o,n;"ready"===t.method&&(null===(n=g.current)||void 0===n||n.call(g))}),[g]);if(!function(e,t){return null!=t||void 0!==e||(console.warn("data-trackid or data-playlistid is required for <amp-soundcloud>"),!1)}(m,u))return null;const y=null!=m?m:u;let v="https://w.soundcloud.com/player/?url="+encodeURIComponent("https://api.soundcloud.com/"+(null!=m?"tracks":"playlists")+"/"+y);return d&&(v+=encodeURIComponent("?secret_token="+d)),f?v+="&visual=true":t&&(v+="&color="+encodeURIComponent(t)),a(k,n({allow:"autoplay",frameborder:"no",ref:p,scrolling:"no",src:v,title:"Soundcloud Widget - "+y,messageHandler:j,matchesMessagingOrigin:E},b))},x.props={"children":{passthroughNonEmpty:!0},"color":{attr:"data-color"},"playlistId":{attr:"data-playlistid"},"secretToken":{attr:"data-secret-token"},"trackId":{attr:"data-trackid"},"visual":{attr:"data-visual",type:"boolean",default:!1}},x.layoutSizeDefined=!0,x.usesShadowDom=!0,x.loadable=!0;import{defineBentoElement as C}from"../bento.mjs";C("bento-soundcloud",x,void 0);
/*! https://mths.be/cssescape v1.5.1 by @mathias | MIT license */
//# sourceMappingURL=bento-soundcloud-1.0.mjs.map