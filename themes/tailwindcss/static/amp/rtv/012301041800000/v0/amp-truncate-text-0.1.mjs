;
(self.AMP=self.AMP||[]).push({m:1,v:"2301041800000",n:"amp-truncate-text",ev:"0.1",l:!0,f:function(t,n){(()=>{function n(t){return t?Array.prototype.slice.call(t):[]}var e,{isArray:o}=Array,{hasOwnProperty:s,toString:i}=Object.prototype;function a(t){const n=Object.create(null);return t&&Object.assign(n,t),n}function r(t,n,e,o,s,i,a,r,l,c,u){return t}function l(t){const n=t.ownerDocument||t;return e&&e.ownerDocument===n||(e=n.createElement("div")),c}function c(t){return function(t,n){if(r(1===n.length),r(Array.isArray(n)||(e=n,s.call(e,"raw"))),self.trustedTypes&&self.trustedTypes.createPolicy){const e=self.trustedTypes.createPolicy("static-template#createNode",{createHTML:function(t){return n[0]}});t.innerHTML=e.createHTML("ignored")}else t.innerHTML=n[0];var e;const o=t.firstElementChild;return r(o),r(!o.nextElementSibling),t.removeChild(o),o}(e,t)}function u(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}function p(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),e.push.apply(e,o)}return e}function m(t){for(var n=1;n<arguments.length;n++){var e=null!=arguments[n]?arguments[n]:{};n%2?p(Object(e),!0).forEach((function(n){u(t,n,e[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):p(Object(e)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))}))}return t}var h=/(?:^[#?]?|&)([^=&]+)(?:=([^&]*))?/g;function d(t,n=""){try{return decodeURIComponent(t)}catch(t){return n}}function f(t,n,e,o,s,i,a,r,l,c,u){return t}function v(t){return t.nodeType?(e=t,n=(e.ownerDocument||e).defaultView,function(t,n){return _(t=function(t){return t.__AMP_TOP||(t.__AMP_TOP=t)}(t),"ampdoc")}(n)).getAmpDoc(t):t;var n,e}function _(t,n){f(x(t,n));const e=function(t){let n=t.__AMP_SERVICES;return n||(n=t.__AMP_SERVICES={}),n}(t)[n];return e.obj||(f(e.ctor),f(e.context),e.obj=new e.ctor(e.context),f(e.obj),e.context=null,e.resolve&&e.resolve(e.obj)),e.obj}function x(t,n){const e=t.__AMP_SERVICES&&t.__AMP_SERVICES[n];return!(!e||!e.ctor)}self.__AMP_LOG=self.__AMP_LOG||{user:null,dev:null,userForEmbed:null},self.__AMP_LOG;var b="__AMP__EXPERIMENT_TOGGLES",A="i-amphtml-truncate-overflow",P="i-amphtml-truncate-child-overflow",T="__AMP_TRUNCATE_TEXT_DATA",y="__AMP_TRUNCATE_TRUNCATED";function g(t){t[y]&&(t[y]=!1,t.removeAttribute(A),w(t))}function N(t,n){const e="slot"==t.localName?t.assignedNodes({flatten:!0}):t.childNodes;for(let t=0;t<e.length;t++)n(e[t])}function w(t){const n=t[T];n&&n.modifiedText==t.data&&(t.data=n.originalText),t.nodeType==Node.ELEMENT_NODE&&t.removeAttribute(P),N(t,(t=>w(t)))}function E(t,n,e){t[T]={originalText:n,modifiedText:e},t.data=e}function O(t){return t.scrollHeight-t.offsetHeight}function R({container:t,overflowNodes:n}){if(g(t),O(t)<=0)return;const e=t.getBoundingClientRect();var o;(o=t)[y]=!0,o.setAttribute(A,""),function(t,n,e){const o=M(t,(t=>!e.includes(t)));for(let e=o.length-1;e>=0;e--){const s=o[e];if(s.nodeType==Node.ELEMENT_NODE&&s.setAttribute(P,""),s.nodeType==Node.TEXT_NODE&&j(s,t,n))break}}(t,e,n)}function M(t,n,e=[]){return n(t)?(e.push(t),N(t,(t=>M(t,n,e))),e):e}function j(t,n,e){const o=document.createRange();o.selectNode(t);const s=o.getBoundingClientRect(),i=t.data;if(!s.height)return;if(s.top>e.bottom)return void E(t,i,"");const a=function(t,n,e,o=0,s=1){f(t<=n);let i=t,a=n-1,r=NaN,l=NaN;for(;a>=i;){const t=i+Math.floor((a-i)/2),n=e(t);if(n>0||0==n&&1==o)r=2==s?t:r,l=0==n?t:l,i=t+1;else{if(!(n<0||0==n&&2==o)){l=t;break}r=1==s?t:r,l=0==n?t:l,a=t-1}}return isNaN(l)?-((isNaN(r)?1==s?i:a:r)+1):l}(0,i.length,(e=>{for(;!i[e].trim()&&e>0;)e--;return function(t,n,e,o){return n.data=e.slice(0,o+1)+"… ",0-O(t)}(n,t,i,e)}),1,1),r=a>=0?a+1:-(a+1),l=(c=i.slice(0,r)).trimEnd?c.trimEnd():("_"+c).trim().slice(1);var c;return E(t,i,l?l+"… ":""),!!l}var I=["<div class=i-amphtml-truncate-content><span class=i-amphtml-default-slot></span> <span class=i-amphtml-truncate-collapsed-slot name=collapsed></span> <span class=i-amphtml-truncate-expanded-slot name=expanded></span> <span class=i-amphtml-truncate-persistent-slot name=persistent></span></div>"],V=["<div class=content><slot></slot><slot class=collapsed-slot name=collapsed></slot><slot class=expanded-slot name=expanded></slot><slot class=persistent-slot name=persistent></slot></div>"],k=class extends t.BaseElement{vN(){this.registerAction("expand",(()=>this.XD())),this.registerAction("collapse",(()=>this.$D()))}constructor(t){super(t),this._N=null,this.xN=null,this.bN=null,this.AN=null,this.PN=!1,this.Xl=new this.win.MutationObserver((()=>{this.TN()}))}buildCallback(){this.Xl.observe(this.element,{attributes:!0,characterData:!0,childList:!0,subtree:!0}),this.PN=!!this.element.attachShadow&&function(t,n){const e=function(t){var n,e,s,i,l;if(t[b])return t[b];t[b]=a();const c=t[b];r(c);const u=m(m({},null!==(n=t.AMP_CONFIG)&&void 0!==n?n:{}),null!==(e=t.AMP_EXP)&&void 0!==e?e:(p=(null===(s=t.__AMP_EXP)||void 0===s?void 0:s.textContent)||"{}",JSON.parse(p)));var p;for(const t in u){const n=u[t];"number"==typeof n&&n>=0&&n<=1&&(c[t]=Math.random()<n)}const f=null===(i=t.AMP_CONFIG)||void 0===i?void 0:i["allow-doc-opt-in"];if(o(f)&&f.length){const n=t.document.head.querySelector('meta[name="amp-experiments-opt-in"]');if(n){var v;const t=(null===(v=n.getAttribute("content"))||void 0===v?void 0:v.split(","))||[];for(const n of t)f.includes(n)&&(c[n]=!0)}}Object.assign(c,function(t){var n;let e="";try{var o;"localStorage"in t&&(e=null!==(o=t.localStorage.getItem("amp-experiment-toggles"))&&void 0!==o?o:"")}catch(t){}const s=(null===(n=e)||void 0===n?void 0:n.split(/\s*,\s*/g))||[],i=a();for(const t of s)t&&("-"==t[0]?i[t.substr(1)]=!1:i[t]=!0);return i}(t));const _=null===(l=t.AMP_CONFIG)||void 0===l?void 0:l["allow-url-opt-in"];if(o(_)&&_.length){const n=function(t){const n=a();if(!t)return n;let e;for(;e=h.exec(t);){const t=d(e[1],e[1]),o=e[2]?d(e[2].replace(/\+/g," "),e[2]):"";n[t]=o}return n}(t.location.originalHash||t.location.hash);for(const t of _){const e=n[`e-${t}`];"1"==e&&(c[t]=!0),"0"==e&&(c[t]=!1)}}return c}(t);return!!e["amp-truncate-text-shadow"]}(this.win),this.PN?this.yN():this.gN(),this.vN(),this.xN.addEventListener("click",(t=>{this.NN(t)})),this.bN.addEventListener("click",(t=>{this.wN(t)}))}gN(){const t=l(this.element);this._N=t(I);const n=this._N.querySelector(".i-amphtml-default-slot");var e;this.xN=this._N.querySelector(".i-amphtml-truncate-collapsed-slot"),this.bN=this._N.querySelector(".i-amphtml-truncate-expanded-slot"),this.AN=this._N.querySelector(".i-amphtml-truncate-persistent-slot"),this.element.querySelectorAll('[slot="collapsed"]').forEach((t=>{this.xN.appendChild(t)})),this.element.querySelectorAll('[slot="expanded"]').forEach((t=>{this.bN.appendChild(t)})),this.element.querySelectorAll('[slot="persistent"]').forEach((t=>{this.AN.appendChild(t)})),(e=this.element,function(t,n){const e=[];for(let n=t.firstChild;n;n=n.nextSibling)!(function(t){let n;var e;return"string"==typeof t?n=t:1==(null==(e=t)?void 0:e.nodeType)&&(n=t.tagName),!!n&&n.toLowerCase().startsWith("i-")}(o=n)||o.nodeType===Node.ELEMENT_NODE&&(o.hasAttribute("placeholder")||o.hasAttribute("fallback")||o.hasAttribute("overflow")))&&e.push(n);var o;return e}(e)).forEach((t=>{n.appendChild(t)})),this.element.appendChild(this._N)}yN(){const t=l(this.element),n=function(t,n,e){const o=t.querySelector("i-amphtml-sizer");o&&o.setAttribute("slot","i-amphtml-sizer");const s=t.attachShadow({mode:"open"}),i=document.createElement("style");i.textContent=":host{padding:0!important;border:none!important}:host([i-amphtml-truncate-expanded]){height:auto!important}:host([i-amphtml-truncate-expanded]) ::slotted(i-amphtml-sizer){display:none!important}:host([i-amphtml-truncate-expanded]) .content{position:static}:host(:not([i-amphtml-truncate-expanded])) .expanded-slot{display:none}.content{position:absolute;top:0;left:0;bottom:0;right:0}.expand-slot::slotted(*){margin:0!important;white-space:nowrap!important}:host(:not([i-amphtml-truncate-overflow])) .collapsed-slot{display:none}::slotted([i-amphtml-truncate-child-overflow]){display:none!important}\n/*# sourceURL=/extensions/amp-truncate-text/0.1/amp-truncate-text-shadow.css*/";const a=document.createElement("slot");return a.setAttribute("name","i-amphtml-sizer"),s.appendChild(i),s.appendChild(a),s.appendChild(e),s}(this.element,0,t(V));this._N=null,this.xN=n.querySelector(".collapsed-slot"),this.bN=n.querySelector(".expanded-slot"),this.AN=n.querySelector(".persistent-slot")}layoutCallback(){return this.mutateElement((()=>{this.TN()}))}isRelayoutNeeded(){return!0}isLayoutSupported(){return!0}EN(){return this.PN?n(this.element.querySelectorAll('[slot="persistent"], [slot="collapsed"]')):n(this.element.querySelectorAll(".i-amphtml-truncate-persistent-slot, .i-amphtml-truncate-collapsed-slot"))}TN(){R({container:this.PN?this.element:this._N,overflowNodes:this.EN()}),this.Xl.takeRecords()}NN(t){this.ON(t,!0)}wN(t){this.ON(t,!1)}ON(t,n){const e=t.target;var o;(o=this.element,function(t,n){const e=function(t){const n=v(t);return n.isSingleDoc()?n.win:n}(v(t));return x(e,n)?_(e,n):null}(o,"action")).hasAction(e,"tap")||e.closest("a[href]")||(n?this.XD():this.$D())}XD(){this.element.setAttribute("i-amphtml-truncate-expanded","")}$D(){this.element.removeAttribute("i-amphtml-truncate-expanded")}};t.registerElement("amp-truncate-text",k,"amp-truncate-text{padding:0!important;border:none!important}amp-truncate-text[i-amphtml-truncate-expanded]{height:auto!important}amp-truncate-text[i-amphtml-truncate-expanded]>i-amphtml-sizer{display:none!important}amp-truncate-text[i-amphtml-truncate-expanded] .i-amphtml-truncate-content{position:static!important}amp-truncate-text:not([i-amphtml-truncate-expanded]) .i-amphtml-truncate-expanded-slot{display:none!important}.i-amphtml-truncate-content{position:absolute!important;top:0!important;left:0!important;bottom:0!important;right:0!important}.i-amphtml-truncate-content [slot=expanded]{margin:0!important;white-space:nowrap!important}.i-amphtml-truncate-content:not([i-amphtml-truncate-overflow]) .i-amphtml-truncate-collapsed-slot,[i-amphtml-truncate-child-overflow]{display:none!important}\n/*# sourceURL=/extensions/amp-truncate-text/0.1/amp-truncate-text.css*/")})();
/*! https://mths.be/cssescape v1.5.1 by @mathias | MIT license */}});
//# sourceMappingURL=amp-truncate-text-0.1.mjs.map