;
(self.AMP=self.AMP||[]).push({m:1,v:"2301041800000",n:"amp-bodymovin-animation",ev:"0.1",l:!0,f:function(t,n){(()=>{var{isArray:n}=Array,{hasOwnProperty:e,toString:r}=Object.prototype;function o(t){return"[object Object]"===r.call(t)}function i(t){const n=Object.create(null);return t&&Object.assign(n,t),n}function s(t,n){return e.call(t,n)}function c(t){return"number"==typeof t&&isFinite(t)}function u(t,n,e,r,o,i,s,c,u,l,a){return t}var l=class{constructor(){this.promise=new Promise(((t,n)=>{this.resolve=t,this.reject=n}))}};function a(t){return JSON.parse(t)}function f(t){const n=parseFloat(t);return c(n)?n:void 0}var h=/(?:^[#?]?|&)([^=&]+)(?:=([^&]*))?/g;function p(t,n=""){try{return decodeURIComponent(t)}catch(t){return n}}function d(t){const n=i();if(!t)return n;let e;for(;e=h.exec(t);){const t=p(e[1],e[1]),r=e[2]?p(e[2].replace(/\+/g," "),e[2]):"";n[t]=r}return n}function m(t){const{location:n}=t||self;return d(n.originalHash||n.hash)}var v="";function b(t){const n=t||self;return n.__AMP_MODE?n.__AMP_MODE:n.__AMP_MODE=function(t){return{localDev:!1,development:g(t,m(t)),esm:!0,test:!1,rtvVersion:y(t),ssrReady:!1}}(n)}function y(t){var n;return v||(v=(null===(n=t.AMP_CONFIG)||void 0===n?void 0:n.v)||"012301041800000"),v}function g(t,n){const e=n||m(t);return["1","actions","amp","amp4ads","amp4email"].includes(e.development)||!!t.AMP_DEV_MODE}self.__AMP_LOG=self.__AMP_LOG||{user:null,dev:null,userForEmbed:null};var w=self.__AMP_LOG;function O(t){return w.user||(w.user=j()),function(t,n){return n&&n.ownerDocument.defaultView!=t}(w.user.win,t)?w.userForEmbed||(w.userForEmbed=j()):w.user}function j(t){return function(t,n){throw new Error("failed to call initLogConstructor")}()}function _(t,n,e,r,o,i,s,c,u,l,a){return t}function A(t,n,e,r,o,i,s,c,u,l,a){return O().assert(t,n,e,r,o,i,s,c,u,l,a)}function P(t,n){return R(t=function(t){return t.__AMP_TOP||(t.__AMP_TOP=t)}(t),n)}function x(t,n){return R(T(S(t)),n)}function S(t){return t.nodeType?(e=t,n=(e.ownerDocument||e).defaultView,P(n,"ampdoc")).getAmpDoc(t):t;var n,e}function T(t){const n=S(t);return n.isSingleDoc()?n.win:n}function R(t,n){_(E(t,n));const e=function(t){let n=t.__AMP_SERVICES;return n||(n=t.__AMP_SERVICES={}),n}(t)[n];return e.obj||(_(e.ctor),_(e.context),e.obj=new e.ctor(e.context),_(e.obj),e.context=null,e.resolve&&e.resolve(e.obj)),e.obj}function E(t,n){const e=t.__AMP_SERVICES&&t.__AMP_SERVICES[n];return!(!e||!e.ctor)}var M,$=t=>S(t);function k(t){return t.data}var I,N=["Webkit","webkit","Moz","moz","ms","O","o"];var V=class{static generate(t){return function(t){const{length:n}=t;let e=5381;for(let r=0;r<n;r++)e=33*e^t.charCodeAt(r);return String(e>>>0)}(function(t){const n=[];let e=0;for(;1==(null==(r=t)?void 0:r.nodeType)&&e<25;){let r="";t.id&&(r=`/${t.id}`);const o=t.nodeName.toLowerCase();n.push(`${o}${r}${L(t)}`),e++,t=t.parentElement}var r;return n.join()}(t))}};function L(t){const{nodeName:n}=t;let e=0,r=0,o=t.previousElementSibling;for(;o&&r<25&&e<100;)o.nodeName==n&&r++,e++,o=o.previousElementSibling;return r<25&&e<100?`.${r}`:""}function C(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}function F(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),e.push.apply(e,r)}return e}function U(t){for(var n=1;n<arguments.length;n++){var e=null!=arguments[n]?arguments[n]:{};n%2?F(Object(e),!0).forEach((function(n){C(t,n,e[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):F(Object(e)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))}))}return t}var J="__AMP__EXPERIMENT_TOGGLES";function D(t){var e,r,o,s,c;if(t[J])return t[J];t[J]=i();const l=t[J];u(l);const f=U(U({},null!==(e=t.AMP_CONFIG)&&void 0!==e?e:{}),null!==(r=t.AMP_EXP)&&void 0!==r?r:a((null===(o=t.__AMP_EXP)||void 0===o?void 0:o.textContent)||"{}"));for(const t in f){const n=f[t];"number"==typeof n&&n>=0&&n<=1&&(l[t]=Math.random()<n)}const h=null===(s=t.AMP_CONFIG)||void 0===s?void 0:s["allow-doc-opt-in"];if(n(h)&&h.length){const n=t.document.head.querySelector('meta[name="amp-experiments-opt-in"]');if(n){var p;const t=(null===(p=n.getAttribute("content"))||void 0===p?void 0:p.split(","))||[];for(const n of t)h.includes(n)&&(l[n]=!0)}}Object.assign(l,function(t){var n;let e="";try{var r;"localStorage"in t&&(e=null!==(r=t.localStorage.getItem("amp-experiment-toggles"))&&void 0!==r?r:"")}catch(t){}const o=(null===(n=e)||void 0===n?void 0:n.split(/\s*,\s*/g))||[],s=i();for(const t of o)t&&("-"==t[0]?s[t.substr(1)]=!1:s[t]=!0);return s}(t));const m=null===(c=t.AMP_CONFIG)||void 0===c?void 0:c["allow-url-opt-in"];if(n(m)&&m.length){const n=d(t.location.originalHash||t.location.hash);for(const t of m){const e=n[`e-${t}`];"1"==e&&(l[t]=!0),"0"==e&&(l[t]=!1)}}return l}var q,z=(()=>self.AMP.config.urls)();function B(t,n){return q||(q=self.document.createElement("a")),function(t,n,e){return t.href="",new URL(n,t.href)}(q,t)}function G(t,n,e="source"){return A(null!=t,"%s %s must be available",n,e),A("https:"==(r=(t=>"string"==typeof t?B(t):t)(r=t)).protocol||"localhost"==r.hostname||"127.0.0.1"==r.hostname||function(t,n){const e=t.length-n.length;return e>=0&&t.indexOf(n,e)==e}(r.hostname,".localhost")||/^\/\//.test(t),'%s %s must start with "https://" or "//" or be relative and served from either https or from localhost. Invalid value: %s',n,e,t),t;var r}new Set(["c","v","a","ad"]);var W=(()=>self.AMP.config.urls)(),H={};function X(t){return`${W.thirdParty}/2301041800000/vendor/${t}.mjs`}function Z(t,n,e){return function(t,n,e){const r=n.getMetaByName("amp-3p-iframe-src");if(!r)return null;const o=G(r,'meta[name="amp-3p-iframe-src"]');A(-1==o.indexOf("?"),"3p iframe url must not include query string %s in element %s.",o,r);const i=B(o);return A("localhost"==i.hostname&&!e||i.origin!=B(t.location.href).origin,"3p iframe url must not be on the same origin as the current document %s (%s) in element %s. See https://github.com/ampproject/amphtml/blob/main/docs/spec/amp-iframe-origin-policy.md for details.",o,i.origin,r),`${o}?2301041800000`}(t,n,e)||function(t,n){return t.__AMP_DEFAULT_BOOTSTRAP_SUBDOMAIN=t.__AMP_DEFAULT_BOOTSTRAP_SUBDOMAIN||"d-"+K(t),"https://"+t.__AMP_DEFAULT_BOOTSTRAP_SUBDOMAIN+`.${W.thirdPartyFrameHost}/2301041800000/frame.html`}(t)}function K(t){let n;if(t.crypto&&t.crypto.getRandomValues){const e=new Uint32Array(2);t.crypto.getRandomValues(e),n=String(e[0])+e[1]}else n=String(t.Math.random()).substr(2)+"0";return n}var Q={NONE:0,OPT_IN:1,ALL:2};function Y(t,n,e={}){const{expr:r=".",urlReplacement:o=Q.NONE,refresh:i=!1,xssiPrefix:c,url:u=n.getAttribute("src")}=e;G(u,n);const l=P(t.win,"batched-xhr");return function(t,n,e,r){const o=(t=>function(t,n){const e=T(S(t));return E(e,n)?R(e,n):null}(t,"url-replace"))(t);return(e>=Q.OPT_IN?o.expandUrlAsync(n):Promise.resolve(n)).then((n=>{if(e===Q.OPT_IN){const n=o.collectDisallowedVarsSync(t);if(n.length>0)throw O().createError(`URL variable substitutions in CORS fetches from dynamic URLs (e.g. via amp-bind) require opt-in. Please add data-amp-replace="${n.join(" ")}" to the <${t.tagName}> element. See https://bit.ly/amp-var-subs.`)}const i={};return t.hasAttribute("credentials")&&(i.credentials=t.getAttribute("credentials")),r&&(i.cache="reload"),{"xhrUrl":n,"fetchOpt":i}}))}(n,u,o,i).then((t=>l.fetchJson(t.xhrUrl,t.fetchOpt))).then((n=>{return(e=t.win,P(e,"xhr")).xssiJson(n,c);var e})).then((t=>{if(null==t)throw new Error("Response is undefined.");return function(t,n){if("."==n)return t;const e=n.split(".");let r=t;for(const t of e){if(!(t&&r&&void 0!==r[t]&&"object"==typeof r&&s(r,t))){r=void 0;break}r=r[t]}return r}(t,r||".")})).catch((t=>{throw O().createError("failed fetching JSON data",t)}))}var tt=class extends t.BaseElement{constructor(t){super(t),this.ji=$(this.element),this.Lv=null,this.dp=null,this.tp=null,this.$j=null,this.bb=null,this.yb=null,this.dw=null}isLayoutSupported(t){return function(t){return"fixed"==t||"fixed-height"==t||"responsive"==t||"fill"==t||"flex-item"==t||"fluid"==t||"intrinsic"==t}(t)}preconnectCallback(t){const n=P(this.win,"preconnect");!function(t,n,e,r){const o=Z(t,e);r.preload(e,o,"document"),r.preload(e,X("bodymovinanimation"),"script")}(this.win,0,this.getAmpDoc(),n),n.url(this.getAmpDoc(),"https://cdnjs.cloudflare.com",t)}buildCallback(){this.dp=this.element.getAttribute("loop")||"true",this.$j=!this.element.hasAttribute("noautoplay"),this.tp=this.element.getAttribute("renderer")||"svg",A(this.element.hasAttribute("src"),"The src attribute must be specified for <amp-bodymovin-animation>"),G(this.element.getAttribute("src"),this.element);const t=new l;this.bb=t.promise,this.yb=t.resolve,this.registerAction("play",(()=>{this.Ev()}),1),this.registerAction("pause",(()=>{this.jv()}),1),this.registerAction("stop",(()=>{this.Vj()}),1),this.registerAction("seekTo",(t=>{const{args:n}=t;n&&this.Lj(n)}),1)}layoutCallback(){return Y(this.ji,this.element).then((t=>{const n={loop:this.dp,autoplay:this.$j,renderer:this.tp,animationData:t},e=function(t,n,e,r,o={}){const{allowFullscreen:s=!1,initialIntersection:c}=o;_(void 0===n.isConnected||!0===n.isConnected);const u=function(t,n,e,r){const o=e||n.getAttribute("type");A(o,"Attribute type required for <amp-ad>: %s",n);const i=function(t){let n=0;for(let e=t;e&&e!=e.parent;e=e.parent)n++;return String(n)+"-"+K(t)}(t);let s={};return function(t,n){const{dataset:e}=t;for(const t in e)t.startsWith("vars")||(n[t]=e[t]);const r=t.getAttribute("json");if(r){const e=function(t,n){try{return a(t)}catch(t){return null}}(r);if(void 0===e)throw O().createError("Error parsing JSON in json attribute in element %s",t);for(const t in e)n[t]=e[t]}}(n,s),s=function(t,n,e,r){const o=Date.now(),i=n.getAttribute("width"),s=n.getAttribute("height");(r=r||{}).width=f(i),r.height=f(s),n.getAttribute("title")&&(r.title=n.getAttribute("title"));let c=t.location.href;"about:srcdoc"==c&&(c=t.parent.location.href);const u=$(n),l=x(n,"documentInfo").get(),a=(p=n,x(p,"viewer")).getUnconfirmedReferrerUrl(),h=function(t){const n=t.ownerDocument.body;let e=0,r=0;for(let o=t;o&&o!=n;o=o.offsetParent)e+=o.offsetLeft,r+=o.offsetTop;const{offsetHeight:o,offsetWidth:i}=t;return function(t,n,e,r){return{left:t,top:n,width:e,height:r,bottom:n+r,right:t+e,x:t,y:n}}(e,r,i,o)}(n);var p,d,m,v;r._context={"ampcontextVersion":"2301041800000","ampcontextFilepath":`${z.thirdParty}/2301041800000/ampcontext-v0.js`,"sourceUrl":l.sourceUrl,"referrer":a,"canonicalUrl":l.canonicalUrl,"pageViewId":l.pageViewId,"location":{"href":c},"startTime":o,"tagName":n.tagName,"mode":{localDev:!1,development:!1,esm:b(v).esm,test:!1,rtvVersion:b(v).rtvVersion},"canary":(d=t,!(null===(m=d.AMP_CONFIG)||void 0===m||!m.canary)),"hidden":!u.isVisible(),"initialLayoutRect":h?{"left":h.left,"top":h.top,"width":h.width,"height":h.height}:null,"domFingerprint":V.generate(n),"experimentToggles":D(t),"sentinel":e};const y=n.getAttribute("src");return y&&(r.src=y),r}(t,n,i,s),s.type=o,Object.assign(s._context,r),s}(t,n,e,r);c&&(u._context.initialIntersection=c);const l=t.document.createElement("iframe");H[u.type]||(H[u.type]=0),H[u.type]+=1;const h=Z(t,n.getAmpDoc()),p=B(h).hostname,d=JSON.stringify({"host":p,"bootstrap":X(u.type),"type":u.type,"count":H[u.type],"attributes":u});return l.src=h,l.ampLocation=B(h),l.name=d,u.width&&(l.width=u.width),u.height&&(l.height=u.height),u.title&&(l.title=u.title),s&&l.setAttribute("allowfullscreen","true"),l.setAttribute("scrolling","no"),function(t,n,e,r,o){const s=function(t,n,e){if(n.startsWith("--"))return n;I||(I=i());let r=I[n];if(!r||e){if(r=n,void 0===t[n]){const e=function(t){return t.charAt(0).toUpperCase()+t.slice(1)}(n),o=function(t,n){for(let e=0;e<N.length;e++){const r=N[e]+n;if(void 0!==t[r])return r}return""}(t,e);void 0!==t[o]&&(r=o)}e||(I[n]=r)}return r}(t.style,n,o);if(!s)return;const c=r?e+r:e;t.style.setProperty(function(t){const n=t.replace(/[A-Z]/g,(t=>"-"+t.toLowerCase()));return N.some((t=>n.startsWith(t+"-")))?`-${n}`:n}(s),c)}(l,"border","none"),l.onload=function(){this.readyState="complete"},l.setAttribute("allow","sync-xhr 'none';"),["facebook"].includes(e)||function(t){if(!t.sandbox||!t.sandbox.supports)return;const n=["allow-top-navigation-by-user-activation","allow-popups-to-escape-sandbox"];for(let e=0;e<n.length;e++){const r=n[e];if(!t.sandbox.supports(r))return}t.sandbox=n.join(" ")+" "+["allow-forms","allow-modals","allow-pointer-lock","allow-popups","allow-same-origin","allow-scripts"].join(" ")}(l),l.setAttribute("data-amp-3p-sentinel",u._context.sentinel),l}(this.win,this.element,"bodymovinanimation",n);return e.title=this.element.title||"Airbnb BodyMovin animation",(r=this.win,P(r,"vsync")).mutatePromise((()=>{var t,n;e.classList.add("i-amphtml-fill-content"),this.dw=(t=this.win,n=this.Fj.bind(this),function(t,n,e,r){let o=t,i=e,s=t=>{try{return i(t)}catch(t){var n,e;throw null===(n=(e=self).__AMP_REPORT_ERROR)||void 0===n||n.call(e,t),t}};const c=function(){if(void 0!==M)return M;M=!1;try{const t={get capture(){return M=!0,!1}};self.addEventListener("test-options",null,t),self.removeEventListener("test-options",null,t)}catch(t){}return M}();return o.addEventListener(n,s,!!c&&r),()=>{null==o||o.removeEventListener(n,s,!!c&&r),i=null,o=null,s=null}}(t,"message",n,void 0)),this.element.appendChild(e),this.Lv=e})).then((()=>this.bb));var r}))}unlayoutCallback(){var t,n;this.Lv&&(null===(n=(t=this.Lv).parentElement)||void 0===n||n.removeChild(t),this.Lv=null),this.dw&&this.dw();const e=new l;return this.bb=e.promise,this.yb=e.resolve,!0}Fj(t){if(this.Lv&&t.source!=this.Lv.contentWindow)return;if(!k(t)||!o(k(t))&&!k(t).startsWith("{"))return;const n=o(k(t))?k(t):a(k(t));void 0!==n&&"ready"==n.action&&this.yb()}wb(t,n,e){this.bb.then((()=>{if(this.Lv&&this.Lv.contentWindow){const r=JSON.stringify({"action":t,"valueType":n||"","value":e||""});this.Lv.contentWindow.postMessage(r,"*")}}))}Ev(){this.wb("play")}jv(){this.wb("pause")}Vj(){this.wb("stop")}Lj(t){const n=parseFloat(t&&t.time);c(n)&&this.wb("seekTo","time",n);const e=parseFloat(t&&t.percent);var r;c(e)&&this.wb("seekTo","percent",(r=e,u(!0),Math.min(Math.max(r,0),1)))}};t.registerElement("amp-bodymovin-animation",tt)})();
/*! https://mths.be/cssescape v1.5.1 by @mathias | MIT license */}});
//# sourceMappingURL=amp-bodymovin-animation-0.1.mjs.map