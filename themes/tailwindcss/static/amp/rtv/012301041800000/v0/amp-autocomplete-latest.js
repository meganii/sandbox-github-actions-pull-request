;
(self.AMP=self.AMP||[]).push({m:0,v:"2301041800000",n:"amp-autocomplete",ev:"0.1",l:!0,f:function(t,n){!function(){var n,i,e,r=Object.create,u=Object.defineProperty,o=Object.getOwnPropertyDescriptor,s=Object.getOwnPropertyNames,a=Object.getPrototypeOf,c=Object.prototype.hasOwnProperty,h=(n={"third_party/fuzzysearch/index.js":function(t,n){"use strict";n.exports=function(t,n){var i=n.length,e=t.length;if(e>i)return!1;if(e===i&&t===n)return!0;t:for(var r=0,u=0;r<e;r++){for(var o=t.charCodeAt(r);u<i;)if(n.charCodeAt(u++)===o)continue t;return!1}return!0}}},function(){return i||(0,n[Object.keys(n)[0]])((i={exports:{}}).exports,i),i.exports});function f(t,n){(null==n||n>t.length)&&(n=t.length);for(var i=0,e=new Array(n);i<n;i++)e[i]=t[i];return e}function l(){return e||(e=Promise.resolve(void 0))}function p(t,n,i){return n in t?Object.defineProperty(t,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[n]=i,t}function d(t,n){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(t);n&&(e=e.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),i.push.apply(i,e)}return i}function v(t){for(var n=1;n<arguments.length;n++){var i=null!=arguments[n]?arguments[n]:{};n%2?d(Object(i),!0).forEach((function(n){p(t,n,i[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):d(Object(i)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(i,n))}))}return t}function m(t){return(m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function b(t,n){return(b=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}function y(t){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function x(t,n){if(n&&("object"===m(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}var g=Array.isArray;function w(t,n,i){return"number"!=typeof i&&(i=0),!(i+n.length>t.length)&&-1!==t.indexOf(n,i)}var j=Object.prototype,O=j.hasOwnProperty,R=j.toString;function E(t){var n=Object.create(null);return t&&Object.assign(n,t),n}function S(t,n){return O.call(t,n)}function T(t,n){return S(t,n)?t[n]:void 0}function U(t,n){if("."==n)return t;for(var i,e=t,r=function(t,n){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(i)return(i=i.call(t)).next.bind(i);if(Array.isArray(t)||(i=function(t,n){if(t){if("string"==typeof t)return f(t,n);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?f(t,n):void 0}}(t))||t&&"number"==typeof t.length){i&&(t=i);var e=0;return function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(n.split("."));!(i=r()).done;){var u=i.value;if(!(u&&e&&void 0!==e[u]&&"object"==m(e)&&S(e,u))){e=void 0;break}e=e[u]}return e}function A(t,n,i,e,r,u,o,s,a,c,h){return t}function _(t,n){try{return function(t){return JSON.parse(t)}(t)}catch(t){return null==n||n(t),null}}function I(t){try{t.focus()}catch(t){}}function k(t,n){void 0===n&&(n=t.hasAttribute("hidden")),n?t.removeAttribute("hidden"):t.setAttribute("hidden","")}var P=/(?:^[#?]?|&)([^=&]+)(?:=([^&]*))?/g;function C(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";try{return decodeURIComponent(t)}catch(t){return n}}self.__AMP_LOG=self.__AMP_LOG||{user:null,dev:null,userForEmbed:null};var M=self.__AMP_LOG;function z(t){return M.user||(M.user=q()),function(t,n){return n&&n.ownerDocument.defaultView!=t}(M.user.win,t)?M.userForEmbed||(M.userForEmbed=q()):M.user}function q(t){return function(t,n){throw new Error("failed to call initLogConstructor")}()}function N(t,n,i,e,r,u,o,s,a,c,h){return t}function L(t,n,i,e,r,u,o,s,a,c,h){return z().assert(t,n,i,e,r,u,o,s,a,c,h)}function J(t,n){return G(t=function(t){return t.__AMP_TOP||(t.__AMP_TOP=t)}(t),n)}function B(t,n){return G(F(D(t)),n)}function $(t,n){var i=F(D(t));return H(i,n)?G(i,n):null}function D(t){return t.nodeType?(i=t,n=(i.ownerDocument||i).defaultView,J(n,"ampdoc")).getAmpDoc(t):t;var n,i}function F(t){var n=D(t);return n.isSingleDoc()?n.win:n}function G(t,n){N(H(t,n));var i=function(t){var n=t.__AMP_SERVICES;return n||(n=t.__AMP_SERVICES={}),n}(t)[n];return i.obj||(N(i.ctor),N(i.context),i.obj=new i.ctor(i.context),N(i.obj),i.context=null,i.resolve&&i.resolve(i.obj)),i.obj}function H(t,n){var i=t.__AMP_SERVICES&&t.__AMP_SERVICES[n];return!(!i||!i.ctor)}var K=function(t){return J(t,"batched-xhr")},Q=function(t){return J(t,"xhr")};function V(t,n,i,e){var r={detail:i};if(Object.assign(r,e),"function"==typeof t.CustomEvent)return new t.CustomEvent(n,r);var u=t.document.createEvent("CustomEvent");return u.initCustomEvent(n,!!r.bubbles,!!r.cancelable,i),u}function W(t){return!!t&&"function"==typeof t.getFormData}var X,Y,Z=function(){function t(t){this.Lt=t,this.Wt=0,this.Kt=0,this.Qt=E()}var n=t.prototype;return n.has=function(t){return!!this.Qt[t]},n.get=function(t){var n=this.Qt[t];if(n)return n.access=++this.Kt,n.payload},n.put=function(t,n){this.has(t)||this.Wt++,this.Qt[t]={payload:n,access:this.Kt},this.Xt()},n.Xt=function(){if(!(this.Wt<=this.Lt)){var t,n=this.Qt,i=this.Kt+1;for(var e in n){var r=n[e].access;r<i&&(i=r,t=e)}void 0!==t&&(delete n[t],this.Wt--)}},t}(),tt=function(){return self.AMP.config.urls}(),nt=new Set(["c","v","a","ad"]),it="__amp_source_origin",et=function(t){return"string"==typeof t?rt(t):t};function rt(t,n){return X||(X=self.document.createElement("a"),Y=self.__AMP_URL_CACHE||(self.__AMP_URL_CACHE=new Z(100))),function(t,n,i){if(i&&i.has(n))return i.get(n);t.href=n,t.protocol||(t.href=t.href);var e,r={href:t.href,protocol:t.protocol,host:t.host,hostname:t.hostname,port:"0"==t.port?"":t.port,pathname:t.pathname,search:t.search,hash:t.hash,origin:null};"/"!==r.pathname[0]&&(r.pathname="/"+r.pathname),("http:"==r.protocol&&80==r.port||"https:"==r.protocol&&443==r.port)&&(r.port="",r.host=r.hostname),e=t.origin&&"null"!=t.origin?t.origin:"data:"!=r.protocol&&r.host?r.protocol+"//"+r.host:r.href,r.origin=e;var u=r;return i&&i.put(n,u),u}(X,t,n?null:Y)}function ut(t,n){return"".concat(encodeURIComponent(t),"=").concat(encodeURIComponent(n))}function ot(t,n,i,e){return function(t,n,i){if(!n)return t;var e=t.split("#",2),r=e[0].split("?",2);return r[0]+(r[1]?i?"?".concat(n,"&").concat(r[1]):"?".concat(r[1],"&").concat(n):"?".concat(n))+(e[1]?"#".concat(e[1]):"")}(t,ut(n,i),e)}function st(t){return"https:"==(t=et(t)).protocol||"localhost"==t.hostname||"127.0.0.1"==t.hostname||(i=".localhost",(e=(n=t.hostname).length-i.length)>=0&&n.indexOf(i,e)==e);var n,i,e}function at(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"source";return L(null!=t,"%s %s must be available",n,i),L(st(t)||/^\/\//.test(t),'%s %s must start with "https://" or "//" or be relative and served from either https or from localhost. Invalid value: %s',n,i,t),t}var ct=["GET","POST"],ht=[g,function(t){return"[object Object]"===R.call(t)}];function ft(t,n){var i=v({},n);if(W(n.body)){var e=n.body;i.headers["Content-Type"]="multipart/form-data;charset=utf-8",i.body=function(t){for(var n=[],i=t.next();!i.done;i=t.next())n.push(i.value);return n}(e.entries())}return{input:t,init:i}}var lt,pt,dt=(lt=h(),function(t,n,i){if(n&&"object"==typeof n||"function"==typeof n)for(var e,r=s(n),a=0,h=r.length;a<h;a++)e=r[a],c.call(t,e)||"default"===e||u(t,e,{get:function(t){return n[t]}.bind(null,e),enumerable:!(i=o(n,e))||i.enumerable});return t}((pt=u(null!=lt?r(a(lt)):{},"default",lt&&lt.__esModule&&"default"in lt?{get:function(){return lt.default},enumerable:!0}:{value:lt,enumerable:!0}),u(pt,"__esModule",{value:!0})),lt)),vt=function(){function t(t){var n=t.element;this.zn=n,this.Ns=this.zn.getAttribute("inline"),L(""!==this.Ns,'Empty value for the "inline" attr is unsupported, %s. %s',"amp-autocomplete",n),L(""!==this.Ns,"AutocompleteBindingInline does not support an empty value in the constructor."),this.pJ=null;var i=this.Ns.replace(/([()[{*+.$^\\|?])/g,"\\$1"),e="((".concat(i,"|^").concat(i,")(\\w+)?)");this.mJ=new RegExp(e,"gm")}var n=t.prototype;return n.shouldAutocomplete=function(t){var n=this.bJ(this.mJ,t);return this.pJ=n,!!n},n.bJ=function(t,n){if(!t)return null;for(var i,e,r=n.selectionStart,u=n.value;null!==(i=t.exec(u))&&!(i[0].length+T(i,"index")>r);)e=i;return!e||e[0].length+T(e,"index")<r?null:e},n.getUserInputForUpdate=function(t){return this.pJ&&this.pJ[0]?this.pJ[0].slice(this.Ns.length):""},n.getUserInputForUpdateWithSelection=function(t,n,i){if(!this.pJ)return n.value;var e=n.selectionStart,r=Number(T(this.pJ,"index")),u=i.length;e>=r+u&&(e-=u),I(n),e=e+t.length+1,n.setSelectionRange(e,e),this.pJ=null;var o=n.value;return o.slice(0,r+this.Ns.length)+t+" "+o.slice(r+this.Ns.length+u)},n.resetInputOnWrapAround=function(t,n){},n.shouldSuggestFirst=function(){return this.zn.hasAttribute("suggest-first")},n.shouldShowOnFocus=function(){return!1},n.displayActiveItemInInput=function(t,n,i){},n.removeSelectionHighlighting=function(t){},n.shouldPreventDefaultOnEnter=function(t){return t},t}(),mt=function(){function t(t){var n=t.element;this.yJ=n.hasAttribute("suggest-first");var i=n.getAttribute("filter");this.yJ&&"prefix"!==i&&(this.yJ=!1,z().warn("AMP-AUTOCOMPLETE",'"suggest-first" expected "filter" type "prefix".')),this.xJ=n.hasAttribute("submit-on-enter")}var n=t.prototype;return n.shouldAutocomplete=function(t){return!0},n.getUserInputForUpdate=function(t){return t.value||""},n.getUserInputForUpdateWithSelection=function(t,n,i){return t},n.resetInputOnWrapAround=function(t,n){n.value=t},n.shouldSuggestFirst=function(){return this.yJ},n.shouldShowOnFocus=function(){return!0},n.displayActiveItemInInput=function(t,n,i){t.value=n,this.yJ&&t.setSelectionRange(i.length,n.length)},n.removeSelectionHighlighting=function(t){var n=t.value.length;t.setSelectionRange(n,n)},n.shouldPreventDefaultOnEnter=function(t){return!this.xJ},t}();function bt(t,n,i,e){var r=function(t){return $(t,"url-replace")}(t);return(i>=1?r.expandUrlAsync(n):Promise.resolve(n)).then((function(n){if(1===i){var u=r.collectDisallowedVarsSync(t);if(u.length>0)throw z().createError("URL variable substitutions in CORS fetches from dynamic URLs (e.g. via amp-bind) require opt-in. "+'Please add data-amp-replace="'.concat(u.join(" "),'" to the ')+"<".concat(t.tagName,"> element. See https://bit.ly/amp-var-subs."))}var o={};return t.hasAttribute("credentials")&&(o.credentials=t.getAttribute("credentials")),e&&(o.cache="reload"),{"xhrUrl":n,"fetchOpt":o}}))}var yt=function(){function t(t,n,i){this.co=n,this.ty=i,this.gJ=t}var n=t.prototype;return n.isEnabled=function(){var t=this.co.getAmpDoc();return!(!t.isSingleDoc()||!t.getRootNode().documentElement.hasAttribute("allow-viewer-render-template"))&&this.co.hasCapability("viewerRenderTemplate")},n.assertTrustedViewer=function(t){return this.co.isTrustedViewer().then((function(n){L(n,"Refused to attempt SSR in untrusted viewer: ",t)}))},n.ssr=function(t,n){var i,e=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return r||(i=this.ty.maybeFindTemplate(t)),this.assertTrustedViewer(t).then((function(){return e.co.sendMessageAwaitResponse("viewerRenderTemplate",e.wJ(n,i,r,u))}))},n.applySsrOrCsrTemplate=function(t,n){var i,e=this;return this.isEnabled()?(L("string"==typeof n.html,"Skipping template rendering due to failed fetch"),i=this.assertTrustedViewer(t).then((function(){return e.ty.findAndSetHtmlForTemplate(t,n.html)}))):i=g(n)?this.ty.findAndRenderTemplateArray(t,n):this.ty.findAndRenderTemplate(t,n),i},n.wJ=function(t,n,i){var e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r={"type":this.gJ},u="successTemplate",o=i&&i[u]?i[u]:n;o&&(r[u]={"type":"amp-mustache","payload":o.innerHTML});var s="errorTemplate",a=i&&i[s]?i[s]:null;a&&(r[s]={"type":"amp-mustache","payload":a.innerHTML}),e&&Object.assign(r,e);var c={"originalRequest":ft(t.xhrUrl,t.fetchOpt),"ampComponent":r};return c},t}(),xt="amp-autocomplete",gt="none",wt=function(t){!function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&b(t,n)}(r,t);var n,i,e=(n=r,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=y(n);if(i){var r=y(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return x(this,t)});function r(t){var n,i,r,u;return(n=e.call(this,t)).Uo=null,n.jJ=null,n.OJ=null,n.RJ="",n.aC="",n.EJ=1,n.SJ=null,n.yJ=!1,n.TJ=!1,n.UJ=!1,n.AJ="",n._J="",n.IJ=-1,n.kJ=null,n.PJ=t.id?t.id:Math.floor(100*Math.random()),n.qn=null,n.CJ=!1,n.MJ=null,n.ty=null,n.zJ=!1,n.getSsrTemplateHelper=(i=!1,r=null,u=function(){return new yt(xt,B(n.element,"viewer"),n.ty)},function(){if(!i){for(var t=arguments.length,n=new Array(t),e=0;e<t;e++)n[e]=arguments[e];r=u.apply(self,n),i=!0,u=null}return r}),n.qJ=!1,n.Ks=null,n.Pu=null,n.NJ=!1,n.LJ=t.id?t.id:Math.floor(100*Math.random())+"_AMP_content_",n}var u=r.prototype;return u.buildCallback=function(){this.ty=B(this.element,"templates"),this.Ks=$(this.element,"action"),this.Pu=B(this.element,"viewport"),this.OJ=this.JJ();var t=this.OJ.getAttribute("type");L(!this.OJ.hasAttribute("type")||"text"===t||"search"===t,'%s requires the "type" attribute to be "text" or "search" if present on <input>. %s',xt,this.element),this.Uo=this.BJ(),this._J=this.element.getAttribute("query"),this.AJ=this.element.getAttribute("src");var n=this.element.querySelector('script[type="application/json"]');n?this.jJ=this.$J(n):this.element.hasAttribute("src")||z().warn(xt,'Expected a <script type="application/json"> child or a URL specified in "src".'),this.OJ.setAttribute("dir","auto"),this.OJ.setAttribute("aria-autocomplete","both"),this.OJ.setAttribute("role","textbox"),this.OJ.setAttribute("aria-controls",this.LJ),"INPUT"===this.OJ.tagName&&(this.element.setAttribute("role","combobox"),this.OJ.setAttribute("aria-multiline","false")),this.element.setAttribute("aria-haspopup","listbox"),this.element.setAttribute("aria-expanded","false"),this.element.setAttribute("aria-owns",this.LJ);var i,e=this.DJ();e&&e.hasAttribute("autocomplete")&&(this.MJ=e.getAttribute("autocomplete")),this.qJ=this.getSsrTemplateHelper().isEnabled(),this.zJ=this.ty.hasTemplate(this.element,"template, script[template]"),this.qJ&&(L(this.AJ,'%s requires data to be provided via "src" attribute for server-side rendering. %s',xt,this.element),L(this.zJ,"".concat(xt,' should provide a <template> or <script type="plain/text"> element.')),L(!this.element.hasAttribute("filter"),"".concat(xt," does not support client-side filter when server-side render is required."))),this.aC=this.element.getAttribute("filter")||gt,L("substring"===(i=this.aC)||"prefix"===i||"token-prefix"===i||"fuzzy"===i||"custom"===i||"none"===i,"Unexpected filter: %s. %s",this.aC,this.element),this.EJ=this.element.hasAttribute("min-characters")?parseInt(this.element.getAttribute("min-characters"),10):1,this.element.hasAttribute("max-entries")&&z().warn(xt,'"max-items" attribute is preferred to "max-entries"');var r=this.element.getAttribute("max-items")||this.element.getAttribute("max-entries");return this.SJ=r?parseInt(r,10):null,this.yJ=this.Uo.shouldSuggestFirst(),this.UJ=this.element.hasAttribute("highlight-user-entry"),this.qn=this.FJ(),this.element.appendChild(this.qn),this.uA(),l()},u.uA=function(){var t=this;this.OJ.addEventListener("touchstart",(function(){t.GJ()}),{passive:!0}),this.OJ.addEventListener("input",(function(){t.HJ()})),this.OJ.addEventListener("keydown",(function(n){t.KJ(n)})),this.OJ.addEventListener("focus",(function(){t.GJ().then((function(){var n=t.Uo.shouldShowOnFocus();t.QJ(n)}))})),this.OJ.addEventListener("blur",(function(){t.QJ(!1)})),this.qn.addEventListener("mousedown",(function(n){t.VJ(n)}))},u.JJ=function(){var t=this.element.querySelectorAll("input,textarea");return L(1==t.length,"%s should contain exactly one <input> or <textarea> descendant %s",xt,this.element),t[0]},u.DJ=function(){return this.OJ.form||null},u.BJ=function(){return this.element.hasAttribute("inline")?new vt(this):new mt(this)},u.$J=function(t){var n=_(t.textContent,(function(t){throw t})),i=this.element.getAttribute("items")||"items",e=U(n,i);return e?z().assertArray(e):(z().warn(xt,'Expected key "%s" in data but found nothing. Rendering empty results.',i),[])},u.WJ=function(){var t=this,n=this.getAmpDoc(),i=this.element.getAttribute("items")||"items";return this.XJ(),this.qJ?bt(this.element,this.element.getAttribute("src"),2,!1).then((function(n){var e,r,u;n.xhrUrl=(e=t.win,r=n.xhrUrl,u=n.fetchOpt,A("string"==typeof r),!1!==u.ampCors&&(r=function(t,n){!function(t){var n=function(t){var n,i=E();if(!t)return i;for(;n=P.exec(t);){var e=C(n[1],n[1]),r=n[2]?C(n[2].replace(/\+/g," "),n[2]):"";i[e]=r}return i}(rt(t).search);L(!(it in n),"Source origin is not allowed in %s",t)}(n);var i=function(t){return rt(function(t){if(!function(t){return tt.cdnProxyRegex.test(et(t).origin)}(t=et(t)))return t.href;var n=t.pathname.split("/"),i=n[1];L(nt.has(i),"Unknown path prefix in url %s",t.href);var e=n[2],r="s"==e?"https://"+decodeURIComponent(n[3]):"http://"+decodeURIComponent(e);return L(r.indexOf(".")>0,"Expected a . in origin %s",r),n.splice(1,"s"==e?3:2),r+n.join("/")+function(t,n){if(!t||"?"==t)return"";var i=new RegExp("[?&]".concat("(amp_(js[^&=]*|gsa|r|kit)|usqp)","\\b[^&]*"),"g"),e=t.replace(i,"").replace(/^[?&]/,"");return e?"?"+e:""}(t.search)+(t.hash||"")}(t)).origin}(t.location.href);return ot(n,it,i)}(e,r)),r),n.fetchOpt=function(t,n,i){i=i||{};var e=function(t){return t.origin||rt(t.location.href).origin}(t);return e==rt(n).origin&&(i.headers=i.headers||{},i.headers["AMP-Same-Origin"]="true"),i}(t.win,n.xhrUrl,n.fetchOpt),function(t){var n=function(t,n){var i,e=t||{},r=e.credentials;return A(void 0===r||"include"==r||"omit"==r),e.method=void 0===(i=e.method)?"GET":(i=i.toUpperCase(),A(ct.includes(i)),i),e.headers=e.headers||{},e.headers.Accept=n,A(null!==e.body),e}(t,"application/json");if("POST"==n.method&&!W(n.body)){A(ht.some((function(t){return t(n.body)}))),n.headers["Content-Type"]=n.headers["Content-Type"]||"text/plain;charset=utf-8";var i=n.headers["Content-Type"];n.body="application/x-www-form-urlencoded"===i?function(t){var n,i=[];for(var e in t){var r=t[e];if(null!=r){r=g(n=r)?n:[n];for(var u=0;u<r.length;u++)i.push(ut(e,r[u]))}}return i.join("&")}(n.body):JSON.stringify(n.body)}}(n.fetchOpt);var o={"ampAutocompleteAttributes":{"items":i,"maxItems":t.SJ}};return t.getSsrTemplateHelper().ssr(t.element,n,null,o)})):function(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},e=i.expr,r=void 0===e?".":e,u=i.urlReplacement,o=void 0===u?0:u,s=i.refresh,a=void 0!==s&&s,c=i.xssiPrefix,h=void 0===c?void 0:c,f=i.url,l=void 0===f?n.getAttribute("src"):f;at(l,n);var p=K(t.win);return bt(n,l,o,a).then((function(t){return p.fetchJson(t.xhrUrl,t.fetchOpt)})).then((function(n){return Q(t.win).xssiJson(n,h)})).then((function(t){if(null==t)throw new Error("Response is undefined.");return U(t,r||".")})).catch((function(t){throw z().createError("failed fetching JSON data",t)}))}(n,this.element,{expr:i,urlReplacement:2}).catch((function(){return z().warn(xt,'Expected key "%s" in data but found nothing. Rendering empty results.',i),[]}))},u.XJ=function(){if(this._J){var t=this.YJ(this.RJ);this.element.setAttribute("src",t)}},u.YJ=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return ot(this.AJ,this._J,t)},u.FJ=function(){var t=this.element.ownerDocument.createElement("div");return t.classList.add("i-amphtml-autocomplete-results"),this.ZJ()&&t.classList.add("i-amphtml-autocomplete-results-up"),t.setAttribute("role","listbox"),t.setAttribute("id",this.LJ),k(t,!1),t},u.layoutCallback=function(){return this.OJ.setAttribute("autocomplete","off"),this.element.hasAttribute("prefetch")&&this.GJ(),this.UB(this.jJ,this.RJ)},u.mutatedAttributesCallback=function(t){var n=this,i=t.src;return null==i?l():"string"==typeof i?(this.AJ=i,this.WJ().then((function(t){n.jJ=t||[],n.UB(n.jJ,n.RJ)}),(function(t){n.JB(t)}))):"object"===m(i)?(this.jJ=i.items||[],this.UB(this.jJ,this.RJ)):void z().error(xt,'Unexpected "src" type: '+i)},u.$B=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=this.element.ownerDocument.createElement("div");i.classList.add("i-amphtml-autocomplete-item"),i.setAttribute("role","option"),i.setAttribute("data-value",t),i.setAttribute("dir","auto"),i.textContent=t;var e=i.childNodes[0],r=t.toLocaleLowerCase(),u=n.toLocaleLowerCase();if(this.UJ&&n&&n.length<=t.length&&w(r,u)){var o=r.indexOf(u),s=this.element.ownerDocument.createElement("span");s.classList.add("autocomplete-partial"),s.appendChild(this.element.ownerDocument.createTextNode(t.slice(o,o+n.length)));var a=e.splitText(o);a.splitText(n.length),i.replaceChild(s,a)}return i},u.HJ=function(){var t=this;return this.Uo.shouldAutocomplete(this.OJ)?this.GB():this.mutateElement((function(){t.HB()}))},u.GB=function(){var t=this,n=0===this.RJ.length&&1===this.OJ.value.length;return this.RJ=this.Uo.getUserInputForUpdate(this.OJ),(this.qJ||this._J?this.WJ():Promise.resolve(this.jJ)).then((function(i){return t.jJ=i,t.mutateElement((function(){t.UB(t.jJ,t.RJ).then((function(){t.KB(n)}))}))}))},u.KB=function(t){this.QB(!0),this.yJ&&(this.TJ&&!t||this.VB(1),this.TJ=!1)},u.VJ=function(t){var n=this,i=t.target,e=this.WB(i),r=this.XB(e),u=r.selectedObject,o=r.selectedText;return this.mutateElement((function(){n.YB(o,u)}))},u.UB=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return this.HB(),!t||n.length<this.EJ?l():this.qJ?S(t,"html")?this.ZB(t,this.qn,n):l():this.t$(t,n)},u.t$=function(t,n){if(!t.length)return l();var i=this.n$(t,n).map((function(t){var n=t;return"object"===m(t)&&(n=v(v({},t),{},{objToJson:function(){return JSON.stringify(t)}})),n}));return this.ZB(i,this.qn,n)},u.ZB=function(t,n,i){var e=this,r=l();return this.i$(),this.zJ?r=this.getSsrTemplateHelper().applySsrOrCsrTemplate(this.element,t).then((function(t){(g(t)?t:[t]).forEach((function(t){t.hasAttribute("data-disabled")?t.setAttribute("aria-disabled","true"):t.hasAttribute("data-value")||z().warn(xt,'Expected a "data-value" or "data-disabled" attribute on the rendered template item. %s',t),t.classList.add("i-amphtml-autocomplete-item"),t.setAttribute("role","option"),n.appendChild(t)}))})):t.forEach((function(t){L("string"==typeof t,"%s data must provide template for non-string items. %s",xt,e.element),n.appendChild(e.$B(t,i))})),r},u.n$=function(t,n){var i=this;if(this.aC===gt)return this.e$(t);n=n.toLocaleLowerCase();var e=this.element.getAttribute("filter-value")||"value",r=t.filter((function(t){switch("object"===m(t)&&(t=U(t,e)),L("string"==typeof t,'%s data property "%s" must map to string type. %s',xt,e,i.element),t=t.toLocaleLowerCase(),i.aC){case"substring":return w(t,n);case"prefix":return t.startsWith(n);case"token-prefix":return i.r$(t,n);case"fuzzy":return(0,dt.default)(n,t);case"custom":throw new Error("Filter not yet supported: %s",i.aC,i.element);default:throw new Error("Unexpected filter: %s",i.aC,i.element)}}));return this.e$(r)},u.r$=function(t,n){if(""===n)return!0;var i=this.u$(t),e=this.u$(n),r=this.o$(i),u=e[e.length-1];e.splice(e.length-1,1);for(var o=!0,s=0;s<e.length;s++){var a=e[s];if(""!==a){if(!S(r,a)){o=!1;break}var c=Number(T(r,a));c>1?r[a]=c-1:delete r[a]}}var h=Object.keys(r);return o&&(""===u||h.some((function(t){return t.startsWith(u)})))},u.u$=function(t){return(t=t.replace(/[\.]+/g,"")).split(/[`~(){}_|+\-;:\'",\[\]\\\/ ]+/g)},u.o$=function(t){var n=E();return t.forEach((function(t){var i=S(n,t)?T(n,t)+1:1;n[t]=i})),n},u.e$=function(t){return this.SJ&&this.SJ<t.length&&(t=t.slice(0,this.SJ)),t},u.QB=function(t){this.OJ.setAttribute("aria-expanded",t),k(this.qn,t)},u.QJ=function(t){var n=this,i=this.DJ();i&&(t?i.setAttribute("autocomplete","off"):this.MJ?i.setAttribute("autocomplete",this.MJ):i.removeAttribute("autocomplete"));var e=!1;return this.measureMutateElement((function(){e=n.ZJ()}),(function(){t||(n.RJ=n.OJ.value,n.UB(n.jJ,n.RJ),n.i$()),n.s$(e),n.QB(t)}))},u.GJ=function(){var t=this;return this.NJ||!this.element.hasAttribute("src")?l():(this.NJ=!0,this.WJ().then((function(n){t.jJ=n,t.UB(t.jJ)}),(function(n){t.JB(n)})))},u.s$=function(t){this.qn.classList.toggle("i-amphtml-autocomplete-results-up",t)},u.ZJ=function(){var t=this.Pu.getHeight()||0;return this.OJ.getBoundingClientRect().top>t/2},u.a$=function(){return!this.qn.hasAttribute("hidden")&&this.qn.children.length>0},u.WB=function(t){return null===t?null:t.classList.contains("i-amphtml-autocomplete-item")?t:this.WB(t.parentElement)},u.XB=function(t){if(null===t||t.hasAttribute("data-disabled"))return{selectedObject:null,selectedText:null};var n=this.c$(t);return this.h$(n),{selectedObject:this.f$(t),selectedText:n}},u.h$=function(t){this.OJ.value=this.Uo.getUserInputForUpdateWithSelection(t,this.OJ,this.RJ),this.RJ=this.Uo.getUserInputForUpdate(this.OJ)},u.c$=function(t){return t.getAttribute("data-value")||t.textContent||""},u.f$=function(t){return t.hasAttribute("data-json")?_(t.getAttribute("data-json"),(function(t){throw t})):null},u.YB=function(t,n){null!==t&&(this.l$(t,n),this.HB(),this.QB(!1))},u.l$=function(t,n){var i="select",e=v({value:t},n&&{valueAsObject:n}),r=V(this.win,"amp-autocomplete.".concat(i),e);this.Ks.trigger(this.element,i,r,3);var u=V(this.win,"change",e,{bubbles:!0});this.OJ.dispatchEvent(u)},u.VB=function(t){var n=this;if(0===t||!this.a$()||this.CJ)return l();var i=-1===this.IJ&&t<0?t:this.IJ+t,e=this.p$();if(0===e.length)return l();var r,u,o,s,a=(r=i,u=e.length,r>0&&u>0?r%u:(r%u+u)%u),c=e[a],h=c.getAttribute("data-value");return this.Uo.displayActiveItemInInput(this.OJ,h,this.RJ),this.measureMutateElement((function(){var i=c.offsetHeight,e=c.offsetTop,r=n.qn,u=r.offsetHeight,a=r.scrollTop;o=a>e||a+u<e+i,s=t>0?e+i-u:e}),(function(){o&&(n.qn.scrollTop=s),n.i$(),c.classList.add("i-amphtml-autocomplete-item-active"),c.setAttribute("aria-selected","true");var t=c.getAttribute("id");t||(t=n.PJ+"_AMP_content_"+a,c.setAttribute("id",t)),n.OJ.setAttribute("aria-activedescendant",t),n.IJ=a,n.kJ=c,I(n.kJ)}))},u.p$=function(){return this.qn.querySelectorAll(".i-amphtml-autocomplete-item:not([data-disabled])")},u.d$=function(){this.Uo.resetInputOnWrapAround(this.RJ,this.OJ),this.i$()},u.i$=function(){this.kJ&&(this.kJ.classList.toggle("i-amphtml-autocomplete-item-active",!1),this.kJ.removeAttribute("aria-selected"),"autocomplete-selected"===this.kJ.getAttribute("id")&&this.kJ.removeAttribute("id"),this.OJ.removeAttribute("aria-activedescendent"),this.kJ=null,this.IJ=-1)},u.HB=function(){this.CJ=!1,function(t){for(;t.firstChild;)t.removeChild(t.firstChild)}(this.qn)},u.KJ=function(t){var n=this;switch(t.key){case"ArrowDown":return t.preventDefault(),this.a$()?this.IJ===this.p$().length-1?(this.d$(),l()):this.VB(1):this.mutateElement((function(){n.UB(n.jJ,n.RJ),n.QB(!0)}));case"ArrowUp":return t.preventDefault(),0===this.IJ?(this.d$(),l()):this.VB(-1);case"Enter":var i=this.Uo.shouldPreventDefaultOnEnter(!!this.kJ);if(this.a$()&&i&&t.preventDefault(),this.Uo.removeSelectionHighlighting(this.OJ),this.a$()&&this.kJ){var e=this.XB(this.kJ),r=e.selectedObject,u=e.selectedText;return this.mutateElement((function(){n.YB(u,r),n.i$()}))}return this.mutateElement((function(){n.QB(!1)}));case"Escape":return this.mutateElement((function(){n.CJ||(t.preventDefault(),n.d$(),n.QB(!1))}));case"Tab":if(this.a$()&&this.kJ){t.preventDefault();var o=this.XB(this.kJ),s=o.selectedObject,a=o.selectedText;return this.mutateElement((function(){n.YB(a,s)}))}return l();case"Backspace":return this.TJ=this.yJ,l();default:return l()}},u.JB=function(t){if(!this.CJ){if(this.HB(),!this.getFallback())throw t;this.CJ=!0,this.toggleFallback(!0)}},u.isLayoutSupported=function(t){return"container"==t},r}(t.BaseElement);t.registerElement(xt,wt,"amp-autocomplete,amp-autocomplete>input,amp-autocomplete>textarea{font-family:sans-serif}amp-autocomplete>input,amp-autocomplete>textarea{border-radius:4px;box-sizing:border-box}.i-amphtml-autocomplete-results{position:absolute;top:100%;width:calc(100% + 1rem);min-width:calc(2em + 2rem);max-height:40vh;margin-top:.5rem;margin-left:-.5rem;border-radius:4px;overflow-y:auto;overflow-x:hidden;background-color:#fff;box-shadow:0px 2px 4px 0px rgba(0,0,0,.5);z-index:10}.i-amphtml-autocomplete-results-up{top:auto;bottom:100%;margin-bottom:.5rem}.i-amphtml-autocomplete-item{position:relative;padding:.5rem 1rem;cursor:pointer}.i-amphtml-autocomplete-item:first-child{border-radius:4px 4px 0px 0px}.i-amphtml-autocomplete-item:nth-last-child(2){border-radius:0px 0px 4px 4px}.i-amphtml-autocomplete-item-active:not([data-disabled]),.i-amphtml-autocomplete-item:hover:not([data-disabled]){background-color:rgba(0,0,0,.15)}.i-amphtml-autocomplete-item[data-disabled]{color:rgba(0,0,0,.33)}\n/*# sourceURL=/extensions/amp-autocomplete/0.1/amp-autocomplete.css*/")}();
/*! https://mths.be/cssescape v1.5.1 by @mathias | MIT license */}});
//# sourceMappingURL=amp-autocomplete-0.1.js.map