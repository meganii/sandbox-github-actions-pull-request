;
(self.AMP=self.AMP||[]).push({m:1,v:"2301041800000",n:"amp-onetap-google",ev:"0.1",l:!0,f:function(t,e){(()=>{var e,{hasOwnProperty:n,toString:r}=Object.prototype,i=["Webkit","webkit","Moz","moz","ms","O","o"];function s(t,e){void 0===e&&(e=t.hasAttribute("hidden")),e?t.removeAttribute("hidden"):t.setAttribute("hidden","")}self.__AMP_LOG=self.__AMP_LOG||{user:null,dev:null,userForEmbed:null};var o=self.__AMP_LOG;function u(t){return function(t,e){throw new Error("failed to call initLogConstructor")}()}function l(t,e,n,r,i,s,o,u,l,c,a){return t}function c(t,e,n,r,i,s,l,c,a,h,f){return(o.user||(o.user=u()),void o.user.win?o.userForEmbed||(o.userForEmbed=u()):o.user).assert(t,e,n,r,i,s,l,c,a,h,f)}function a(t,e){return d(t=function(t){return t.__AMP_TOP||(t.__AMP_TOP=t)}(t),e)}function h(t,e){const n=p(m(t));return g(n,e)?d(n,e):null}function f(t,e){return _(p(t),e)}function m(t){return t.nodeType?(n=t,e=(n.ownerDocument||n).defaultView,a(e,"ampdoc")).getAmpDoc(t):t;var e,n}function p(t){const e=m(t);return e.isSingleDoc()?e.win:e}function d(t,e){l(g(t,e));const n=v(t)[e];return n.obj||(l(n.ctor),l(n.context),n.obj=new n.ctor(n.context),l(n.obj),n.context=null,n.resolve&&n.resolve(n.obj)),n.obj}function _(t,e){const n=v(t)[e];return n?n.promise?n.promise:(d(t,e),n.promise=Promise.resolve(n.obj)):null}function v(t){let e=t.__AMP_SERVICES;return e||(e=t.__AMP_SERVICES={}),e}function g(t,e){const n=t.__AMP_SERVICES&&t.__AMP_SERVICES[e];return!(!n||!n.ctor)}var b,A,P=t=>function(t,e,n,r){const i=f(t,e);if(i)return i;const s=m(t);return s.whenExtensionsKnown().then((()=>{const t=s.getExtensionVersion(n);return t?a(s.win,"extensions").waitForExtension(n,t):null})).then((n=>n?function(t,e){return function(t,e){const n=_(t,e);if(n)return n;const r=v(t);return r[e]=function(){const t=new class{constructor(){this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}},{promise:e,reject:n,resolve:r}=t;return e.catch((()=>{})),{obj:null,promise:e,resolve:r,reject:n,context:null,ctor:null}}(),r[e].promise}(p(t),e)}(t,e):null))}(t,"subscriptions","amp-subscriptions");function I(t,e,n,r){return function(t,e,n,r){let i=t,s=n,o=t=>{try{return s(t)}catch(t){var e,n;throw null===(e=(n=self).__AMP_REPORT_ERROR)||void 0===e||e.call(n,t),t}};const u=function(){if(void 0!==b)return b;b=!1;try{const t={get capture(){return b=!0,!1}};self.addEventListener("test-options",null,t),self.removeEventListener("test-options",null,t)}catch(t){}return b}(),l=!(null==r||!r.capture);return i.addEventListener(e,o,u?r:l),()=>{null==i||i.removeEventListener(e,o,u?r:l),s=null,i=null,o=null}}(t,e,n,r)}new Set(["c","v","a","ad"]);var w="onetap_google",M=class extends t.BaseElement{constructor(t){super(t),this.Lv=null,this.g7=!0,this.O_=null}isLayoutSupported(t){return"nodisplay"==t}buildCallback(){this.getAmpDoc().whenFirstVisible().then((()=>{this.b7(function(t,e,n="source"){var r;return c(null!=t,"%s %s must be available",e,n),c("https:"==(r=(t=>"string"==typeof t?function(t,e){return A||(A=self.document.createElement("a")),function(t,e,n){return t.href="",new URL(e,t.href)}(A,t)}(t):t)(r=t)).protocol||"localhost"==r.hostname||"127.0.0.1"==r.hostname||function(t,e){const n=t.length-e.length;return n>=0&&t.indexOf(e,n)==n}(r.hostname,".localhost")||/^\/\//.test(t),'%s %s must start with "https://" or "//" or be relative and served from either https or from localhost. Invalid value: %s',e,n,t),t}(this.element.dataset.src,this.element))}))}gA(t,e,n){t.postMessage(e,n)}P7(t,n){if(!this.Lv)return;if(n.source!=this.Lv.contentWindow||n.origin!==t)return;const o=function(t){return t.data}(n);var u;if(u=o,"[object Object]"===r.call(u)&&o.sentinel==w)switch(o.command){case"intermediate_iframe_ready":const t=o.nonce;if(!t)return;this.gA(n.source,{"sentinel":w,"command":"parent_frame_ready","nonce":t},n.origin);break;case"intermediate_iframe_resize":const r=o.height;"number"==typeof r&&!isNaN(r)&&r>0&&this.mutateElement((()=>{s(this.element,r>0),function(t,n,r,s,o){const u=function(t,n,r){if(n.startsWith("--"))return n;e||(e=Object.create(null));let s=e[n];if(!s||r){if(s=n,void 0===t[n]){const e=function(t){return t.charAt(0).toUpperCase()+t.slice(1)}(n),r=function(t,e){for(let n=0;n<i.length;n++){const r=i[n]+e;if(void 0!==t[r])return r}return""}(t,e);void 0!==t[r]&&(s=r)}r||(e[n]=s)}return s}(t.style,"height",void 0);if(!u)return;const l=r;t.style.setProperty(function(t){const e=t.replace(/[A-Z]/g,(t=>"-"+t.toLowerCase()));return i.some((t=>e.startsWith(t+"-")))?`-${e}`:e}(u),l)}(this.Lv,0,function(t){return`${t}px`}(o.height))}));break;case"intermediate_iframe_close":this.mutateElement((()=>{this.bA()}));break;case"intermediate_iframe_done":this.mutateElement((()=>{this.bA(),this.I7()}));break;case"set_ui_mode":const u=o.mode;if(!u)return;this.M7(u);break;case"set_tap_outside_mode":this.g7=!!o.cancel}}M7(t){this.mutateElement((()=>{this.Lv.classList.add(`i-amphtml-onetap-google-ui-${t}`)}))}I7(){Promise.all([this.x7(),this.k7()]).then((t=>{t.reduce(((t,e)=>t||e))}))}x7(){const t=this.getAmpDoc().getElementById("amp-access");return!!t&&((e=this.element,h(e,"action")).execute(t,"refresh",null,null,null,null,2),!0);var e}k7(){return P(this.element).then((t=>!!t&&(t.resetPlatforms(),!0)))}b7(t){var e;this.Lv||(this.Lv=this.getAmpDoc().win.document.createElement("iframe"),(e=this.element,h(e,"url-replace")).expandUrlAsync(t).then((t=>{this.win&&this.vv(t)})))}vv(t){l(this.Lv),s(this.element,!1);const{origin:e}=(n=this.element,h(n,"url")).parse(t);var n;this.O_=[I(this.win,"message",(t=>{this.P7(e,t)})),I(this.getAmpDoc().getRootNode(),"click",(()=>{this.g7&&!this.element.hasAttribute("hidden")&&this.bA()}))],this.Lv.classList.add("i-amphtml-onetap-google-iframe"),this.Lv.src=t,this.element.appendChild(this.Lv),this.getViewport().addToFixedLayer(this.Lv)}bA(){var t,e;if(this.Lv&&(s(this.element,!1),null===(e=(t=this.Lv).parentElement)||void 0===e||e.removeChild(t),this.Lv=null,this.O_))for(;this.O_.length>0;)this.O_.pop()()}};t.registerElement("amp-onetap-google",M,".i-amphtml-onetap-google-iframe{z-index:2147483647;border:none;position:fixed}.i-amphtml-onetap-google-ui-card{width:391px;right:20px;top:20px}.i-amphtml-onetap-google-ui-bottom_sheet{right:auto;left:0;top:auto;bottom:0;width:100%}\n/*# sourceURL=/extensions/amp-onetap-google/0.1/amp-onetap-google.css*/")})();
/*! https://mths.be/cssescape v1.5.1 by @mathias | MIT license */}});
//# sourceMappingURL=amp-onetap-google-0.1.mjs.map