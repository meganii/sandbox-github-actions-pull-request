{"version":3,"file":"amp-vk-0.1.mjs","mappings":"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","names":["isArray","Array","hasOwnProperty","hasOwn_","toString","toString_","Object","prototype","self","__AMP_LOG","user","dev","userForEmbed","logs","suffix","levelFunc","opt_suffix","Error","callLogConstructor","shouldBeTrueish","opt_message","opt_1","opt_2","opt_3","opt_4","opt_5","opt_6","opt_7","opt_8","opt_9","getUserLogger","win","assert","id","getServiceInternal","__AMP_TOP","getTopWindow","nodeOrDoc","nodeType","node","ownerDocument","defaultView","getService","getAmpDoc","holder","devAssert","service","__AMP_SERVICES","ctor","isServiceRegistered","s","services","getServices","obj","context","resolve","optsSupported","Services","elementOrAmpDoc","ampdoc","getAmpdoc","isSingleDoc","getAmpdocServiceHolder","getServiceForDoc","url","paramString","opt_addToFront","mainAndFragment","split","mainAndQuery","newUrl","params","appendEncodedParamStringToUrl","k","v","arrayOrSingleItem","i","length","push","key","value","encodeURIComponent","join","serializeQueryString","Set","EmbedType","AmpVk","AMP","BaseElement","constructor","element","super","this","iframe_","widgetHeight_","unlistenMessage_","embedType_","ownerId_","postId_","hash_","apiId_","pollId_","preconnectCallback","opt_onLayout","window","getIFrameSrc_","createdTime","Date","now","iframeSrcPromise","getVkPostIFrameSrc_","getVkPollIFrameSrc_","then","iframeSrc","getReferrerUrl","ref","startWidth","offsetWidth","pageUrl","getUrl","addParamsToUrl","app","width","_ver","owner_id","post_id","hash","amp","referrer","title","poll_id","description","buildCallback","userAssert","getAttribute","postBuildCallback_","pollBuildCallback_","layoutCallback","iframe","createElement","eventType","listener","opt_evtListenerOpts","localElement","localListener","wrapped","event","e","__AMP_REPORT_ERROR","undefined","options","capture","addEventListener","removeEventListener","err","detectEvtListenerOptsSupport","internalListenImplementation","handleVkIframeMessage_","bind","src","setAttribute","classList","add","appendChild","loadPromise","origin","source","contentWindow","eventData","data","matches","exec","newHeight","parseInt","forceChangeHeight","isLayoutSupported","layout","unlayoutOnPause","unlayoutCallback","_element$parentElemen","parentElement","removeChild","registerElement"],"sourceRoot":"https://raw.githubusercontent.com/ampproject/amphtml/2301041800000/","sources":["src/core/types/array.js","src/core/types/object/index.js","src/utils/log.js","src/service-helpers.js","src/core/window/index.js","src/service/index.js","src/core/dom/event-helper-listen.js","src/url.js","extensions/amp-vk/0.1/amp-vk.js","src/utils/event-helper.js","src/core/dom/layout/index.js","src/core/dom/index.js"]}
