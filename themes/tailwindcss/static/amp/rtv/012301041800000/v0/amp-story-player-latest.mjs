;
(self.AMP=self.AMP||[]).push({m:1,v:"2301041800000",n:"amp-story-player",ev:"0.1",l:!0,f:function(t,i){(()=>{var i;function s(){return i||(i=Promise.resolve(void 0))}var e=class{constructor(){this.promise=new Promise(((t,i)=>{this.resolve=t,this.reject=i}))}},{isArray:r}=Array;function n(t,i){for(let s=0;s<t.length;s++)if(i(t[s],s,t))return s;return-1}var{hasOwnProperty:o,toString:a}=Object.prototype;function h(t){const i=Object.create(null);return t&&Object.assign(i,t),i}function l(t,i){return t}function c(t,i,s){return i in t?Object.defineProperty(t,i,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[i]=s,t}function p(t,i){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(t);i&&(e=e.filter((function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable}))),s.push.apply(s,e)}return s}function u(t){for(var i=1;i<arguments.length;i++){var s=null!=arguments[i]?arguments[i]:{};i%2?p(Object(s),!0).forEach((function(i){c(t,i,s[i])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):p(Object(s)).forEach((function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(s,i))}))}return t}var f="ase art bmp blp cd5 cit cpt cr2 cut dds dib djvu egt exif gif gpl grf icns ico iff jng jpeg jpg jfif jp2 jps lbm max miff mng msp nitf ota pbm pc1 pc2 pc3 pcf pcx pdn pgm PI1 PI2 PI3 pict pct pnm pns ppm psb psd pdd psp px pxm pxr qfx raw rle sct sgi rgb int bw tga tiff tif vtf xbm xcf xpm 3dv amf ai awg cgm cdr cmx dxf e2d egt eps fs gbr odg svg stl vrml x3d sxd v2d vnd wmf emf art xar png webp jxr hdp wdp cur ecw iff lbm liff nrrd pam pcx pgf sgi rgb rgba bw int inta sid ras sun tga".split(" "),m="### #gf $on $tf 0b 8m 8u 12u 15u 64c 075 75 085 85 91 091 096 96 abf acfm acs afm afn afs all amfm apf asf aspf atm auf b30 bco bdf bepf bez bfn bmap bmf bx bzr cbtf cct cef cff cfn cga ch4 cha chm chr chx claf collection compositefont dfont dus dzk eft eot etx euf f00 f06 f08 f09 f3f f10 f11 f12 f13 f16 fd fdb ff ffil flf fli fn3 fnb fnn fnt fnta fo1 fo2 fog fon font fonts fot frf frs ftm fxr fyi gdr gf gft glf glif glyphs gsf gxf hbf ice intellifont lepf lft lwfn mcf mcf mfd mfm mft mgf mmm mrf mtf mvec nlq ntf odttf ofm okf otf pcf pcf pfa pfb pfm pft phf pk pkt prs pss qbf qfn r8? scr sfd sff sfi sfl sfn sfo sfp sfs sif snf spd spritefont sui suit svg sxs t1c t2 tb1 tb2 tdf tfm tmf tpf ttc tte ttf type ufm ufo usl usp us? vf vf1 vf3 vfb vfm vfont vlw vmf vnf w30 wfn wnf woff woff2 xfc xfn xfr xft zfi zsu _v".split(" "),d="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function y(t,i){if(i=i.split(":")[0],!(t=+t))return!1;switch(i){case"http":case"ws":return 80!==t;case"https":case"wss":return 443!==t;case"ftp":return 21!==t;case"gopher":return 70!==t;case"file":return!1}return 0!==t}var _=Object.prototype.hasOwnProperty;function g(t){try{return decodeURIComponent(t.replace(/\+/g," "))}catch(t){return null}}var v={stringify:function(t,i){i=i||"";var s,e=[];for(r in"string"!=typeof i&&(i="?"),t)if(_.call(t,r)){(s=t[r])||null!=s&&!isNaN(s)||(s="");var r=encodeURIComponent(r);s=encodeURIComponent(s),null!==r&&null!==s&&e.push(r+"="+s)}return e.length?i+e.join("&"):""},parse:function(t){for(var i,s=/([^=?&]+)=?([^&]*)/g,e={};i=s.exec(t);){var r=g(i[1]);i=g(i[2]),null===r||null===i||r in e||(e[r]=i)}return e}},b=/^[A-Za-z][A-Za-z0-9+-.]*:[\\/]+/,P=/^([a-z][a-z0-9.+-]*:)?([\\/]{1,})?([\S\s]*)/i,A=/^[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+/;function w(t){return(t||"").toString().replace(A,"")}var E=[["#","hash"],["?","query"],function(t){return t.replace("\\","/")},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d+)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],x={hash:1,query:1};function M(t){var i=("undefined"!=typeof window?window:void 0!==d?d:"undefined"!=typeof self?self:{}).location||{};t=t||i,i={};var s,e=typeof t;if("blob:"===t.protocol)i=new I(unescape(t.pathname),{});else if("string"===e)for(s in i=new I(t,{}),x)delete i[s];else if("object"===e){for(s in t)s in x||(i[s]=t[s]);void 0===i.slashes&&(i.slashes=b.test(t.href))}return i}function T(t){return t=w(t),{protocol:(t=P.exec(t))[1]?t[1].toLowerCase():"",slashes:!!(t[2]&&2<=t[2].length),rest:t[2]&&1===t[2].length?"/"+t[3]:t[3]}}function I(t,i,s){if(t=w(t),!(this instanceof I))return new I(t,i,s);var e=E.slice(),r=typeof i,n=0;"object"!==r&&"string"!==r&&(s=i,i=null),s&&"function"!=typeof s&&(s=v.parse),i=M(i);var o=T(t||"");for(r=!o.protocol&&!o.slashes,this.slashes=o.slashes||r&&i.slashes,this.protocol=o.protocol||i.protocol||"",t=o.rest,o.slashes||(e[3]=[/(.*)/,"pathname"]);n<e.length;n++)if("function"==typeof(o=e[n]))t=o(t);else{var a=o[0],h=o[1];a!=a?this[h]=t:"string"==typeof a?~(a=t.indexOf(a))&&("number"==typeof o[2]?(this[h]=t.slice(0,a),t=t.slice(a+o[2])):(this[h]=t.slice(a),t=t.slice(0,a))):(a=a.exec(t))&&(this[h]=a[1],t=t.slice(0,a.index)),this[h]=this[h]||r&&o[3]&&i[h]||"",o[4]&&(this[h]=this[h].toLowerCase())}if(s&&(this.query=s(this.query)),r&&i.slashes&&"/"!==this.pathname.charAt(0)&&(""!==this.pathname||""!==i.pathname)){if(t=this.pathname,i=i.pathname,""!==t){for(s=(i=(i||"/").split("/").slice(0,-1).concat(t.split("/")))[(t=i.length)-1],e=!1,n=0;t--;)"."===i[t]?i.splice(t,1):".."===i[t]?(i.splice(t,1),n++):n&&(0===t&&(e=!0),i.splice(t,1),n--);e&&i.unshift(""),"."!==s&&".."!==s||i.push(""),i=i.join("/")}this.pathname=i}"/"!==this.pathname.charAt(0)&&this.hostname&&(this.pathname="/"+this.pathname),y(this.port,this.protocol)||(this.host=this.hostname,this.port=""),this.username=this.password="",this.auth&&(o=this.auth.split(":"),this.username=o[0]||"",this.password=o[1]||""),this.origin=this.protocol&&this.host&&"file:"!==this.protocol?this.protocol+"//"+this.host:"null",this.href=this.toString()}I.prototype={set:function(t,i,s){switch(t){case"query":"string"==typeof i&&i.length&&(i=(s||v.parse)(i)),this[t]=i;break;case"port":this[t]=i,y(i,this.protocol)?i&&(this.host=this.hostname+":"+i):(this.host=this.hostname,this[t]="");break;case"hostname":this[t]=i,this.port&&(i+=":"+this.port),this.host=i;break;case"host":this[t]=i,/:\d+$/.test(i)?(i=i.split(":"),this.port=i.pop(),this.hostname=i.join(":")):(this.hostname=i,this.port="");break;case"protocol":this.protocol=i.toLowerCase(),this.slashes=!s;break;case"pathname":case"hash":i?(s="pathname"===t?"/":"#",this[t]=i.charAt(0)!==s?s+i:i):this[t]=i;break;default:this[t]=i}for(t=0;t<E.length;t++)(i=E[t])[4]&&(this[i[1]]=this[i[1]].toLowerCase());return this.origin=this.protocol&&this.host&&"file:"!==this.protocol?this.protocol+"//"+this.host:"null",this.href=this.toString(),this},toString:function(t){t&&"function"==typeof t||(t=v.stringify);var i=this.protocol;return i&&":"!==i.charAt(i.length-1)&&(i+=":"),i+=this.slashes?"//":"",this.username&&(i+=this.username,this.password&&(i+=":"+this.password),i+="@"),i+=this.host+this.pathname,(t="object"==typeof this.query?t(this.query):this.query)&&(i+="?"!==t.charAt(0)?"?"+t:t),this.hash&&(i+=this.hash),i}},I.extractProtocol=T,I.location=M,I.trimLeft=w,I.qs=v;var R=I,S=/^xn--/,V=/[^\0-\x7E]/,k=/[\x2E\u3002\uFF0E\uFF61]/g,z={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},j=Math.floor,O=String.fromCharCode;function F(t){throw new RangeError(z[t])}function q(t,i){var s=t.split("@");let e="";1<s.length&&(e=s[0]+"@",t=s[1]);{s=[];let e=(t=(t=t.replace(k,".")).split(".")).length;for(;e--;)s[e]=i(t[e]);i=s}return e+i.join(".")}function $(t,i){return t+22+75*(26>t)-((0!=i)<<5)}function U(t,i,s){let e=0;for(t=s?j(t/700):t>>1,t+=j(t/i);455<t;e+=36)t=j(t/35);return j(e+36*t/(t+38))}var C=function(t){return q(t,(function(t){return S.test(t)?function(t){const i=[],s=t.length;let e=0,r=128,n=72;var o=t.lastIndexOf("-");0>o&&(o=0);for(var a=0;a<o;++a)128<=t.charCodeAt(a)&&F("not-basic"),i.push(t.charCodeAt(a));for(o=0<o?o+1:0;o<s;){a=e;for(let i=1,r=36;;r+=36){o>=s&&F("invalid-input");var h=t.charCodeAt(o++);(36<=(h=10>h-48?h-22:26>h-65?h-65:26>h-97?h-97:36)||h>j((2147483647-e)/i))&&F("overflow"),e+=h*i;const a=r<=n?1:r>=n+26?26:r-n;if(h<a)break;i>j(2147483647/(h=36-a))&&F("overflow"),i*=h}n=U(e-a,h=i.length+1,0==a),j(e/h)>2147483647-r&&F("overflow"),r+=j(e/h),e%=h,i.splice(e++,0,r)}return String.fromCodePoint(...i)}(t.slice(4).toLowerCase()):t}))},D=/[A-Za-z\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u02b8\u0300-\u0590\u0800-\u1fff\u200e\u2c00-\ufb1c\ufe00-\ufe6f\ufefd-\uffff]/,N=/[\u0591-\u06ef\u06fa-\u07ff\u200f\ufb1d-\ufdff\ufe70-\ufefc]/;function L(t){return(t="undefined"!=typeof window?function(t){return t=new TextEncoder("utf-8").encode(t),window.crypto.subtle.digest("SHA-256",t).then((t=>{var i=[];t=new DataView(t);for(let s=0;s<t.byteLength;s+=4){let e=("00000000"+t.getUint32(s).toString(16)).slice(-8);i.push(e)}return i.join("")}))}(t):void 0).then((t=>function(t){let i=[];t.match(/.{1,2}/g).forEach(((t,s)=>{i[s]=parseInt(t,16)}));var s=i.length%5,e=Math.floor(i.length/5);if(t=[],0!=s){for(var r=0;r<5-s;r++)i+="\0";e+=1}for(r=0;r<e;r++)t.push("abcdefghijklmnopqrstuvwxyz234567".charAt(i[5*r]>>3)),t.push("abcdefghijklmnopqrstuvwxyz234567".charAt((7&i[5*r])<<2|i[5*r+1]>>6)),t.push("abcdefghijklmnopqrstuvwxyz234567".charAt((63&i[5*r+1])>>1)),t.push("abcdefghijklmnopqrstuvwxyz234567".charAt((1&i[5*r+1])<<4|i[5*r+2]>>4)),t.push("abcdefghijklmnopqrstuvwxyz234567".charAt((15&i[5*r+2])<<1|i[5*r+3]>>7)),t.push("abcdefghijklmnopqrstuvwxyz234567".charAt((127&i[5*r+3])>>2)),t.push("abcdefghijklmnopqrstuvwxyz234567".charAt((3&i[5*r+3])<<3|i[5*r+4]>>5)),t.push("abcdefghijklmnopqrstuvwxyz234567".charAt(31&i[5*r+4]));for(e=0,1==s?e=6:2==s?e=4:3==s?e=3:4==s&&(e=1),s=0;s<e;s++)t.pop();for(s=0;s<e;s++)t.push("=");return t.join("")}("ffffffffff"+t+"000000").substr(8,Math.ceil(4*t.length/5))))}function Y(t){return"--"==t.slice(2,4)&&"xn"!=t.slice(0,2)}function H(t,i,s=null){let e=new R(i),r=function(t,i=null){return(t=>f.some((i=>!!t.endsWith(`.${i}`))))(t)?"/i":(t=>m.some((i=>!!t.endsWith(`.${i}`))))(t)?"/r":"viewer"===i?"/v":"/c"}(e.pathname,s);return r+="https:"===e.protocol?"/s/":"/",i.endsWith("/")||(e.pathname=e.pathname.replace(/\/$/,"")),function(t){if(Y(t=new R(t).hostname))var i=!1;else i=C(t),i=63>=t.length&&!(D.test(i)&&N.test(i))&&-1!=t.indexOf(".");return i?63<(i=function(t){return q(t,(function(t){return V.test(t)?"xn--"+function(t){const i=[];let s=(t=function(t){let i=[],s=0,e=t.length;for(;s<e;){let r=t.charCodeAt(s++);if(55296<=r&&56319>=r&&s<e){let e=t.charCodeAt(s++);56320==(64512&e)?i.push(((1023&r)<<10)+(1023&e)+65536):(i.push(r),s--)}else i.push(r)}return i}(t)).length,e=128,r=0,n=72;for(var o of t)128>o&&i.push(O(o));let a=o=i.length;for(o&&i.push("-");a<s;){var h=2147483647;for(const i of t)i>=e&&i<h&&(h=i);const s=a+1;h-e>j((2147483647-r)/s)&&F("overflow"),r+=(h-e)*s,e=h;for(const c of t)if(c<e&&2147483647<++r&&F("overflow"),c==e){var l=r;for(h=36;;h+=36){const t=h<=n?1:h>=n+26?26:h-n;if(l<t)break;l-=t;const s=36-t;i.push(O($(t+l%s,0))),l=j(l/s)}i.push(O($(l,0))),n=U(r,s,a==o),r=0,++a}++r,++e}return i.join("")}(t):t}))}(i=(i=(i=C(t)).split("-").join("--")).split(".").join("-")).toLowerCase()).length?L(t):(Y(i)&&(i="0-".concat(i,"-0")),Promise.resolve(i)):L(t)}(e.toString()).then((s=>{let n=new R(i);return n.protocol="https",s=s+"."+t,n.host=s,n.hostname=s,n.pathname=r+e.hostname+e.pathname,n.toString()}))}var X="amp-viewer-messaging",B="channelOpen",G="__AMPHTML__";function Z(t){if("string"!=typeof t)return t;if("{"!=t.charAt(0))return null;try{return JSON.parse(t)}catch(t){return null}}var J,W=class{static initiateHandshakeWithDocument(t,i){return new Promise((s=>{const e=setInterval((()=>{const r=new MessageChannel,n={app:G,name:"handshake-poll"};t.postMessage(n,"*",[r.port2]);const o=r.port1,a=t=>{const r=Z(t.data);if(r&&r.app===G&&r.name===B){clearInterval(e),o.removeEventListener("message",a);const t=new W(null,o,!1,i,!0);t.sendResponse_(r.requestid,B,null),s(t)}};o.addEventListener("message",a),o.start()}),1e3)}))}static waitForHandshakeFromDocument(t,i,s,e,r){return new Promise((n=>{const o=a=>{const h=Z(a.data);if(h&&(a.origin==s||r&&r.test(a.origin))&&(!a.source||a.source==i)&&h.app===G&&h.name===B){t.removeEventListener("message",o);const s=new class{constructor(t,i,s){this.win_=t,this.origin_=i,this.target_=s}addEventListener(t,i){this.win_.addEventListener("message",(t=>{t.origin==this.origin_&&t.source==this.target_&&i(t)}))}postMessage(t){const i="null"===this.origin_?"*":this.origin_;this.target_.postMessage(t,i)}start(){}}(t,a.origin,i),r=new W(null,s,!1,e,!0);r.sendResponse_(h.requestid,B,null),n(r)}};t.addEventListener("message",o)}))}constructor(t,i,s,e,r){this.win_=t,this.port_=i,this.isWebview_=!!s,this.token_=e||null,this.verifyToken_=!!r,this.requestIdCounter_=0,this.waitingForResponse_={},this.messageHandlers_={},this.defaultHandler_=null,this.port_.addEventListener("message",this.handleMessage_.bind(this)),this.port_.start()}registerHandler(t,i){this.messageHandlers_[t]=i}unregisterHandler(t){delete this.messageHandlers_[t]}setDefaultHandler(t){this.defaultHandler_=t}handleMessage_(t){const i=Z(t.data);i&&i.app===G&&(this.token_&&this.verifyToken_&&i.messagingToken!==this.token_?this.logError_(X+": handleMessage_ error: ","invalid token"):"q"===i.type?this.handleRequest_(i):"s"===i.type&&this.handleResponse_(i))}sendRequest(t,i,s){const e=++this.requestIdCounter_;let r;return s&&(r=new Promise(((t,i)=>{this.waitingForResponse_[e]={resolve:t,reject:i}}))),this.sendMessage_({app:G,requestid:e,type:"q",name:t,data:i,rsvp:s}),r}sendResponse_(t,i,s){this.sendMessage_({app:G,requestid:t,type:"s",name:i,data:s})}sendResponseError_(t,i,s){const e=this.errorToString_(s);this.logError_(X+": sendResponseError_, message name: "+i,e),this.sendMessage_({app:G,requestid:t,type:"s",name:i,data:null,error:e})}sendMessage_(t){const i=Object.assign(t,{});this.token_&&!this.verifyToken_&&(i.messagingToken=this.token_),this.port_.postMessage(this.isWebview_?JSON.stringify(i):i)}handleRequest_(t){let i=this.messageHandlers_[t.name];if(i||(i=this.defaultHandler_),!i){const i=new Error("Cannot handle request because no default handler is set!");throw i.args=t.name,i}const s=i(t.name,t.data,!!t.rsvp);if(t.rsvp){const i=t.requestid;if(!s)throw this.sendResponseError_(i,t.name,new Error("no response")),new Error("expected response but none given: "+t.name);s.then((s=>{this.sendResponse_(i,t.name,s)}),(s=>{this.sendResponseError_(i,t.name,s)}))}}handleResponse_(t){const i=t.requestid,s=this.waitingForResponse_[i];s&&(delete this.waitingForResponse_[i],t.error?(this.logError_(X+": handleResponse_ error: ",t.error),s.reject(new Error(`Request ${t.name} failed: ${t.error}`))):s.resolve(t.data))}logError_(t,i){if(!this.win_)return;let s="amp-messaging-error-logger: "+t;s+=" data: "+this.errorToString_(i),this.win_.viewerState=s}errorToString_(t){return t?t.message?t.message:String(t):"unknown error"}},Q="visible";function K(t){try{t.focus()}catch(t){}}function tt(t,i,s){const e=t.hasAttribute(i),r=void 0!==s?s:!e;return r!==e&&(r?t.setAttribute(i,""):t.removeAttribute(i)),r}var it=["Webkit","webkit","Moz","moz","ms","O","o"];function st(t,i,s,e,r){const n=function(t,i,s){if(i.startsWith("--"))return i;J||(J=h());let e=J[i];if(!e||s){if(e=i,void 0===t[i]){const s=function(t){return t.charAt(0).toUpperCase()+t.slice(1)}(i),r=function(t,i){for(let s=0;s<it.length;s++){const e=it[s]+i;if(void 0!==t[e])return e}return""}(t,s);void 0!==t[r]&&(e=r)}s||(J[i]=e)}return e}(t.style,i,r);if(!n)return;const o=e?s+e:s;t.style.setProperty(function(t){const i=t.replace(/[A-Z]/g,(t=>"-"+t.toLowerCase()));return it.some((t=>i.startsWith(t+"-")))?`-${i}`:i}(n),o)}function et(t,i){for(const s in i)st(t,s,i[s])}function rt(t,i){for(let s=0;s<i.length;s++)st(t,i[s],null)}var nt,ot=/(?:^[#?]?|&)([^=&]+)(?:=([^&]*))?/g;function at(t,i=""){try{return decodeURIComponent(t)}catch(t){return i}}function ht(t,i,s){let e=0,r=null;function n(n){r=null,e=t.setTimeout(o,s),i.apply(null,n)}function o(){e=0,r&&n(r)}return function(...t){e?r=t:n(t)}}function lt(t,i,s,e){const r={detail:s};return Object.assign(r,e),new t.CustomEvent(i,r)}self.__AMP_LOG=self.__AMP_LOG||{user:null,dev:null,userForEmbed:null},self.__AMP_LOG;var ct,pt=(()=>self.AMP.config.urls)();function ut(t,i){return ct||(ct=self.document.createElement("a")),ft(ct,t)}function ft(t,i,s){return t.href="",new URL(i,t.href)}function mt(t){const i=[];for(const o in t){let a=t[o];if(null!=a){a=r(n=a)?n:[n];for(let t=0;t<a.length;t++)i.push((s=o,e=a[t],`${encodeURIComponent(s)}=${encodeURIComponent(e)}`))}}var s,e,n;return i.join("&")}function dt(t){const i=t.indexOf("#");return-1==i?t:t.substring(0,i)}function yt(t){const i=t.indexOf("#");return-1==i?"":t.substring(i)}function _t(t){return pt.cdnProxyRegex.test((t=>"string"==typeof t?ut(t):t)(t).origin)}function gt(t){const i=t.indexOf("?");if(-1==i)return t;const s=yt(t);return t.substring(0,i)+s}new Set(["c","v","a","ad"]);var vt=(()=>self.AMP.config.urls)(),bt="i-amphtml-story-player-loading",Pt="i-amphtml-story-player-loaded",At="i-amphtml-story-player-error",wt=["cdn.ampproject.org","www.bing-amp.com"],Et=["allow-top-navigation"],xt="amp-story-player-hide-button",Mt="PAGE_ATTACHMENT_STATE",Tt="UI_STATE",It="MUTED_STATE",Rt="CURRENT_PAGE_ID",St="i-amphtml-story-player-no-navigation-transition",Vt="amp-story-player",kt=class extends t.BaseElement{static prerenderAllowed(){return!0}constructor(t){super(t),this.tyt=new class{constructor(t,i){return this.i=t,this._n=i,this.yf=t.document,this.Rf=this.yf.createElement("a"),this.If=[],this.Pf=null,this.Vf=0,this.Sf=0,this.kf=null,this.jf=null,this.zf=null,this.Of={startX:0,startY:0,lastX:0,isSwipeX:null},this.$f=null,this.Ff=new e,this.qf(),this.Uf=new class{constructor(t){this.i=t,this.Of={startY:0,lastDelta:0,touchStartTimeMs:null,touchEndTimeMs:null,touchMoveTimeMs:null},this.Cf={startY:0,isRunning:!1,acceleration:1,speedLimit:.3,startTimeMs:null,maxTimeBetweenSwipesMs:250,moveTimeThresholdMs:100,durationMs:null,meetsDeltaYThreshold:!1,deltaYThresholdPx:5,deltaY:null,offsetThresholdPx:30,offsetPx:null,multiplier:1}}onTouchStart(t,i){this.Of.startY=i,this.Of.touchStartTimeMs=t,this.Cf.startY=this.i.scrollY,this.Cf.isRunning&&this.Of.touchEndTimeMs-this.Of.touchStartTimeMs<this.Cf.maxTimeBetweenSwipesMs?this.Cf.multiplier+=this.Cf.acceleration:this.Cf.multiplier=1,this.Cf.isRunning=!1}onTouchMove(t,i){this.Cf.acceleration=Math.abs(this.Cf.deltaY/(t-this.Of.touchMoveTimeMs)),this.Of.touchMoveTimeMs=t,ht(this.i,this.Df.bind(this,i),50)()}Df(t){this.Cf.deltaY=t-this.Of.startY,this.Cf.meetsDeltaYThreshold=Math.abs(this.Cf.deltaY)>this.Cf.deltaYThresholdPx,this.Cf.meetsDeltaYThreshold&&this.i.scrollBy(0,-this.Cf.deltaY)}onTouchEnd(t){if(this.Of.touchEndTimeMs=t,!this.Cf.meetsDeltaYThreshold)return;const i=this.Of.touchEndTimeMs-this.Of.touchMoveTimeMs;this.Cf.offsetPx=this.Nf(),i<this.Cf.moveTimeThresholdMs&&Math.abs(this.Cf.offsetPx)>this.Cf.offsetThresholdPx&&(this.Cf.durationMs=1.2*this.i.innerHeight,this.Cf.isRunning=!0,requestAnimationFrame((t=>{this.Cf.startTimeMs=t,this.Cf.startY=this.i.scrollY,this.Lf(t)}))),this.Cf.multiplier=1,this.Of.startY=0,this.Cf.deltaY=0}Nf(){const t=this.i.innerHeight*this.Cf.speedLimit;let i=Math.pow(this.Cf.acceleration,2)*this.i.innerHeight;return i=Math.min(t,i),i*=this.Cf.deltaY>0?-this.Cf.multiplier:this.Cf.multiplier,i}Lf(t){const i=t-this.Cf.startTimeMs;if(i>this.Cf.durationMs)return;const s=this.Yf(i/this.Cf.durationMs)*this.Cf.offsetPx,e=this.Cf.startY+s;this.Cf.isRunning?(this.i.scroll(0,e),requestAnimationFrame(this.Lf.bind(this))):cancelAnimationFrame(requestAnimationFrame(this.Lf.bind(this)))}Yf(t){return 1- --t*t*t*t}}(t),this.Hf=!0,this.Xf=null,this.Bf=null,this.Zf=null,this.Gf=!1,this._n}qf(){this._n.buildPlayer=this.buildPlayer.bind(this),this._n.layoutPlayer=this.layoutPlayer.bind(this),this._n.getElement=this.getElement.bind(this),this._n.getStories=this.getStories.bind(this),this._n.load=this.load.bind(this),this._n.show=this.show.bind(this),this._n.add=this.add.bind(this),this._n.play=this.play.bind(this),this._n.pause=this.pause.bind(this),this._n.go=this.go.bind(this),this._n.mute=this.mute.bind(this),this._n.unmute=this.unmute.bind(this),this._n.getStoryState=this.getStoryState.bind(this),this._n.rewind=this.rewind.bind(this)}load(){if(!this._n.isConnected)throw new Error(`[${Vt}] element must be connected to the DOM before calling load().`);if(this._n.gf)throw new Error(`[${Vt}] calling load() on an already loaded element.`);this.buildPlayer(),this.layoutPlayer()}Jf(t){t.idx=this.If.length,t.distance=t.idx-this.Vf,t.connectedDeferred=new e,this.If.push(t)}add(t){if(t.length<=0)return;if(!Array.isArray(t)||!t.every((t=>t&&t.href)))throw new Error('"stories" parameter has the wrong structure');const i=this.If.length;for(let i=0;i<t.length;i++){const s=t[i];this.Jf(s),this.Wf(s)}this.Zu(i)}play(){this._n.vf||this.layoutPlayer(),this.Qf(!1)}pause(){this.Qf(!0)}Qf(t){this.Hf=!t;const i=this.If[this.Vf];this.ai(i,t?"paused":Q)}getElement(){return this._n}getStories(){return this.If}buildPlayer(){this._n.gf||(this.Kf(),this.Af(),this.cp(),this.Fp(),this.Yp(),this.Hp(this.If.length-this.Vf-1),this.Xp(),this.Bp(),this.Zp(),this.Gp(),this.Jp(),this.Wp(),this._n.gf=!0)}Kf(){var t;((t=this._n.querySelectorAll("a"))?Array.prototype.slice.call(t):[]).forEach((t=>{const i=t.querySelector("img[data-amp-story-player-poster-img]"),s=i&&i.getAttribute("src"),e={href:t.href,title:t.textContent&&t.textContent.trim()||null,posterImage:t.getAttribute("data-poster-portrait-src")||s};this.Jf(e)}))}Wp(){this._n.dispatchEvent(lt(this.i,"ready",{})),this._n.isReady=!0}cp(){this.If.forEach((t=>{this.Wf(t)}))}Af(){this.Pf=this.yf.createElement("div"),this.Pf.classList.add("i-amphtml-story-player-main-container");const t=this.yf.createElement("div");t.classList.add("i-amphtml-fill-content","i-amphtml-story-player-shadow-root-intermediary"),this._n.appendChild(t);const i=this._n.attachShadow?t.attachShadow({mode:"open"}):t,s=this.yf.createElement("style");s.textContent=':host{all:initial;color:initial}.story-player-iframe{height:100%;width:100%;-ms-flex:0 0 100%;flex:0 0 100%;border:0;opacity:0;transition:opacity 500ms ease;position:absolute}.i-amphtml-story-player-main-container{height:100%;position:relative;overflow:hidden;transform-style:preserve-3d}.i-amphtml-story-player-loaded .story-player-iframe{opacity:1;transition:transform 200ms cubic-bezier(0.4,0,0.2,1)}.i-amphtml-story-player-no-navigation-transition .story-player-iframe{transition-duration:0.01s}.i-amphtml-story-player-main-container .story-player-iframe[i-amphtml-iframe-position="0"],.i-amphtml-story-player-main-container iframe:first-of-type{transform:translateZ(1px)}.i-amphtml-story-player-main-container .story-player-iframe[i-amphtml-iframe-position="1"],.i-amphtml-story-player-main-container iframe:nth-of-type(2),.i-amphtml-story-player-main-container iframe:nth-of-type(3){transform:translate3d(100%,0,0)}.i-amphtml-story-player-main-container .story-player-iframe[i-amphtml-iframe-position="-1"]{transform:translate3d(-100%,0,0)}.amp-story-player-exit-control-button{position:absolute;height:48px;width:48px;background-repeat:no-repeat;background-position:50%;margin-top:7px;background-size:28px;border:0px;background-color:transparent;outline:transparent;cursor:pointer;z-index:1}.amp-story-player-close-button{background-image:url(\'data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" height="24" width="24" fill="%23FFF"><path d="M0 0h24v24H0z" fill="none"/><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>\')}.amp-story-player-back-button{background-image:url(\'data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" height="24" width="24" fill="%23FFF"><path d="M0 0h24v24H0z" fill="none"/><path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/></svg>\')}.amp-story-player-hide-button{display:none}.i-amphtml-story-player-panel{--i-amphtml-story-player-panel-ratio:69/116;--i-amphtml-story-player-panel-responsive-margin:max(74px,calc(var(--i-amphtml-story-player-height)*0.0825));--i-amphtml-story-player-panel-height:calc(var(--i-amphtml-story-player-height) - var(--i-amphtml-story-player-panel-responsive-margin)*2);--i-amphtml-story-player-panel-width:calc(var(--i-amphtml-story-player-panel-height)*var(--i-amphtml-story-player-panel-ratio));--i-amphtml-story-player-panel-button-margin:max(10px,calc(50vw - 145px - var(--i-amphtml-story-player-panel-width)/2))}.i-amphtml-story-player-panel.i-amphtml-story-player-panel-medium{--i-amphtml-story-player-panel-responsive-margin:0px;--i-amphtml-story-player-panel-width:calc(var(--i-amphtml-story-player-height)*var(--i-amphtml-story-player-panel-ratio))}.i-amphtml-story-player-panel.i-amphtml-story-player-panel-small{--i-amphtml-story-player-panel-ratio:36/53}.i-amphtml-story-player-panel-next,.i-amphtml-story-player-panel-prev{position:absolute;top:50%;transform:translateY(-50%);width:48px;height:48px;z-index:1;background-color:transparent;border:none;background-position:50%;background-repeat:no-repeat;cursor:pointer;transition:opacity 150ms}.i-amphtml-story-player-panel-next[disabled],.i-amphtml-story-player-panel-prev[disabled]{opacity:.1;cursor:initial}.i-amphtml-story-player-full-bleed-story .i-amphtml-story-player-panel-next,.i-amphtml-story-player-full-bleed-story .i-amphtml-story-player-panel-prev,:not(.i-amphtml-story-player-panel) .i-amphtml-story-player-panel-next,:not(.i-amphtml-story-player-panel) .i-amphtml-story-player-panel-prev{opacity:0;pointer-events:none}.i-amphtml-story-player-panel-next,.i-amphtml-story-player-panel-prev{background-image:url(\'data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="none"><path stroke="%23fff" stroke-linecap="round" stroke-width="1.9" d="M17 29.2V18.8c0-1.2 1.4-2 2.5-1.3l7.5 5.2c1 .6 1 2 0 2.6l-7.5 5.2c-1 .7-2.5 0-2.5-1.3z"/><rect width="1.8" height="15.6" x="30.2" y="16.2" fill="%23fff" rx=".9"/></svg>\')!important}.i-amphtml-story-player-panel-prev{margin-inline-start:calc(var(--i-amphtml-story-player-panel-button-margin));transform:translateY(-50%) rotate(180deg)}.i-amphtml-story-player-panel-next{margin-inline-end:var(--i-amphtml-story-player-panel-button-margin);right:0}[dir=rtl].i-amphtml-story-player-panel-prev{right:0}[dir=rtl].i-amphtml-story-player-panel-next{left:0;transform:translateY(-50%) rotate(180deg)}\n/*# sourceURL=/css/amp-story-player-shadow.css*/',i.appendChild(s),i.insertBefore(this.Pf,i.firstElementChild)}Fp(){const t=this._n.getAttribute("exit-control");if("back-button"!==(i=t)&&"close-button"!==i)return;var i;const s=this.yf.createElement("button");this.Pf.appendChild(s);const e="back-button"===t;s.classList.add(e?"amp-story-player-back-button":"amp-story-player-close-button"),s.classList.add("amp-story-player-exit-control-button"),s.addEventListener("click",(()=>{this._n.dispatchEvent(lt(this.i,e?"amp-story-player-back":"amp-story-player-close",{}))}))}Yp(){if(this.kf)return this.kf;const t=this._n.getAttribute("amp-cache");t&&!wt.includes(t)&&console.error(`[${Vt}]`,`Unsupported cache specified, use one of following: ${wt}`);const i=this._n.querySelector("script");if(!i)return null;if("SCRIPT"!=(s=i).tagName||"APPLICATION/JSON"!=(null===(e=s.getAttribute("type"))||void 0===e?void 0:e.toUpperCase()))throw new Error('<script> child must have type="application/json"');var s,e,r;try{this.kf=(r=i.textContent,JSON.parse(r))}catch(t){console.error(`[${Vt}] `,t)}return this.kf}Wf(t){const i=this.yf.createElement("iframe");t.posterImage&&st(i,"backgroundImage",t.posterImage),i.classList.add("story-player-iframe"),i.setAttribute("allow","autoplay"),function(t){if(!t.sandbox||!t.sandbox.supports)return;const i=["allow-top-navigation-by-user-activation","allow-popups-to-escape-sandbox"];for(let s=0;s<i.length;s++){const e=i[s];if(!t.sandbox.supports(e))return}t.sandbox=i.join(" ")+" "+["allow-forms","allow-modals","allow-pointer-lock","allow-popups","allow-same-origin","allow-scripts"].join(" ")}(i),this.Qp(i),this.Kp(i),t.iframe=i}Qp(t){if(t.sandbox&&t.sandbox.supports&&!(t.sandbox.length<=0))for(let i=0;i<Et.length;i++){const s=Et[i];if(!t.sandbox.supports(s))throw new Error(`Iframe doesn't support: ${s}`);t.sandbox.add(s)}}tm(t){const{iframe:i}=t;t.messagingPromise=new Promise((e=>{this.im(t,i).then((i=>{i.setDefaultHandler((()=>s())),i.registerHandler("touchstart",((t,i)=>{this.sm(i)})),i.registerHandler("touchmove",((t,i)=>{this.nm(i)})),i.registerHandler("touchend",((t,i)=>{this.rm(i)})),i.registerHandler("selectDocument",((t,i)=>{this.om(i)})),i.registerHandler("storyContentLoaded",(()=>{t.storyContentLoaded=!0})),i.sendRequest("onDocumentState",{"state":Mt},!1),i.sendRequest("onDocumentState",{"state":Rt},!1),i.sendRequest("onDocumentState",{"state":It}),i.sendRequest("onDocumentState",{"state":Tt}),i.registerHandler("documentStateUpdate",((t,s)=>{this.am(s,i)})),this.kf&&this.kf.controls&&(this.hm(t.idx),i.sendRequest("customDocumentUI",{"controls":this.kf.controls},!1)),e(i)}),(t=>{console.error(`[${Vt}]`,t)}))}))}hm(t){if(t===this.If.length-1){const t=n(this.kf.controls,(t=>"skip-next"===t.name||"skip-to-next"===t.name));t>=0&&(this.kf.controls[t].state="disabled")}}im(t,i){return this.lm(t.href).then((t=>W.waitForHandshakeFromDocument(this.i,i.contentWindow,this.um(t).origin,null,vt.cdnProxyRegex)))}Kp(t){this.Pf.classList.add(bt),t.onload=()=>{this.Pf.classList.remove(bt),this.Pf.classList.add(Pt),this._n.classList.add(Pt)},t.onerror=()=>{this.Pf.classList.remove(bt),this.Pf.classList.add(At),this._n.classList.add(At)}}layoutPlayer(){if(!this._n.vf){if(new class{constructor(t,i,s){this.i=t,this._n=i,this.bf=s,this.wf=null,this.Ef()}Ef(){this.i.IntersectionObserver&&this.i===this.i.parent?this.Mf():this.Tf()}Mf(){const t=new this.i.IntersectionObserver((i=>{i.forEach((i=>{i.isIntersecting&&(this.bf(),t.unobserve(this._n))}))}));t.observe(this._n)}Tf(){this.wf=ht(this.i,this.xf.bind(this),500),this.i.addEventListener("scroll",this.wf),this.xf(this._n)}xf(){const t=this._n.getBoundingClientRect().top;this.i.innerHeight>t&&(this.bf(),this.i.removeEventListener("scroll",this.wf))}}(this.i,this._n,(()=>this.Ff.resolve())),this.i.ResizeObserver)new this.i.ResizeObserver((t=>{const{height:i,width:s}=t[0].contentRect;this.fm(i,s)})).observe(this._n);else{const{height:t,width:i}=this._n.getBoundingClientRect();this.fm(t,i)}this.Zu(),this._n.vf=!0}}Jp(){this.Bf=this.yf.createElement("button"),this.Bf.classList.add("i-amphtml-story-player-panel-prev"),this.Bf.addEventListener("click",(()=>this.pm())),this.Bf.setAttribute("aria-label","previous story"),this.Pf.appendChild(this.Bf),this.Zf=this.yf.createElement("button"),this.Zf.classList.add("i-amphtml-story-player-panel-next"),this.Zf.addEventListener("click",(()=>this.Er())),this.Zf.setAttribute("aria-label","next story"),this.Pf.appendChild(this.Zf),this.dm()}dm(){tt(this.Bf,"disabled",this.ym(this.Vf-1)&&!this.zf),tt(this.Zf,"disabled",this.ym(this.Vf+1)&&!this.zf)}fm(t,i){const s=i/t>.775;this.Pf.classList.toggle("i-amphtml-story-player-panel",s),s&&(et(this.Pf,{"--i-amphtml-story-player-height":`${t}px`}),this.Pf.classList.toggle("i-amphtml-story-player-panel-medium",t<756),this.Pf.classList.toggle("i-amphtml-story-player-panel-small",t<538))}_m(){let{endpoint:t}=this.kf.behavior;return t?(t=t.replace(/\${offset}/,this.If.length.toString()),fetch(t,{method:"GET",headers:{Accept:"application/json"}}).then((t=>t.json())).catch((t=>{console.error(`[${Vt}]`,t)}))):(this.jf=!1,s())}show(t,i=null,e={}){const r=this.gm(t);let n=s();return r.idx!==this.Vf&&(this.Vf=r.idx,n=this.Zu(),!1===e.animate&&(this.Pf.classList.toggle(St,!0),function(t,i,s,e){let r=s;const n=function(t,i,s,e){let r=t,n=s,o=t=>{try{return n(t)}catch(t){var i,s;throw null===(i=(s=self).__AMP_REPORT_ERROR)||void 0===i||i.call(s,t),t}};const a=function(){if(void 0!==nt)return nt;nt=!1;try{const t={get capture(){return nt=!0,!1}};self.addEventListener("test-options",null,t),self.removeEventListener("test-options",null,t)}catch(t){}return nt}();return r.addEventListener(i,o,!!a&&e),()=>{null==r||r.removeEventListener(i,o,!!a&&e),n=null,r=null,o=null}}(t,"transitionend",(t=>{try{r(t)}finally{r=null,n()}}),void 0)}(r.iframe,0,(()=>{this.Pf.classList.remove(St)}))),this.vm()),null!=i?n.then((()=>this.Pm(i))):n}mute(){const t=this.If[this.Vf];this.Am(t,!0)}unmute(){const t=this.If[this.Vf];this.Am(t,!1)}getStoryState(t){"page-attachment"===t&&this.bm()}wm(t){const i=lt(this.i,"navigation",t);this._n.dispatchEvent(i)}vm(){const t=this.Vf,i=this.If.length-this.Vf-1,s={"index":t,"remaining":i};this.dm(),this.Em().then((t=>this.Mm(t))),this.wm(s),this.Hp(i)}Em(){const t=this.If[this.Vf];return new Promise((i=>{t.messagingPromise.then((t=>{t.sendRequest("getDocumentState",{state:Tt},!0).then((t=>i(t.value)))}))}))}Mm(t){const i=2===t||0===t;this.Pf.classList.toggle("i-amphtml-story-player-full-bleed-story",i)}Hp(t){this.kf&&this.kf.behavior&&this.Tm()&&t<=2&&this._m().then((t=>{t&&this.add(t)})).catch((t=>{console.error(`[${Vt}]`,t)}))}xm(t){return t&&t.on&&t.action}Tm(){if(null!==this.jf)return this.jf;const{behavior:t}=this.kf;var i;return this.jf=this.xm(t)&&"end"===(i=t).on&&"fetch"===i.action&&i.endpoint,this.jf}Er(){!this.zf&&this.ym(this.Vf+1)||(this.zf&&this.ym(this.Vf+1)?this.go(1):(this.Vf++,this.Zu(),this.vm()))}pm(){!this.zf&&this.ym(this.Vf-1)||(this.zf&&this.ym(this.Vf-1)?this.go(-1):(this.Vf--,this.Zu(),this.vm()))}go(t,i=0,e={}){if(0===t&&0===i)return;if(!this.zf&&this.ym(this.Vf+t))throw new Error("Out of Story range.");const r=this.Vf+t,n=t>0?this.If[r%this.If.length]:this.If[(r%this.If.length+this.If.length)%this.If.length];let o=s();this.Vf!==n.idx&&(o=this.show(n.href,null,e)),o.then((()=>{this.Rm(i)}))}Im(t){const i=0===t.distance?0:t.idx>this.Vf?1:-1;requestAnimationFrame((()=>{const{iframe:s}=t;rt(s,["transform","transition"]),s.setAttribute("i-amphtml-iframe-position",i)}))}Vm(t){var i;return this.If[this.Vf].storyContentLoaded?s():0!==t.distance?this.$f.promise:(null===(i=this.$f)||void 0===i||i.reject("[amp-story-player-dev] Cancelling previous story load promise."),this.$f=new e,t.messagingPromise.then((i=>i.registerHandler("storyContentLoaded",(()=>{t.storyContentLoaded=!0,this.$f.resolve()})))),s())}Zu(t=this.Vf){const i=[];for(let s=0;s<this.If.length;s++){const e=this.If[(s+t)%this.If.length],r=e.distance;e.distance=Math.abs(this.Vf-e.idx),r<=1&&e.distance>1&&this.Sm(e),e.distance<=1&&!e.iframe.isConnected&&this.km(e),e.distance>1||i.push(this.Vm(e).then((()=>this.lm(e.href))).then((t=>{this.jm(t,e.iframe.src)||this.zm(e,t)})).then((()=>this.Ff.promise)).then((()=>{0===e.distance&&this.Hf&&this.ai(e,Q),0===r&&1===e.distance&&this.ai(e,"inactive")})).then((()=>{this.Im(e),0===e.distance&&K(e.iframe)})).catch((t=>{t.includes("amp-story-player-dev")||console.error(`[${Vt}]`,t)})))}return Promise.all(i)}km(t){this.Pf.appendChild(t.iframe),this.tm(t),t.connectedDeferred.resolve()}Sm(t){t.storyContentLoaded=!1,t.connectedDeferred=new e,t.iframe.setAttribute("src",""),t.iframe.remove()}zm(t,i){const{iframe:s}=t,{href:e}=this.um(i,"prerender");s.setAttribute("src",e),t.title&&s.setAttribute("title",t.title)}jm(t,i){return!(i.length<=0)&&dt(gt(i))===dt(gt(t))}lm(t){const i=this._n.getAttribute("amp-cache");if(!i||!wt.includes(i))return Promise.resolve(t);if(_t(t)){const i=ut(t);return i.pathname.startsWith("/c/")&&(i.pathname="/v/"+i.pathname.substr(3)),Promise.resolve(i.toString())}return H(i,t,"viewer").then((t=>t))}um(t,i="inactive"){const s={"visibilityState":i,"origin":this.i.origin,"showStoryUrlInfo":"0","storyPlayer":"v0","cap":"swipe"};"auto"===this.Xf&&(s.attribution="auto");const e=u(u({},function(t){const i=h();if(!t)return i;let s;for(;s=ot.exec(t);){const t=at(s[1],s[1]),e=s[2]?at(s[2].replace(/\+/g," "),s[2]):"";i[t]=e}return i}(yt(t))),s);let r=dt(t);_t(t)&&(r=function(t,i,s){if(!i)return t;const e=t.split("#",2),r=e[0].split("?",2);let n=r[0]+(r[1]?`?${r[1]}&${i}`:`?${i}`);return n+=e[1]?`#${e[1]}`:"",n}(r,mt({"amp_js_v":"0.1"})));const n=r+"#"+mt(e);return ft(this.Rf,n)}ai(t,i){t.messagingPromise.then((t=>t.sendRequest("visibilitychange",{state:i},!0)))}Om(t,i,s){t.messagingPromise.then((t=>{t.sendRequest("setDocumentState",{state:i,value:s})}))}Am(t,i){this.Om(t,It,i)}bm(){this.If[this.Vf].messagingPromise.then((t=>{t.sendRequest("getDocumentState",{state:Mt},!0).then((t=>this.$m(t.value)))}))}Pm(t){this.If[this.Vf].messagingPromise.then((i=>i.sendRequest("selectPage",{"id":t})))}gm(t){const i=t?n(this.If,(({href:i})=>i===t)):this.Vf;if(!this.If[i])throw new Error(`Story URL not found in the player: ${t}`);return this.If[i]}rewind(t){const i=this.gm(t);this.Fm(i).then((()=>i.messagingPromise)).then((t=>t.sendRequest("rewind",{})))}Fm(t){return t.iframe.isConnected?s():t.connectedDeferred.promise}Rm(t){0!==t&&this.qm(t)}qm(t){this.If[this.Vf].messagingPromise.then((i=>i.sendRequest("selectPage",{delta:t})))}am(t,i){switch(t.state){case Mt:this.Um(t.value);break;case Rt:this.Cm(t.value,i);break;case It:this.Dm(t.value);break;case Tt:this.Mm(t.value);break;case"AMP_STORY_PLAYER_EVENT":this.Nm(t.value)}}Nm(t){switch(t){case"amp-story-player-skip-next":case"amp-story-player-skip-to-next":this.Er();break;default:this._n.dispatchEvent(lt(this.i,t,{}))}}Dm(t){this._n.dispatchEvent(lt(this.i,"amp-story-muted-state",{muted:t}))}Cm(t,i){i.sendRequest("getDocumentState",{"state":"STORY_PROGRESS"},!0).then((i=>{this._n.dispatchEvent(lt(this.i,"storyNavigation",{"pageId":t,"progress":i.value}))}))}Um(t){this.Lm(!t),this.Gf=t,this.$m(t)}Lm(t){const i=this.Pf.querySelector("button.amp-story-player-exit-control-button");i&&(t?i.classList.remove(xt):i.classList.add(xt))}$m(t){this._n.dispatchEvent(lt(this.i,t?"page-attachment-open":"page-attachment-close",{}))}om(t){this.Ym(t),t.next?this.Er():t.previous&&this.pm()}Ym(t){if(this.zf||!t.next&&!t.previous)return;let i,s;t.next?(i=this.Vf+1===this.If.length,s="noNextStory"):(i=0===this.Vf,s="noPreviousStory"),i&&this._n.dispatchEvent(lt(this.i,s,{}))}sm(t){const i=this.Hm(t);i&&(this.Of.startX=i.screenX,this.Of.startY=i.screenY,this.Uf&&this.Uf.onTouchStart(t.timeStamp,i.clientY),this._n.dispatchEvent(lt(this.i,"amp-story-player-touchstart",{"touches":t.touches})))}nm(t){const i=this.Hm(t);if(!i)return;if(this._n.dispatchEvent(lt(this.i,"amp-story-player-touchmove",{"touches":t.touches,"isNavigationalSwipe":this.Of.isSwipeX})),!1===this.Of.isSwipeX)return void(this.Uf&&this.Uf.onTouchMove(t.timeStamp,i.clientY));const{screenX:s,screenY:e}=i;this.Of.lastX=s,(null!==this.Of.isSwipeX||(this.Of.isSwipeX=Math.abs(this.Of.startX-s)>Math.abs(this.Of.startY-e),this.Of.isSwipeX))&&this.Xm({deltaX:s-this.Of.startX,last:!1})}rm(t){this._n.dispatchEvent(lt(this.i,"amp-story-player-touchend",{"touches":t.touches,"isNavigationalSwipe":this.Of.isSwipeX})),!0===this.Of.isSwipeX?this.Xm({deltaX:this.Of.lastX-this.Of.startX,last:!0}):this.Uf&&this.Uf.onTouchEnd(t.timeStamp),this.Of.startX=0,this.Of.startY=0,this.Of.lastX=0,this.Of.isSwipeX=null,this.Sf=0}Xm(t){if(this.If.length<=1||this.Gf)return;const{deltaX:i}=t;if(!0===t.last){const t=Math.abs(i);return 1===this.Sf&&(t>50&&(this.Bm()||this.zf)?this.Er():this.Zm()),void(2===this.Sf&&(t>50&&(this.Bm()||this.zf)?this.pm():this.Zm()))}this.Gm(i)}Zm(){const t=this.If[this.Vf].iframe;requestAnimationFrame((()=>{rt(l(t),["transform","transition"])}));const i=this.Bm();i&&requestAnimationFrame((()=>{rt(l(i.iframe),["transform","transition"])}))}Bm(){const t=1===this.Sf?this.Vf+1:this.Vf-1;return this.ym(t)?null:this.If[t]}ym(t){return t>=this.If.length||t<0}Xp(){if(!this.kf)return;const{behavior:t}=this.kf;t&&"boolean"==typeof t.autoplay&&(this.Hf=t.autoplay)}Bp(){if(!this.kf)return;const{display:t}=this.kf;t&&"auto"===t.attribution&&(this.Xf="auto")}Zp(){if(!this.kf)return;const{behavior:t}=this.kf;t&&!1===t.pageScroll&&(this.Uf=null)}Gp(){if(null!==this.zf)return this.zf;if(!this.kf)return this.zf=!1,!1;const{behavior:t}=this.kf;var i;return this.zf=this.xm(t)&&"end"===(i=t).on&&"circular-wrapping"===i.action,this.zf}Gm(t){let i;t<0?(this.Sf=1,i=`translate3d(calc(100% + ${t}px), 0, 0)`):(this.Sf=2,i=`translate3d(calc(${t}px - 100%), 0, 0)`);const s=this.If[this.Vf],{iframe:e}=s,r=`translate3d(${t}px, 0, 0)`;requestAnimationFrame((()=>{et(l(e),{transform:r,transition:"none"})}));const n=this.Bm();n&&requestAnimationFrame((()=>{et(l(n.iframe),{transform:i,transition:"none"})}))}Hm(t){const{touches:i}=t;if(!i||i.length<1)return null;const{clientX:s,clientY:e,screenX:r,screenY:n}=i[0];return{screenX:r,screenY:n,clientX:s,clientY:e}}}(this.win,t)}buildCallback(){this.tyt.buildPlayer()}layoutCallback(){return this.tyt.layoutPlayer(),s()}isLayoutSupported(t){return function(t){return"fixed"==t||"fixed-height"==t||"responsive"==t||"fill"==t||"flex-item"==t||"fluid"==t||"intrinsic"==t}(t)}};t.registerElement("amp-story-player",kt,'amp-story-player{position:relative;display:block}.i-amphtml-story-player-shadow-root-intermediary{width:100%;height:100%}amp-story-player a:first-of-type{width:100%;height:100%;background:var(--story-player-poster,#d3d3d3);background-size:100% 100%;display:block}amp-story-player.i-amphtml-story-player-loaded a{display:none}amp-story-player:after{content:" ";position:absolute;box-sizing:border-box;top:calc(50% - 32px);left:calc(50% - 32px);width:64px;height:64px;border-radius:50%;border-color:#fff transparent;border-style:solid;border-width:6px;filter:drop-shadow(0px 1px 3px rgba(0,0,0,0.25));animation-name:i-amphtml-story-player-spinner;animation-duration:4400ms;animation-timing-function:cubic-bezier(0.4,0,0.2,1);animation-iteration-count:infinite}@keyframes i-amphtml-story-player-spinner{12.5%{transform:rotate(135deg)}25%{transform:rotate(270deg)}37.5%{transform:rotate(405deg)}50%{transform:rotate(540deg)}62.5%{transform:rotate(675deg)}75%{transform:rotate(810deg)}87.5%{transform:rotate(945deg)}to{transform:rotate(1080deg)}}.i-amphtml-story-player-loaded:after{visibility:hidden}\n/*# sourceURL=/css/amp-story-player.css*/')})();
/*! https://mths.be/cssescape v1.5.1 by @mathias | MIT license */}});
//# sourceMappingURL=amp-story-player-0.1.mjs.map