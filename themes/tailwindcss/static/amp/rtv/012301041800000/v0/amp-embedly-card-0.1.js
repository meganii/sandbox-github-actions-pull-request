;
(self.AMP=self.AMP||[]).push({m:0,v:"2301041800000",n:"amp-embedly-card",ev:"0.1",l:!0,f:function(r,n){!function(){function n(r,t){return(n=Object.setPrototypeOf||function(r,n){return r.__proto__=n,r})(r,t)}function t(r,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),t&&n(r,t)}function e(r){return(e=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)})(r)}function i(r){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(r){return typeof r}:function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r})(r)}function o(r,n){if(n&&("object"===i(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return function(r){if(void 0===r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}(r)}function u(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(r){return!1}}();return function(){var t,i=e(r);if(n){var u=e(this).constructor;t=Reflect.construct(i,arguments,u)}else t=i.apply(this,arguments);return o(this,t)}}var a=Array.isArray;function f(r,n){(null==n||n>r.length)&&(n=r.length);for(var t=0,e=new Array(n);t<n;t++)e[t]=r[t];return e}function c(r,n){var t="undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(t)return(t=t.call(r)).next.bind(t);if(Array.isArray(r)||(t=function(r,n){if(r){if("string"==typeof r)return f(r,n);var t=Object.prototype.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?f(r,n):void 0}}(r))||n&&r&&"number"==typeof r.length){t&&(r=t);var e=0;return function(){return e>=r.length?{done:!0}:{done:!1,value:r[e++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l=Object.prototype;function s(r){var n=Object.create(null);return r&&Object.assign(n,r),n}function v(r,n,t,e,i,o,u,a,f,c,l){return r}function m(r){return JSON.parse(r)}function d(r,n){try{return m(r)}catch(r){return null==n||n(r),null}}function p(r){var n,t=parseFloat(r);return"number"==typeof(n=t)&&isFinite(n)?t:void 0}l.hasOwnProperty,l.toString;var h=/(?:^[#?]?|&)([^=&]+)(?:=([^&]*))?/g;function b(r){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";try{return decodeURIComponent(r)}catch(r){return n}}function y(r){var n,t=s();if(!r)return t;for(;n=h.exec(r);){var e=b(n[1],n[1]),i=n[2]?b(n[2].replace(/\+/g," "),n[2]):"";t[e]=i}return t}function g(r){var n=(r||self).location;return y(n.originalHash||n.hash)}var w="";function j(r){var n=r||self;return n.__AMP_MODE?n.__AMP_MODE:n.__AMP_MODE=function(r){return{localDev:!1,development:S(r,g(r)),esm:!1,test:!1,rtvVersion:O(r),ssrReady:!1}}(n)}function O(r){var n;return w||(w=(null===(n=r.AMP_CONFIG)||void 0===n?void 0:n.v)||"01".concat("2301041800000")),w}function S(r,n){var t=n||g(r);return["1","actions","amp","amp4ads","amp4email"].includes(t.development)||!!r.AMP_DEV_MODE}function E(r,n,t){return n in r?Object.defineProperty(r,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[n]=t,r}function I(r){var n=Object.getOwnPropertyDescriptor(r,"message");if(null!=n&&n.writable)return r;var t=r.message,e=r.stack,i=new Error(t);for(var o in r)i[o]=r[o];return i.stack=e,i}function R(r){for(var n,t=null,e="",i=c(arguments,!0);!(n=i()).done;){var o=n.value;o instanceof Error&&!t?t=I(o):(e&&(e+=" "),e+=o)}return t?e&&(t.message=e+": "+t.message):t=new Error(e),t}function x(r){var n,t;null===(n=(t=self).__AMP_REPORT_ERROR)||void 0===n||n.call(t,r)}self.__AMP_LOG=self.__AMP_LOG||{user:null,dev:null,userForEmbed:null};var A=self.__AMP_LOG;function T(r,n){throw new Error("failed to call initLogConstructor")}function k(r){return A.user||(A.user=F()),function(r,n){return n&&n.ownerDocument.defaultView!=r}(A.user.win,r)?A.userForEmbed||(A.userForEmbed=F()):A.user}function F(r){return T()}function M(){return A.dev||(A.dev=T())}function N(r,n,t,e,i,o,u,a,f,c,l){return r}function P(r,n,t,e,i,o,u,a,f,c,l){return k().assert(r,n,t,e,i,o,u,a,f,c,l)}function U(r,n){return D(r=function(r){return r.__AMP_TOP||(r.__AMP_TOP=r)}(r),n)}function _(r,n){return D((t=q(r),(e=q(t)).isSingleDoc()?e.win:e),n);var t,e}function q(r){return r.nodeType?(t=r,n=(t.ownerDocument||t).defaultView,U(n,"ampdoc")).getAmpDoc(r):r;var n,t}function D(r,n){N(function(r,n){var t=r.__AMP_SERVICES&&r.__AMP_SERVICES[n];return!(!t||!t.ctor)}(r,n));var t=function(r){var n=r.__AMP_SERVICES;return n||(n=r.__AMP_SERVICES={}),n}(r)[n];return t.obj||(N(t.ctor),N(t.context),t.obj=new t.ctor(t.context),N(t.obj),t.context=null,t.resolve&&t.resolve(t.obj)),t.obj}var G,J="amp-embedly-key",L=function(r){t(e,r);var n=u(e);function e(r){return n.call(this,r)}var i=e.prototype;return i.buildCallback=function(){P(this.element.getAttribute("value"),"The value attribute is required for <%s>",J,this.element)},i.isLayoutSupported=function(r){return"nodisplay"===r},e}(r.BaseElement),V=["Webkit","webkit","Moz","moz","ms","O","o"];function C(r,n,t,e,i){var o=function(r,n,t){if(n.startsWith("--"))return n;G||(G=s());var e=G[n];if(!e||t){if(e=n,void 0===r[n]){var i=function(r){return r.charAt(0).toUpperCase()+r.slice(1)}(n),o=function(r,n){for(var t=0;t<V.length;t++){var e=V[t]+n;if(void 0!==r[e])return e}return""}(r,i);void 0!==r[o]&&(e=o)}t||(G[n]=e)}return e}(r.style,n,i);if(o){var u,a=e?t+e:t;r.style.setProperty((u=o.replace(/[A-Z]/g,(function(r){return"-"+r.toLowerCase()})),V.some((function(r){return u.startsWith(r+"-")}))?"-".concat(u):u),a)}}var z=function(){function r(){}return r.generate=function(r){return function(r){for(var n=r.length,t=5381,e=0;e<n;e++)t=33*t^r.charCodeAt(e);return String(t>>>0)}(function(r){for(var n=[],t=0;1==(null==(o=r)?void 0:o.nodeType)&&t<25;){var e="";r.id&&(e="/".concat(r.id));var i=r.nodeName.toLowerCase();n.push("".concat(i).concat(e).concat(B(r))),t++,r=r.parentElement}var o;return n.join()}(r))},r}();function B(r){for(var n=r.nodeName,t=0,e=0,i=r.previousElementSibling;i&&e<25&&t<100;)i.nodeName==n&&e++,t++,i=i.previousElementSibling;return e<25&&t<100?".".concat(e):""}function X(r,n){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(r);n&&(e=e.filter((function(n){return Object.getOwnPropertyDescriptor(r,n).enumerable}))),t.push.apply(t,e)}return t}function H(r){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?X(Object(t),!0).forEach((function(n){E(r,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):X(Object(t)).forEach((function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))}))}return r}var W="__AMP__EXPERIMENT_TOGGLES";function Z(r){var n,t,e,i,o;if(r[W])return r[W];r[W]=s();var u=r[W];v(u);var f=H(H({},null!==(n=r.AMP_CONFIG)&&void 0!==n?n:{}),null!==(t=r.AMP_EXP)&&void 0!==t?t:m((null===(e=r.__AMP_EXP)||void 0===e?void 0:e.textContent)||"{}"));for(var l in f){var d=f[l];"number"==typeof d&&d>=0&&d<=1&&(u[l]=Math.random()<d)}var p=null===(i=r.AMP_CONFIG)||void 0===i?void 0:i["allow-doc-opt-in"];if(a(p)&&p.length){var h=r.document.head.querySelector('meta[name="amp-experiments-opt-in"]');if(h)for(var b,g,w=c((null===(b=h.getAttribute("content"))||void 0===b?void 0:b.split(","))||[],!0);!(g=w()).done;){var j=g.value;p.includes(j)&&(u[j]=!0)}}Object.assign(u,function(r){var n,t="";try{var e;"localStorage"in r&&(t=null!==(e=r.localStorage.getItem("amp-experiment-toggles"))&&void 0!==e?e:"")}catch(r){M().warn("EXPERIMENTS","Failed to retrieve experiments from localStorage.")}for(var i,o=(null===(n=t)||void 0===n?void 0:n.split(/\s*,\s*/g))||[],u=s(),a=c(o,!0);!(i=a()).done;){var f=i.value;f&&("-"==f[0]?u[f.substr(1)]=!1:u[f]=!0)}return u}(r));var O=null===(o=r.AMP_CONFIG)||void 0===o?void 0:o["allow-url-opt-in"];if(a(O)&&O.length)for(var S,E=y(r.location.originalHash||r.location.hash),I=c(O,!0);!(S=I()).done;){var R=S.value,x=E["e-".concat(R)];"1"==x&&(u[R]=!0),"0"==x&&(u[R]=!1)}return u}var $,K,Q=function(){return self.AMP.config.urls}(),Y=function(){function r(r){this.Lt=r,this.Wt=0,this.Kt=0,this.Qt=s()}var n=r.prototype;return n.has=function(r){return!!this.Qt[r]},n.get=function(r){var n=this.Qt[r];if(n)return n.access=++this.Kt,n.payload},n.put=function(r,n){this.has(r)||this.Wt++,this.Qt[r]={payload:n,access:this.Kt},this.Xt()},n.Xt=function(){if(!(this.Wt<=this.Lt)){var r,n=this.Qt,t=this.Kt+1;for(var e in n){var i=n[e].access;i<t&&(t=i,r=e)}void 0!==r&&(delete n[r],this.Wt--)}},r}();function rr(r,n){return $||($=self.document.createElement("a"),K=self.__AMP_URL_CACHE||(self.__AMP_URL_CACHE=new Y(100))),function(r,n,t){if(t&&t.has(n))return t.get(n);r.href=n,r.protocol||(r.href=r.href);var e,i={href:r.href,protocol:r.protocol,host:r.host,hostname:r.hostname,port:"0"==r.port?"":r.port,pathname:r.pathname,search:r.search,hash:r.hash,origin:null};"/"!==i.pathname[0]&&(i.pathname="/"+i.pathname),("http:"==i.protocol&&80==i.port||"https:"==i.protocol&&443==i.port)&&(i.port="",i.host=i.hostname),e=r.origin&&"null"!=r.origin?r.origin:"data:"!=i.protocol&&i.host?i.protocol+"//"+i.host:i.href,i.origin=e;var o=i;return t&&t.put(n,o),o}($,r,n?null:K)}function nr(r){return"https:"==(r=function(r){return"string"==typeof r?rr(r):r}(r)).protocol||"localhost"==r.hostname||"127.0.0.1"==r.hostname||(t=".localhost",(e=(n=r.hostname).length-t.length)>=0&&n.indexOf(t,e)==e);var n,t,e}new Set(["c","v","a","ad"]);var tr=function(){return self.AMP.config.urls}(),er={};function ir(r,n,t,e){var i=t||n.getAttribute("type");P(i,"Attribute type required for <amp-ad>: %s",n);var o=function(r){for(var n=0,t=r;t&&t!=t.parent;t=t.parent)n++;return String(n)+"-"+ar(r)}(r),u={};return function(r,n){var t=r.dataset;for(var e in t)e.startsWith("vars")||(n[e]=t[e]);var i=r.getAttribute("json");if(i){var o=d(i);if(void 0===o)throw k().createError("Error parsing JSON in json attribute in element %s",r);for(var u in o)n[u]=o[u]}}(n,u),u=function(r,n,t,e){var i=Date.now(),o=n.getAttribute("width"),u=n.getAttribute("height");(e=e||{}).width=p(o),e.height=p(u),n.getAttribute("title")&&(e.title=n.getAttribute("title"));var a=r.location.href;"about:srcdoc"==a&&(a=r.parent.location.href);var f,c,l,s,v=q(n),m=_(n,"documentInfo").get(),d=(s=n,_(s,"viewer")).getUnconfirmedReferrerUrl(),h=function(r){for(var n=r.ownerDocument.body,t=0,e=0,i=r;i&&i!=n;i=i.offsetParent)t+=i.offsetLeft,e+=i.offsetTop;var o=r.offsetHeight;return function(r,n,t,e){return{left:r,top:n,width:t,height:e,bottom:n+e,right:r+t,x:r,y:n}}(t,e,r.offsetWidth,o)}(n);e._context={"ampcontextVersion":"2301041800000","ampcontextFilepath":"".concat(Q.thirdParty,"/").concat("2301041800000","/ampcontext-v0.js"),"sourceUrl":m.sourceUrl,"referrer":d,"canonicalUrl":m.canonicalUrl,"pageViewId":m.pageViewId,"location":{"href":a},"startTime":i,"tagName":n.tagName,"mode":{localDev:!1,development:j(l).development,esm:j(l).esm,test:!1,rtvVersion:j(l).rtvVersion},"canary":(f=r,!(null===(c=f.AMP_CONFIG)||void 0===c||!c.canary)),"hidden":!v.isVisible(),"initialLayoutRect":h?{"left":h.left,"top":h.top,"width":h.width,"height":h.height}:null,"domFingerprint":z.generate(n),"experimentToggles":Z(r),"sentinel":t};var b=n.getAttribute("src");return b&&(e.src=b),e}(r,n,o,u),u.type=i,Object.assign(u._context,e),u}function or(r){return"".concat(tr.thirdParty,"/").concat("2301041800000","/vendor/").concat(r).concat(".js")}function ur(r,n,t){return function(r,n,t){var e=n.getMetaByName("amp-3p-iframe-src");if(!e)return null;var i=function(r,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"source";return P(null!=r,"%s %s must be available",n,t),P(nr(r)||/^\/\//.test(r),'%s %s must start with "https://" or "//" or be relative and served from either https or from localhost. Invalid value: %s',n,t,r),r}(e,'meta[name="amp-3p-iframe-src"]');P(-1==i.indexOf("?"),"3p iframe url must not include query string %s in element %s.",i,e);var o=rr(i);return P("localhost"==o.hostname&&!t||o.origin!=rr(r.location.href).origin,"3p iframe url must not be on the same origin as the current document %s (%s) in element %s. See https://github.com/ampproject/amphtml/blob/main/docs/spec/amp-iframe-origin-policy.md for details.",i,o.origin,e),"".concat(i,"?").concat("2301041800000")}(r,n,t)||function(r,n){return r.__AMP_DEFAULT_BOOTSTRAP_SUBDOMAIN=r.__AMP_DEFAULT_BOOTSTRAP_SUBDOMAIN||"d-"+ar(r),"https://"+r.__AMP_DEFAULT_BOOTSTRAP_SUBDOMAIN+".".concat(tr.thirdPartyFrameHost,"/").concat("2301041800000","/")+"".concat("frame",".html")}(r)}function ar(r){var n;if(r.crypto&&r.crypto.getRandomValues){var t=new Uint32Array(2);r.crypto.getRandomValues(t),n=String(t[0])+t[1]}else n=String(r.Math.random()).substr(2)+"0";return n}function fr(r){if(r.sandbox&&r.sandbox.supports){for(var n=["allow-top-navigation-by-user-activation","allow-popups-to-escape-sandbox"],t=0;t<n.length;t++){var e=n[t];if(!r.sandbox.supports(e))return void M().info("3p-frame","Iframe doesn't support %s",e)}r.sandbox=n.join(" ")+" "+["allow-forms","allow-modals","allow-pointer-lock","allow-popups","allow-same-origin","allow-scripts"].join(" ")}}function cr(r){return"string"==typeof r&&r.startsWith("amp-")&&-1!=r.indexOf("{")}function lr(r){return r.data}var sr="unlisten";function vr(r,n,t){var e=function(r,n){var t=r.listeningFors;return!t&&n&&(t=r.listeningFors=Object.create(null)),t||null}(r,t);if(!e)return e;var i=e[n];return!i&&t&&(i=e[n]=[]),i||null}function mr(r,n){for(var t=n;t&&t!=t.parent;t=t.parent)if(t==r)return!0;return!1}function dr(r){for(var n={"sentinel":sr},t=r.length-1;t>=0;t--){var e=r[t];if(!e.frame.contentWindow){r.splice(t,1);var i=e.events;for(var o in i)i[o].splice(0,1/0).forEach((function(r){r(n)}))}}}var pr="amp-embedly-card",hr=function(r){t(e,r);var n=u(e);function e(r){var t;return(t=n.call(this,r)).tb=null,t.Gq=null,t}var i=e.prototype;return i.buildCallback=function(){P(this.element.getAttribute("data-url"),"The data-url attribute is required for <%s> %s",pr,this.element);var r=document.querySelector(J);r&&(this.Gq=r.getAttribute("value"))},i.layoutCallback=function(){var r=this;this.Gq&&this.element.setAttribute("data-card-key",this.Gq);var n=function(r,n,t,e){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},o=i.allowFullscreen,u=void 0!==o&&o,a=i.initialIntersection;N(void 0===n.isConnected||!0===n.isConnected);var f=ir(r,n,t,e);a&&(f._context.initialIntersection=a);var c=r.document.createElement("iframe");er[f.type]||(er[f.type]=0),er[f.type]+=1;var l=n.getAmpDoc(),s=ur(r,l),v=rr(s).hostname,m=JSON.stringify({"host":v,"bootstrap":or(f.type),"type":f.type,"count":er[f.type],"attributes":f});return c.src=s,c.ampLocation=rr(s),c.name=m,f.width&&(c.width=f.width),f.height&&(c.height=f.height),f.title&&(c.title=f.title),u&&c.setAttribute("allowfullscreen","true"),c.setAttribute("scrolling","no"),C(c,"border","none"),c.onload=function(){this.readyState="complete"},c.setAttribute("allow","sync-xhr 'none';"),["facebook"].includes(t)||fr(c),c.setAttribute("data-amp-3p-sentinel",f._context.sentinel),c}(this.win,this.element,"embedly");return n.title=this.element.title||"Embedly card",function(r,n,t,e,i,o){N(r.src),N(!r.parentNode),N(t);var u=r.ownerDocument.defaultView;!function(r){r.listeningFors||r.addEventListener("message",(function(n){if(lr(n)){var t=function(r){return"string"==typeof r&&(r="{"==r.charAt(0)?d(r,(function(r){M().warn("IFRAME-HELPER","Postmessage could not be parsed. Is it in a valid JSON format?",r)}))||null:cr(r)?function(r){if(!cr(r))return null;var n=r.indexOf("{");return v(-1!=n),d(r.substr(n),(function(n){!function(r){var n=R.apply(null,arguments);setTimeout((function(){throw x(n),n}))}(new Error("MESSAGING: Failed to parse message: ".concat(r,"\n").concat(n.message)))}))}(r):null),r}(lr(n));if(t&&t.sentinel){var e=function(r,n,t,e){var i,o=vr(r,n);if(!o)return o;for(var u=0;u<o.length;u++){var a=o[u],f=a.frame.contentWindow;if(f){if(e==f||mr(f,e)){i=a;break}}else setTimeout(dr,0,o)}return i?i.events:null}(r,t.sentinel,n.origin,n.source);if(e){var i=e[t.type];if(i){i=i.slice();for(var o=0;o<i.length;o++)(0,i[o])(t,n.source,n.origin,n)}}}}}))}(u);var a,f=function(r,n,t){for(var e,i=function(r,n){return r.getAttribute("data-amp-3p-sentinel")}(n),o=vr(r,i,!0),u=0;u<o.length;u++){var a=o[u];if(a.frame===n){e=a;break}}return e||(e={frame:n,events:Object.create(null)},o.push(e)),e.events}(u,r),c=rr(r.src).origin,l=f["embed-size"]||(f["embed-size"]=[]),s=function(n,e,i,o){if("amp"==n.sentinel){if(e!=r.contentWindow)return;if(c!=i)return}e==r.contentWindow&&(n.sentinel!=sr?t(n,e,i,o):a())};l.push(s),a=function(){if(s){var r=l.indexOf(s);r>-1&&l.splice(r,1),s=null,l=null,t=null}}}(n,0,(function(n){r.forceChangeHeight(n.height)})),n.classList.add("i-amphtml-fill-content"),this.getVsync().mutate((function(){r.element.appendChild(n)})),this.tb=n,this.loadPromise(n)},i.unlayoutCallback=function(){var r,n;return this.tb&&(null===(n=(r=this.tb).parentElement)||void 0===n||n.removeChild(r),this.tb=null),!0},i.isLayoutSupported=function(r){return"responsive"==r},i.preconnectCallback=function(r){var n;(n=this.win,U(n,"preconnect")).url(this.getAmpDoc(),"https://cdn.embedly.com",r)},e}(r.BaseElement);r.registerElement(pr,hr),r.registerElement(J,L)}();
/*! https://mths.be/cssescape v1.5.1 by @mathias | MIT license */}});
//# sourceMappingURL=amp-embedly-card-0.1.js.map