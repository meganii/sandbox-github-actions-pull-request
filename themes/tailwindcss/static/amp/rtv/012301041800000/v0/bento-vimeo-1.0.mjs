;
import{PreactBaseElement as t}from"../bento.mjs";function e(t,e){if(null==t)return{};var o,n,r={},a=Object.keys(t);for(n=0;n<a.length;n++)o=a[n],e.indexOf(o)>=0||(r[o]=t[o]);return r}function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function n(t){var e=function(t,e){if("object"!==o(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===o(e)?e:String(e)}function r(t,e,o){return e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function a(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,n)}return o}function l(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?a(Object(o),!0).forEach((function(e){r(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):a(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}var i=class{constructor(){this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}},{isArray:s}=Array,{hasOwnProperty:u,toString:c}=Object.prototype;function f(t){const e=Object.getOwnPropertyDescriptor(t,"message");if(null!=e&&e.writable)return t;const{message:o,stack:n}=t,r=new Error(o);for(const e in t)r[e]=t[e];return r.stack=n,r}function d(t){let e=null,o="";for(const t of arguments)t instanceof Error&&!e?e=f(t):(o&&(o+=" "),o+=t);return e?o&&(e.message=o+": "+e.message):e=new Error(o),e}function m(t){const e=d.apply(null,arguments);return e.expected=!0,e}function p(t,...e){var o,n,r;o=m.apply(null,e),null===(n=(r=self).__AMP_REPORT_ERROR)||void 0===n||n.call(r,o)}import{Fragment as b,createElement as y}from"../bento.mjs";import{useCallback as v,useEffect as g,useImperativeHandle as h,useLayoutEffect as w,useMemo as j,useRef as k,useState as O}from"../bento.mjs";import{forwardRef as q}from"../bento.mjs";import{ContainWrapper as x,useValueRef as S}from"../bento.mjs";import{useAmpContext as C,useLoading as R}from"../bento.mjs";import{useCallback as I,useLayoutEffect as M}from"../bento.mjs";import{useAmpContext as P}from"../bento.mjs";function E(t,e){try{return function(t){return JSON.parse(t)}(t)}catch(t){return null==e||e(t),null}}var N={bubbles:!0,cancelable:!0};self.__AMP_LOG=self.__AMP_LOG||{user:null,dev:null,userForEmbed:null},self.__AMP_LOG;var L={"title":"","artist":"","album":"","artwork":[{"src":""}]};function T(t){const e=t.querySelector('script[type="application/ld+json"]');if(!e)return;const o=E(e.textContent);return o&&o.image?"string"==typeof o.image?o.image:o.image["@list"]&&"string"==typeof o.image["@list"][0]?o.image["@list"][0]:"string"==typeof o.image.url?o.image.url:"string"==typeof o.image[0]?o.image[0]:void 0:void 0}function V(t){const e=t.querySelector('meta[property="og:image"]');return e?e.getAttribute("content"):void 0}function $(t){const e=t.querySelector('link[rel="shortcut icon"]')||t.querySelector('link[rel="icon"]');return e?e.getAttribute("href"):void 0}function F({displayIcon:t,displayOverlay:e,metadata:o,onOverlayClick:n,pause:r,play:a,playing:l,wrapperRef:i}){const{playable:s}=C();return g((()=>{if(!s)return void r();const t=new IntersectionObserver((t=>{t[t.length-1].isIntersecting?a().catch((()=>{})):r()}),{threshold:.5});return t.observe(i.current),()=>{t.disconnect()}}),[i,a,r,s]),y(b,null,t&&y("div",{class:"eq-9e7199f"+(l?" eq-playing-9e7199f":"")},y(U,null)),e&&y("button",{"aria-label":o&&o.title||"Unmute video",tabindex:"0",class:"autoplay-mask-button-9e7199f fill-content-overlay-fc551a7",onClick:n}))}var U=function(t){let e=!1,o=null,n=()=>[1,2,3,4].map((t=>y("div",{class:"eq-col-9e7199f",key:t})));return(...t)=>(e||(o=n.apply(self,t),e=!0,n=null),o)}(),A=q((function(t,o){let r="class",{autoplay:a=!1,component:s="video",controls:u=!1,loading:c,loop:f=!1,mediasession:d=!0,noaudio:m=!1,onPlayingState:b,onReadyState:q,poster:I,sources:E,src:N,style:U,[r]:A}=t,z=e(t,["autoplay","component","controls","loading","loop","mediasession","noaudio","onPlayingState","onReadyState","poster","sources","src","style",r].map(n));!function(){const{notify:t}=P();M((()=>{t&&t()}))}();const{playable:J}=C(),Y=R(c),B="unload"!==Y,[H,W]=O(a),[D,G]=O(!1),[K,Q]=O(null),[X,Z]=O(!a),_=k(null),tt=k(null),et=j((()=>new i),[]),ot=k("loading"),nt=S(q),rt=v(((t,e)=>{if(t!==ot.current){ot.current=t;const o=nt.current;o&&o(t,e)}}),[nt]),at=S(b),lt=v((t=>{G(t);const e=at.current;e&&e(t)}),[at]);w((()=>{B||lt(!1)}),[B,lt]);const it=v((()=>et.promise.then((()=>function(t,e){const o=(n=()=>t.play(!1),new Promise((t=>{t(n())})));var n;return o.catch((t=>{p(0,t)})),o}(tt.current)))),[et]),st=v((()=>{et.promise.then((()=>{var t;return null===(t=tt.current)||void 0===t?void 0:t.pause()}))}),[et]),ut=v((()=>et.promise.then((()=>tt.current.requestFullscreen()))),[et]),ct=v((()=>{W(!1),Z(!0)}),[]);return w((()=>{var t;const e=null===(t=tt.current)||void 0===t?void 0:t.readyState;null!=e&&rt(e>0?"complete":"loading")}),[rt]),w((()=>(d&&D&&K&&function(t,e,o,n){const{navigator:r}=t;"mediaSession"in r&&t.MediaMetadata&&(r.mediaSession.metadata=new t.MediaMetadata(L),r.mediaSession.metadata=new t.MediaMetadata(e),r.mediaSession.setActionHandler("play",o),r.mediaSession.setActionHandler("pause",n))}(window,K,it,st),()=>{})),[d,D,K,it,st]),g((()=>{J||st()}),[J,st]),h(o,(()=>({get readyState(){return ot.current},play:it,pause:st,requestFullscreen:ut,get currentTime(){return tt.current?tt.current.currentTime:0},get duration(){return tt.current?tt.current.duration:NaN},get autoplay(){return a},get controls(){return u},get loop(){return f},userInteracted:ct,mute:()=>W(!0),unmute:()=>{X&&W(!1)}})),[it,st,ut,ct,X,a,u,f]),y(x,{contentRef:_,class:A,style:U,size:!0,layout:!0,paint:!0},B&&y(s,l(l({},z),{},{ref:tt,loading:Y,muted:H,loop:f,controls:u&&(!a||X),onCanPlay:()=>{et.resolve(),rt("complete")},onLoadedMetadata:()=>{d&&et.promise.then((()=>{var t,e;Q((t=tt.current,l({"title":(e=z).title||e["aria-label"]||document.title,"artist":e.artist||"","album":e.album||"","artwork":[{"src":e.artwork||e.poster||T(document)||V(document)||$(document)||""}]},t&&t.getMetadata?t.getMetadata():Object.create(null))))})),rt("complete")},onPlaying:()=>lt(!0),onPause:()=>lt(!1),onEnded:()=>lt(!1),onError:t=>{rt("error",t),et.reject(t)},class:"fill-stretch-fc551a7",src:N,poster:I}),E),a&&!X&&y(F,{metadata:K,playing:D,displayIcon:!m&&H,wrapperRef:_,play:it,pause:st,displayOverlay:u,onOverlayClick:ct}))}));A.displayName="VideoWrapper";var z=class extends t{};function J(t,e){var o;null==t||null===(o=t.contentWindow)||void 0===o||o.postMessage(e,"*")}z.Component=A,z.loadable=!0,z.layoutSizeDefined=!0,z.staticProps,z.props={"album":{attr:"album"},"alt":{attr:"alt"},"artist":{attr:"artist"},"artwork":{attr:"artwork"},"attribution":{attr:"attribution"},"autoplay":{attr:"autoplay",type:"boolean"},"controls":{attr:"controls",type:"boolean"},"controlslist":{attr:"controlslist"},"crossorigin":{attr:"crossorigin"},"disableremoteplayback":{attr:"disableremoteplayback"},"loop":{attr:"loop",type:"boolean"},"noaudio":{attr:"noaudio",type:"boolean"},"poster":{attr:"poster"},"sources":{selector:"source",single:!1,clone:!0},"src":{attr:"src"},"title":{attr:"title"},"dock":{attr:"dock",media:!0},"rotate-to-fullscreen":{attr:"rotate-to-fullscreen",type:"boolean",media:!0}},z.shadowCss='.fill-stretch-fc551a7{width:100%;height:100%;position:relative}.fill-content-overlay-fc551a7{top:0;left:0;right:0;bottom:0;position:absolute}.autoplay-mask-button-9e7199f{width:100%;border:none;display:block;-webkit-appearance:none;appearance:none;background:transparent}.eq-9e7199f{right:7px;width:20px;bottom:7px;height:12px;display:-ms-flexbox;display:flex;opacity:0.8;z-index:1;overflow:hidden;position:absolute;-ms-flex-align:end;align-items:flex-end;pointer-events:none!important}.eq-playing-9e7199f>div:after,.eq-playing-9e7199f>div:before{animation-play-state:running}.eq-col-9e7199f{-ms-flex:1;flex:1;height:100%;position:relative;margin-right:1px}.eq-col-9e7199f:after,.eq-col-9e7199f:before{width:100%;height:100%;content:"";position:absolute;animation:keyframes-eq-animation-9e7199f 0s linear infinite alternate;will-change:transform;background-color:#fafafa;animation-play-state:paused}.eq-col-9e7199f:nth-child(4):before{animation-duration:0.4s}.eq-col-9e7199f:nth-child(4):after{animation-duration:0.25s}.eq-col-9e7199f:nth-child(3):before{animation-duration:0.3s}.eq-col-9e7199f:nth-child(3):after{animation-duration:0.35s}.eq-col-9e7199f:nth-child(2):before{animation-duration:0.5s}.eq-col-9e7199f:nth-child(2):after{animation-duration:0.4s}.eq-col-9e7199f:first-child:before{animation-duration:0.3s}.eq-col-9e7199f:first-child:after{animation-duration:0.45s}@keyframes keyframes-eq-animation-9e7199f{0%{transform:translateY(100%)}to{transform:translateY(0)}}',z.usesShadowDom=!0,new Set(["c","v","a","ad"]);var Y=()=>/^(https?:)?\/\/((player|www)\.)?vimeo.com(?=$|\/)/,B={"play":"playing","pause":"pause","ended":"ended","volumechange":null};function H(t,e=""){return JSON.stringify({"method":t,"value":e})}import{createElement as W}from"../bento.mjs";import{useCallback as D,useImperativeHandle as G,useLayoutEffect as K,useMemo as Q,useRef as X}from"../bento.mjs";import{forwardRef as Z}from"../bento.mjs";var _=["loading","unloadOnPause","sandbox","muted","controls","origin","onCanPlay","onMessage","playerStateRef","makeMethodMessage","makeFullscreenMessage","onIframeLoad"],tt=["allow-scripts","allow-same-origin","allow-popups","allow-popups-to-escape-sandbox","allow-top-navigation-by-user-activation"].join(" ");function et(t,e,o){t&&t.contentWindow&&e.then((()=>{t.contentWindow.postMessage(o(),"*")}))}var ot=Z((function(t,o){let{loading:n,unloadOnPause:r=!1,sandbox:a=tt,muted:s=!1,controls:u=!1,origin:c,onCanPlay:f,onMessage:d,playerStateRef:m,makeMethodMessage:p,makeFullscreenMessage:b,onIframeLoad:y}=t,v=e(t,_);const g=X(null),h=Q((()=>new i),[]),w=X(p),j=D((t=>{et(null==g?void 0:g.current,h.promise,(()=>w.current(t)))}),[h.promise]),k=X(b),O=D((()=>et(null==g?void 0:g.current,h.promise,k.current)),[h.promise]);G(o,(()=>({get currentTime(){var t,e;return null!==(t=null==m||null===(e=m.current)||void 0===e?void 0:e.currentTime)&&void 0!==t?t:NaN},get duration(){var t,e;return null!==(t=null==m||null===(e=m.current)||void 0===e?void 0:e.duration)&&void 0!==t?t:NaN},requestFullscreen:()=>{if(!k.current)return h.promise.then((()=>{g.current.requestFullscreen()}));O()},play:()=>j("play"),pause:()=>{if(r){const t=g.current;t&&(t.src=t.src)}else j("pause")}})),[m,j,O,h.promise,r]);const q=function(t){const e=X(null);return e.current=t,e}(d);return K((()=>{if(!g.current)return;function t(t){q.current&&(c&&!c.test(t.origin)||t.source!=g.current.contentWindow||q.current({currentTarget:g.current,target:g.current,data:t.data}))}const{defaultView:e}=g.current.ownerDocument;return e.addEventListener("message",t),()=>e.removeEventListener("message",t)}),[c,q]),K((()=>{j(s?"mute":"unmute")}),[s,j]),K((()=>{j(u?"showControls":"hideControls")}),[u,j]),W("iframe",l(l({},v),{},{ref:g,allowfullscreen:!0,frameborder:"0",sandbox:a,loading:n,onCanPlay:()=>{f&&h.promise.then(f),h.resolve()},onLoad:t=>{null==y||y(t)}}))}));ot.displayName="VideoIframeInternal";var nt=Z((function(t,e){return W(A,l(l({ref:e},t),{},{component:ot}))}));nt.displayName="VideoIframe";import{createElement as rt}from"../bento.mjs";import{useCallback as at,useMemo as lt,useRef as it}from"../bento.mjs";import{forwardRef as st}from"../bento.mjs";import{useValueRef as ut}from"../bento.mjs";var ct=["autoplay","doNotTrack","onLoad","videoid"];function ft(t,e){!function(t,e,o,n){t.ownerDocument;const r=t.ownerDocument.createEvent("Event");r.data={};const{bubbles:a,cancelable:l}={bubbles:!0,cancelable:!1}||N;r.initEvent(e,a,l),t.dispatchEvent(r)}(t,e)}function dt(t){return"mute"===t?H("setVolume","0"):"unmute"===t?H("setVolume","1"):H(t)}var mt=st((function(t,o){let{autoplay:n=!1,doNotTrack:r=!1,onLoad:a,videoid:i}=t,u=e(t,ct);const f=lt(Y,[]),d=lt((()=>function(t,e,o){return function(t,e,o){if(!e)return t;const n=t.split("#",2),r=n[0].split("?",2);let a=r[0]+(r[1]?`?${r[1]}&${e}`:`?${e}`);return a+=n[1]?`#${n[1]}`:"",a}(`https://player.vimeo.com/video/${encodeURIComponent(t)}`,function(t){const e=[];for(const a in t){let l=t[a];if(null!=l){l=s(r=l)?r:[r];for(let t=0;t<l.length;t++)e.push((o=a,n=l[t],`${encodeURIComponent(o)}=${encodeURIComponent(n)}`))}}var o,n,r;return e.join("&")}({"dnt":o?"1":void 0,"muted":e?"1":void 0}))}(i,n,r)),[i,r,n]),m=it(null),p=ut(a),b=at((t=>{m.current!==t&&(m.current=t,ft(t,"canplay"),function(t){Object.keys(B).forEach((e=>{J(t,H("addEventListener",e))}))}(t))}),[]),y=at((t=>{const{currentTarget:e}=t,o=(r=n=t.data,"[object Object]"===c.call(r)?n:E(n));var n,r;if(!o)return;const a=o.event;var l;if("ready"!=a&&"ping"!=o.method){if(B[a])return ft(e,B[a]),void(null===(l=p.current)||void 0===l||l.call(p))}else b(e)}),[b,p]),v=at((t=>{J(t.currentTarget,H("ping"))}),[]);return rt(nt,l(l({ref:o},u),{},{origin:f,autoplay:n,src:d,onMessage:y,makeMethodMessage:dt,onIframeLoad:v,controls:!0}))}));mt.displayName="BentoVimeo";var pt=class extends z{};pt.Component=mt,pt.props={"autoplay":{attr:"autoplay",type:"boolean"},"controls":{attr:"controls",type:"boolean"},"videoid":{attr:"data-videoid"},"doNotTrack":{attr:"do-not-track"},"loading":{attr:"data-loading"}},pt.layoutSizeDefined=!0,pt.usesShadowDom=!0,pt.loadable=!0;import{defineBentoElement as bt}from"../bento.mjs";bt("bento-vimeo",pt,void 0);
/*! https://mths.be/cssescape v1.5.1 by @mathias | MIT license */
//# sourceMappingURL=bento-vimeo-1.0.mjs.map