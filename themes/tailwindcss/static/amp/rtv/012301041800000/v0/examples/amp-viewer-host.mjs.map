{"version":3,"file":"amp-viewer-host.mjs","mappings":"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","names":["TAG","CHANNEL_OPEN_MSG","APP","message","charAt","JSON","parse","e","Messaging","static","target","opt_token","Promise","resolve","intervalRef","setInterval","channel","MessageChannel","pollMessage","app","name","postMessage","port2","port","port1","listener","event","parseMessage","data","clearInterval","removeEventListener","messaging","sendResponse_","requestid","addEventListener","start","source","origin","opt_cdnProxyRegex","test","constructor","win","this","win_","origin_","target_","eventType","handler","targetOrigin","opt_isWebview","opt_verifyToken","port_","isWebview_","token_","verifyToken_","requestIdCounter_","waitingForResponse_","messageHandlers_","defaultHandler_","handleMessage_","bind","registerHandler","messageName","requestHandler","unregisterHandler","setDefaultHandler","messagingToken","logError_","type","handleRequest_","handleResponse_","sendRequest","messageData","awaitResponse","requestId","promise","reject","sendMessage_","rsvp","sendResponseError_","reason","errString","errorToString_","error","finalMessage","Object","assign","stringify","Error","args","then","pending","state","opt_data","stateStr","err","String","self","AmpViewerHost","ampIframe","frameOrigin","messageHandler","opt_logsId","opt_isHandshakePoll","ampIframe_","messageHandler_","logsId","contentWindow","initiateHandshakeWithDocument","messaging_","completeHandshake_","waitForHandshakeFromDocument","visibilityState_","prerenderSize","log","var_args","Array","prototype","slice","call","arguments","unshift","console","apply"],"sourceRoot":"https://raw.githubusercontent.com/ampproject/amphtml/2301041800000/","sources":["extensions/amp-viewer-integration/0.1/messaging/messaging.js","extensions/amp-viewer-integration/0.1/examples/amp-viewer-host.js"]}
