{"version":3,"file":"amp-viewer-host.js","mappings":"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","names":["TAG","CHANNEL_OPEN_MSG","APP","message","charAt","JSON","parse","e","WindowPortEmulator","win","origin","target","this","win_","origin_","target_","addEventListener","eventType","handler","event","_this","source","_proto","postMessage","data","targetOrigin","start","WindowPortEmulator2","Messaging","port","opt_isWebview","opt_token","opt_verifyToken","port_","isWebview_","token_","verifyToken_","requestIdCounter_","waitingForResponse_","messageHandlers_","defaultHandler_","handleMessage_","bind","Messaging2","initiateHandshakeWithDocument","Promise","resolve","intervalRef","setInterval","channel","MessageChannel","pollMessage","app","name","port2","port1","parseMessage","clearInterval","removeEventListener","listener","messaging","sendResponse_","requestid","waitForHandshakeFromDocument","opt_cdnProxyRegex","test","registerHandler","messageName","requestHandler","_proto2","unregisterHandler","setDefaultHandler","messagingToken","logError_","type","handleRequest_","handleResponse_","sendRequest","messageData","awaitResponse","requestId","promise","undefined","reject","_this2","sendMessage_","rsvp","sendResponseError_","reason","errString","errorToString_","error","finalMessage","Object","assign","stringify","Error","args","then","_this3","pending","state","opt_data","stateStr","err","String","AmpViewerHost","ampIframe","frameOrigin","messageHandler","opt_logsId","opt_isHandshakePoll","ampIframe_","messageHandler_","logsId","contentWindow","messaging_","completeHandshake_","visibilityState_","prerenderSize","log","var_args","Array","prototype","slice","call","arguments","unshift","console","apply","AmpViewerHost2","self"],"sourceRoot":"https://raw.githubusercontent.com/ampproject/amphtml/2301041800000/","sources":["extensions/amp-viewer-integration/0.1/messaging/messaging.js","extensions/amp-viewer-integration/0.1/examples/amp-viewer-host.js"]}
