;
import{PreactBaseElement as e}from"../bento.mjs";function t(e,t){if(null==e)return{};var n,o,a={},r=Object.keys(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||(a[n]=e[n]);return a}function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e){var t=function(e,t){if("object"!==n(e)||null===e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var a=o.call(e,"string");if("object"!==n(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===n(t)?t:String(t)}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var i=class{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}},{isArray:s}=Array;function u(e,t){return t.toUpperCase()}var{hasOwnProperty:c,toString:f}=Object.prototype;function d(e){const t=Object.getOwnPropertyDescriptor(e,"message");if(null!=t&&t.writable)return e;const{message:n,stack:o}=e,a=new Error(n);for(const t in e)a[t]=e[t];return a.stack=o,a}function m(e){let t=null,n="";for(const e of arguments)e instanceof Error&&!t?t=d(e):(n&&(n+=" "),n+=e);return t?n&&(t.message=n+": "+t.message):t=new Error(n),t}function p(e){const t=m.apply(null,arguments);return t.expected=!0,t}function b(e,...t){var n,o,a;n=p.apply(null,t),null===(o=(a=self).__AMP_REPORT_ERROR)||void 0===o||o.call(a,n)}import{Fragment as y,createElement as v}from"../bento.mjs";import{useCallback as g,useEffect as h,useImperativeHandle as w,useLayoutEffect as j,useMemo as k,useRef as O,useState as x}from"../bento.mjs";import{forwardRef as S}from"../bento.mjs";import{ContainWrapper as q,useValueRef as C}from"../bento.mjs";import{useAmpContext as R,useLoading as E}from"../bento.mjs";import{useCallback as I,useLayoutEffect as M}from"../bento.mjs";import{useAmpContext as P}from"../bento.mjs";function N(e,t){try{return function(e){return JSON.parse(e)}(e)}catch(e){return null==t||t(e),null}}var $={bubbles:!0,cancelable:!0};self.__AMP_LOG=self.__AMP_LOG||{user:null,dev:null,userForEmbed:null},self.__AMP_LOG;var L={"title":"","artist":"","album":"","artwork":[{"src":""}]};function T(e){const t=e.querySelector('script[type="application/ld+json"]');if(!t)return;const n=N(t.textContent);return n&&n.image?"string"==typeof n.image?n.image:n.image["@list"]&&"string"==typeof n.image["@list"][0]?n.image["@list"][0]:"string"==typeof n.image.url?n.image.url:"string"==typeof n.image[0]?n.image[0]:void 0:void 0}function V(e){const t=e.querySelector('meta[property="og:image"]');return t?t.getAttribute("content"):void 0}function F(e){const t=e.querySelector('link[rel="shortcut icon"]')||e.querySelector('link[rel="icon"]');return t?t.getAttribute("href"):void 0}function U({displayIcon:e,displayOverlay:t,metadata:n,onOverlayClick:o,pause:a,play:r,playing:l,wrapperRef:i}){const{playable:s}=R();return h((()=>{if(!s)return void a();const e=new IntersectionObserver((e=>{e[e.length-1].isIntersecting?r().catch((()=>{})):a()}),{threshold:.5});return e.observe(i.current),()=>{e.disconnect()}}),[i,r,a,s]),v(y,null,e&&v("div",{class:"eq-9e7199f"+(l?" eq-playing-9e7199f":"")},v(A,null)),t&&v("button",{"aria-label":n&&n.title||"Unmute video",tabindex:"0",class:"autoplay-mask-button-9e7199f fill-content-overlay-fc551a7",onClick:o}))}var A=function(e){let t=!1,n=null,o=()=>[1,2,3,4].map((e=>v("div",{class:"eq-col-9e7199f",key:e})));return(...e)=>(t||(n=o.apply(self,e),t=!0,o=null),n)}(),D=S((function(e,n){let a="class",{autoplay:r=!1,component:s="video",controls:u=!1,loading:c,loop:f=!1,mediasession:d=!0,noaudio:m=!1,onPlayingState:p,onReadyState:y,poster:S,sources:I,src:N,style:$,[a]:A}=e,D=t(e,["autoplay","component","controls","loading","loop","mediasession","noaudio","onPlayingState","onReadyState","poster","sources","src","style",a].map(o));!function(){const{notify:e}=P();M((()=>{e&&e()}))}();const{playable:J}=R(),_=E(c),z="unload"!==_,[Y,B]=x(r),[H,W]=x(!1),[G,K]=x(null),[Q,X]=x(!r),Z=O(null),ee=O(null),te=k((()=>new i),[]),ne=O("loading"),oe=C(y),ae=g(((e,t)=>{if(e!==ne.current){ne.current=e;const n=oe.current;n&&n(e,t)}}),[oe]),re=C(p),le=g((e=>{W(e);const t=re.current;t&&t(e)}),[re]);j((()=>{z||le(!1)}),[z,le]);const ie=g((()=>te.promise.then((()=>function(e,t){const n=(o=()=>e.play(!1),new Promise((e=>{e(o())})));var o;return n.catch((e=>{b(0,e)})),n}(ee.current)))),[te]),se=g((()=>{te.promise.then((()=>{var e;return null===(e=ee.current)||void 0===e?void 0:e.pause()}))}),[te]),ue=g((()=>te.promise.then((()=>ee.current.requestFullscreen()))),[te]),ce=g((()=>{B(!1),X(!0)}),[]);return j((()=>{var e;const t=null===(e=ee.current)||void 0===e?void 0:e.readyState;null!=t&&ae(t>0?"complete":"loading")}),[ae]),j((()=>(d&&H&&G&&function(e,t,n,o){const{navigator:a}=e;"mediaSession"in a&&e.MediaMetadata&&(a.mediaSession.metadata=new e.MediaMetadata(L),a.mediaSession.metadata=new e.MediaMetadata(t),a.mediaSession.setActionHandler("play",n),a.mediaSession.setActionHandler("pause",o))}(window,G,ie,se),()=>{})),[d,H,G,ie,se]),h((()=>{J||se()}),[J,se]),w(n,(()=>({get readyState(){return ne.current},play:ie,pause:se,requestFullscreen:ue,get currentTime(){return ee.current?ee.current.currentTime:0},get duration(){return ee.current?ee.current.duration:NaN},get autoplay(){return r},get controls(){return u},get loop(){return f},userInteracted:ce,mute:()=>B(!0),unmute:()=>{Q&&B(!1)}})),[ie,se,ue,ce,Q,r,u,f]),v(q,{contentRef:Z,class:A,style:$,size:!0,layout:!0,paint:!0},z&&v(s,l(l({},D),{},{ref:ee,loading:_,muted:Y,loop:f,controls:u&&(!r||Q),onCanPlay:()=>{te.resolve(),ae("complete")},onLoadedMetadata:()=>{d&&te.promise.then((()=>{var e,t;K((e=ee.current,l({"title":(t=D).title||t["aria-label"]||document.title,"artist":t.artist||"","album":t.album||"","artwork":[{"src":t.artwork||t.poster||T(document)||V(document)||F(document)||""}]},e&&e.getMetadata?e.getMetadata():Object.create(null))))})),ae("complete")},onPlaying:()=>le(!0),onPause:()=>le(!1),onEnded:()=>le(!1),onError:e=>{ae("error",e),te.reject(e)},class:"fill-stretch-fc551a7",src:N,poster:S}),I),r&&!Q&&v(U,{metadata:G,playing:H,displayIcon:!m&&Y,wrapperRef:Z,play:ie,pause:se,displayOverlay:u,onOverlayClick:ce}))}));D.displayName="VideoWrapper";var J=class extends e{};J.Component=D,J.loadable=!0,J.layoutSizeDefined=!0,J.staticProps,J.props={"album":{attr:"album"},"alt":{attr:"alt"},"artist":{attr:"artist"},"artwork":{attr:"artwork"},"attribution":{attr:"attribution"},"autoplay":{attr:"autoplay",type:"boolean"},"controls":{attr:"controls",type:"boolean"},"controlslist":{attr:"controlslist"},"crossorigin":{attr:"crossorigin"},"disableremoteplayback":{attr:"disableremoteplayback"},"loop":{attr:"loop",type:"boolean"},"noaudio":{attr:"noaudio",type:"boolean"},"poster":{attr:"poster"},"sources":{selector:"source",single:!1,clone:!0},"src":{attr:"src"},"title":{attr:"title"},"dock":{attr:"dock",media:!0},"rotate-to-fullscreen":{attr:"rotate-to-fullscreen",type:"boolean",media:!0}},J.shadowCss='.fill-stretch-fc551a7{width:100%;height:100%;position:relative}.fill-content-overlay-fc551a7{top:0;left:0;right:0;bottom:0;position:absolute}.autoplay-mask-button-9e7199f{width:100%;border:none;display:block;-webkit-appearance:none;appearance:none;background:transparent}.eq-9e7199f{right:7px;width:20px;bottom:7px;height:12px;display:-ms-flexbox;display:flex;opacity:0.8;z-index:1;overflow:hidden;position:absolute;-ms-flex-align:end;align-items:flex-end;pointer-events:none!important}.eq-playing-9e7199f>div:after,.eq-playing-9e7199f>div:before{animation-play-state:running}.eq-col-9e7199f{-ms-flex:1;flex:1;height:100%;position:relative;margin-right:1px}.eq-col-9e7199f:after,.eq-col-9e7199f:before{width:100%;height:100%;content:"";position:absolute;animation:keyframes-eq-animation-9e7199f 0s linear infinite alternate;will-change:transform;background-color:#fafafa;animation-play-state:paused}.eq-col-9e7199f:nth-child(4):before{animation-duration:0.4s}.eq-col-9e7199f:nth-child(4):after{animation-duration:0.25s}.eq-col-9e7199f:nth-child(3):before{animation-duration:0.3s}.eq-col-9e7199f:nth-child(3):after{animation-duration:0.35s}.eq-col-9e7199f:nth-child(2):before{animation-duration:0.5s}.eq-col-9e7199f:nth-child(2):after{animation-duration:0.4s}.eq-col-9e7199f:first-child:before{animation-duration:0.3s}.eq-col-9e7199f:first-child:after{animation-duration:0.45s}@keyframes keyframes-eq-animation-9e7199f{0%{transform:translateY(100%)}to{transform:translateY(0)}}',J.usesShadowDom=!0;import{createElement as _}from"../bento.mjs";import{Slot as z,createSlot as Y}from"../bento.mjs";import{createElement as B}from"../bento.mjs";import{useCallback as H,useImperativeHandle as W,useLayoutEffect as G,useMemo as K,useRef as Q}from"../bento.mjs";import{forwardRef as X}from"../bento.mjs";var Z=["loading","unloadOnPause","sandbox","muted","controls","origin","onCanPlay","onMessage","playerStateRef","makeMethodMessage","makeFullscreenMessage","onIframeLoad"],ee=["allow-scripts","allow-same-origin","allow-popups","allow-popups-to-escape-sandbox","allow-top-navigation-by-user-activation"].join(" ");function te(e,t,n){e&&e.contentWindow&&t.then((()=>{e.contentWindow.postMessage(n(),"*")}))}var ne=X((function(e,n){let{loading:o,unloadOnPause:a=!1,sandbox:r=ee,muted:s=!1,controls:u=!1,origin:c,onCanPlay:f,onMessage:d,playerStateRef:m,makeMethodMessage:p,makeFullscreenMessage:b,onIframeLoad:y}=e,v=t(e,Z);const g=Q(null),h=K((()=>new i),[]),w=Q(p),j=H((e=>{te(null==g?void 0:g.current,h.promise,(()=>w.current(e)))}),[h.promise]),k=Q(b),O=H((()=>te(null==g?void 0:g.current,h.promise,k.current)),[h.promise]);W(n,(()=>({get currentTime(){var e,t;return null!==(e=null==m||null===(t=m.current)||void 0===t?void 0:t.currentTime)&&void 0!==e?e:NaN},get duration(){var e,t;return null!==(e=null==m||null===(t=m.current)||void 0===t?void 0:t.duration)&&void 0!==e?e:NaN},requestFullscreen:()=>{if(!k.current)return h.promise.then((()=>{g.current.requestFullscreen()}));O()},play:()=>j("play"),pause:()=>{if(a){const e=g.current;e&&(e.src=e.src)}else j("pause")}})),[m,j,O,h.promise,a]);const x=function(e){const t=Q(null);return t.current=e,t}(d);return G((()=>{if(!g.current)return;function e(e){x.current&&(c&&!c.test(e.origin)||e.source!=g.current.contentWindow||x.current({currentTarget:g.current,target:g.current,data:e.data}))}const{defaultView:t}=g.current.ownerDocument;return t.addEventListener("message",e),()=>t.removeEventListener("message",e)}),[c,x]),G((()=>{j(s?"mute":"unmute")}),[s,j]),G((()=>{j(u?"showControls":"hideControls")}),[u,j]),B("iframe",l(l({},v),{},{ref:g,allowfullscreen:!0,frameborder:"0",sandbox:r,loading:o,onCanPlay:()=>{f&&h.promise.then(f),h.resolve()},onLoad:e=>{null==y||y(e)}}))}));ne.displayName="VideoIframeInternal";var oe=X((function(e,t){return B(D,l(l({ref:t},e),{},{component:ne}))}));oe.displayName="VideoIframe";import{createElement as ae}from"../bento.mjs";import{useRef as re}from"../bento.mjs";import{forwardRef as le}from"../bento.mjs";new Set(["c","v","a","ad"]);var ie=["autoplay","loop","videoid","liveChannelid","onLoad","params","credentials"],se={"-1":"unstarted",0:"ended",1:"playing",2:"pause",3:"buffering",5:"video_cued"},ue={"play":"playVideo","pause":"pauseVideo","mute":"mute","unmute":"unMute"},ce={bubbles:!1,cancelable:!1};function fe(e,t){!function(e,t,n,o){e.ownerDocument;const a=e.ownerDocument.createEvent("Event");a.data={};const{bubbles:r,cancelable:l}=o||$;a.initEvent(t,r,l),e.dispatchEvent(a)}(e,t,0,ce)}function de(e){return JSON.stringify({"event":"command","func":ue[e]})}var me=le((function(e,n){let{autoplay:o,loop:a,videoid:r,liveChannelid:i,onLoad:u,params:c={},credentials:d}=e,m=t(e,ie);if(r&&i||!r&&!i)throw new Error("Exactly one of data-videoid or data-live-channelid should be present for <amp-youtube>");let p=function(e,t,n){let o="";"omit"===e&&(o="-nocookie");const a=`https://www.youtube${o}.com/embed/`;let r="";return r=t?`${encodeURIComponent(t)}?`:`live_stream?channel=${encodeURIComponent(n||"")}&`,`${a}${r}enablejsapi=1&amp=1`}(d,r,i);"playsinline"in c||(c.playsinline="1"),"autoplay"in c&&(delete c.autoplay,o=!0),o&&("iv_load_policy"in c||(c.iv_load_policy="3"),c.playsinline="1"),"loop"in c&&(a=!0,delete c.loop),a&&("playlist"in c?c.loop="1":"loop"in c&&delete c.loop),p=function(e,t){return function(e,t,n){if(!t)return e;const o=e.split("#",2),a=o[0].split("?",2);let r=a[0]+(a[1]?`?${a[1]}&${t}`:`?${t}`);return r+=o[1]?`#${o[1]}`:"",r}(e,function(e){const t=[];for(const r in e){let l=e[r];if(null!=l){l=s(a=l)?a:[a];for(let e=0;e<l.length;e++)t.push((n=r,o=l[e],`${encodeURIComponent(n)}=${encodeURIComponent(o)}`))}}var n,o,a;return t.join("&")}(t))}(p,c);const b=re();return b.current||(b.current={"currentTime":0,"duration":NaN}),ae(oe,l(l({ref:n},m),{},{autoplay:o,src:p,onMessage:({currentTarget:e,data:t})=>{const n=(r=o=t,"[object Object]"===f.call(r)?o:N(o));var o,r;if(!n)return;const{"event":l,"info":i}=n;if("initialDelivery"==l)return fe(e,"loadedmetadata"),void(null==u||u());if(!i)return;const s=b.current;for(const e in s)null!=i[e]&&(s[e]=i[e]);const c=i.playerState;"infoDelivery"==l&&0==c&&a&&e.contentWindow.postMessage(JSON.stringify({"event":"command","func":"playVideo"}),"*"),"infoDelivery"==l&&null!=c&&fe(e,se[c.toString()]),"infoDelivery"==l&&i.muted&&fe(e,i.muted?"muted":"unmuted")},makeMethodMessage:de,onIframeLoad:e=>{const{currentTarget:t}=e;fe(t,"canplay"),t.contentWindow.postMessage(JSON.stringify({"event":"listening"}),"*")},sandbox:"allow-scripts allow-same-origin allow-presentation",playerStateRef:b}))}));me.displayName="BentoYoutube";var pe=class extends J{};pe.Component=me,pe.loadable=!0,pe.props={"autoplay":{attr:"autoplay",type:"boolean"},"loop":{attr:"loop",type:"boolean"},"controls":{attr:"controls",type:"boolean"},"videoid":{attr:"data-videoid"},"liveChannelid":{attr:"data-live-channelid"},"dock":{attr:"dock",media:!0},"credentials":{attr:"credentials"},"loading":{attr:"data-loading"},"params":function(e){const t=t=>(null==t?void 0:t.startsWith(e))&&t!==e;return{"attrMatches":t,"parseAttrs":n=>{let o;const a=n.attributes;for(let n=0;n<a.length;n++){const l=a[n];t(l.name)&&(o||(o={}),o[(r=l.name.slice(e.length),r.replace(/-([a-z])/g,u))]=l.value)}var r;return o}}}("data-param-")},pe.usesShadowDom=!0;import{defineBentoElement as be}from"../bento.mjs";be("bento-youtube",pe,void 0);
/*! https://mths.be/cssescape v1.5.1 by @mathias | MIT license */
//# sourceMappingURL=bento-youtube-1.0.mjs.map